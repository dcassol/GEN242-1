---
title: "Introduction to R" 
author: "Author: Thomas Girke"
date: "Last update: 12 April, 2021" 
output:
  html_document:
    toc: true
    toc_float:
        collapsed: true
        smooth_scroll: true
    toc_depth: 3
    fig_caption: yes
    code_folding: show
    number_sections: true
fontsize: 14pt
bibliography: bibtex.bib
weight: 4
type: docs
---

<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>


<!---
- Compile from command-line
Rscript -e "rmarkdown::render('Rbasics.Rmd', c('html_document'), clean=F); knitr::knit('Rbasics.Rmd', tangle=TRUE)"; Rscript ../md2jekyll.R Rbasics.knit.md 8; Rscript -e "rmarkdown::render('Rbasics.Rmd', c('pdf_document'))"
-->
<script type="text/javascript">
document.addEventListener("DOMContentLoaded", function() {
  document.querySelector("h1").className = "title";
});
</script>
<script type="text/javascript">
document.addEventListener("DOMContentLoaded", function() {
  var links = document.links;  
  for (var i = 0, linksLength = links.length; i < linksLength; i++)
    if (links[i].hostname != window.location.hostname)
      links[i].target = '_blank';
});
</script>
<div style="text-align: right">
<p>Source code downloads:    
[ <a href="https://raw.githubusercontent.com/tgirke/GEN242//main/content/en/tutorials/rbasics/Rbasics.Rmd">.Rmd</a> ]    
[ <a href="https://raw.githubusercontent.com/tgirke/GEN242//main/content/en/tutorials/rbasics/Rbasics.R">.R</a> ]</p>
</div>
<div id="overview" class="section level2">
<h2>Overview</h2>
</div>
<div id="what-is-r" class="section level2">
<h2>What is R?</h2>
<p><a href="http://cran.at.r-project.org">R</a> is a powerful statistical environment and
programming language for the analysis and visualization of data. The
associated <a href="http://bioconductor.org/">Bioconductor</a> and CRAN package
repositories provide many additional R packages for statistical data analysis
for a wide array of research areas. The R software is free and runs on all
common operating systems.</p>
</div>
<div id="why-using-r" class="section level2">
<h2>Why Using R?</h2>
<ul>
<li>Complete statistical environment and programming language</li>
<li>Efficient functions and data structures for data analysis</li>
<li>Powerful graphics</li>
<li>Access to fast growing number of analysis packages</li>
<li>Most widely used language in bioinformatics</li>
<li>Is standard for data mining and biostatistical analysis</li>
<li>Technical advantages: free, open-source, available for all OSs</li>
</ul>
</div>
<div id="books-and-documentation" class="section level2">
<h2>Books and Documentation</h2>
<ul>
<li>simpleR - Using R for Introductory Statistics (John Verzani, 2004) - <a href="http://cran.r-project.org/doc/contrib/Verzani-SimpleR.pdf">URL</a></li>
<li>Bioinformatics and Computational Biology Solutions Using R and Bioconductor (Gentleman et al., 2005) - <a href="http://www.bioconductor.org/help/publications/books/bioinformatics-and-computational-biology-solutions/">URL</a></li>
<li>More on this see “Finding Help” section in UCR Manual - <a href="http://manuals.bioinformatics.ucr.edu/home/R_BioCondManual#TOC-Finding-Help">URL</a></li>
</ul>
</div>
<div id="r-working-environments" class="section level2">
<h2>R Working Environments</h2>
<center>
<img title="R_Interfaces" src="../images/rinterface.png"/>
</center>
<center>
R Projects and Interfaces
</center>
<p>Some R working environments with support for syntax highlighting and utilities to send code
to the R console:</p>
<ul>
<li><a href="https://www.rstudio.com/products/rstudio/features">RStudio</a>: excellent choice for beginners (<a href="http://www.rstudio.com/wp-content/uploads/2016/01/rstudio-IDE-cheatsheet.pdf">Cheat Sheet</a>)</li>
<li>Basic R code editors provided by Rguis</li>
<li><a href="https://wiki.gnome.org/Apps/Gedit">gedit</a>, <a href="http://rgedit.sourceforge.net/">Rgedit</a>, <a href="https://rkward.kde.org/">RKWard</a>, <a href="http://www.walware.de/goto/statet">Eclipse</a>, <a href="http://www.sciviews.org/Tinn-R/">Tinn-R</a>, <a href="https://notepad-plus-plus.org/">Notepad++</a>, <a href="http://sourceforge.net/projects/npptor/">NppToR</a></li>
<li><a href="http://manuals.bioinformatics.ucr.edu/home/programming-in-r/vim-r">Vim-R-Tmux</a>: R working environment based on vim and tmux</li>
<li><a href="http://www.xemacs.org/Download/index.html">Emacs</a> (<a href="http://ess.r-project.org/">ESS add-on package</a>)</li>
</ul>
<div id="example-rstudio" class="section level3">
<h3>Example: RStudio</h3>
<p>New integrated development environment (IDE) for <a href="http://www.rstudio.com/ide/download/">R</a>. Highly functional for both beginners and
advanced.</p>
<center>
<img title="RStudio" src="../images/rstudio.png"/>
</center>
<center>
RStudio IDE
</center>
<p>Some userful shortcuts: <code>Ctrl+Enter</code> (send code), <code>Ctrl+Shift+C</code> (comment/uncomment), <code>Ctrl+1/2</code> (switch window focus)</p>
</div>
<div id="example-nvim-r-tmux" class="section level3">
<h3>Example: Nvim-R-Tmux</h3>
<p>Terminal-based Working Environment for R: <a href="https://girke.bioinformatics.ucr.edu/GEN242/tutorials/rbasics/rbasics/#reading-and-writing-external-data">Nvim-R-Tmux</a>.</p>
<center>
<img title="Nvim-R-Tmux" src="../images/Nvim-R.gif" >
</center>
<center>
Nvim-R-Tmux IDE for R
</center>
</div>
</div>
<div id="r-package-repositories" class="section level2">
<h2>R Package Repositories</h2>
<ul>
<li>CRAN (&gt;14,000 packages) general data analysis - <a href="http://cran.at.r-project.org/">URL</a></li>
<li>Bioconductor (&gt;2,000 packages) bioscience data analysis - <a href="http://www.bioconductor.org/">URL</a></li>
<li>Omegahat (&gt;90 packages) programming interfaces - <a href="https://github.com/omegahat?tab=repositories">URL</a></li>
<li>RStudio packages - <a href="https://www.rstudio.com/products/rpackages/">URL</a></li>
</ul>
</div>
<div id="installation-of-r-rstudio-and-r-packages" class="section level2">
<h2>Installation of R, RStudio and R Packages</h2>
<ol style="list-style-type: decimal">
<li><p>Install R for your operating system from <a href="http://cran.at.r-project.org/">CRAN</a>.</p></li>
<li><p>Install RStudio from <a href="http://www.rstudio.com/ide/download">RStudio</a>.</p></li>
<li><p>Install CRAN Packages from R console like this:</p>
<pre class="r"><code>install.packages(c(&quot;pkg1&quot;, &quot;pkg2&quot;)) 
install.packages(&quot;pkg.zip&quot;, repos=NULL)</code></pre></li>
<li><p>Install Bioconductor packages as follows:</p>
<pre class="r"><code>if (!requireNamespace(&quot;BiocManager&quot;, quietly = TRUE))
    install.packages(&quot;BiocManager&quot;) # Installs BiocManager if not available yet
BiocManager::version() # Reports Bioconductor version
BiocManager::install(c(&quot;pkg1&quot;, &quot;pkg2&quot;)) # Installs packages specified under &quot;pkg1&quot; </code></pre></li>
<li><p>For more details consult the <a href="http://www.bioconductor.org/install/">Bioc Install page</a>
and <a href="http://www.bioconductor.org/packages/release/bioc/html/BiocInstaller.html">BiocInstaller</a> package.</p></li>
</ol>
</div>
<div id="getting-around" class="section level2">
<h2>Getting Around</h2>
<div id="startup-and-closing-behavior" class="section level3">
<h3>Startup and Closing Behavior</h3>
<ul>
<li><p><strong>Starting R</strong>:
The R GUI versions, including RStudio, under Windows and Mac OS X can be
opened by double-clicking their icons. Alternatively, one can start it by
typing <code>R</code> in a terminal (default under Linux).</p></li>
<li><p><strong>Startup/Closing Behavior</strong>:
The R environment is controlled by hidden files in the startup directory:
<code>.RData</code>, <code>.Rhistory</code> and <code>.Rprofile</code> (optional).</p></li>
<li><p><strong>Closing R</strong>:</p></li>
</ul>
<pre class="r"><code>q()  </code></pre>
<pre><code>Save workspace image? [y/n/c]:</code></pre>
<ul>
<li><strong>Note</strong>:
When responding with <code>y</code>, then the entire R workspace will be written to
the <code>.RData</code> file which can become very large. Often it is better to select <code>n</code> here,
because a much better working pratice is to save an analysis protocol to an <code>R</code> or <code>Rmd</code> source file.
This way one can quickly regenerate all data sets and objects needed in a future session.</li>
</ul>
</div>
</div>
<div id="navigating-directories" class="section level2">
<h2>Navigating directories</h2>
<p>List objects in current R session</p>
<pre class="r"><code>ls()</code></pre>
<p>Return content of current working directory</p>
<pre class="r"><code>dir()</code></pre>
<p>Return path of current working directory</p>
<pre class="r"><code>getwd()</code></pre>
<p>Change current working directory</p>
<pre class="r"><code>setwd(&quot;/home/user&quot;)</code></pre>
</div>
<div id="basic-syntax" class="section level2">
<h2>Basic Syntax</h2>
<p>Create an object with the assignment operator <code>&lt;-</code> or <code>=</code></p>
<pre class="r"><code>object &lt;- ...</code></pre>
<p>General R command syntax</p>
<pre class="r"><code>object &lt;- function_name(arguments) 
object &lt;- object[arguments] </code></pre>
<p>Instead of the assignment operator one can use the <code>assign</code> function</p>
<pre class="r"><code>assign(&quot;x&quot;, function(arguments))</code></pre>
<p>Finding help</p>
<pre class="r"><code>?function_name</code></pre>
<p>Load a library/package</p>
<pre class="r"><code>library(&quot;my_library&quot;) </code></pre>
<p>List functions defined by a library</p>
<pre class="r"><code>library(help=&quot;my_library&quot;)</code></pre>
<p>Load library manual (PDF or HTML file)</p>
<pre class="r"><code>vignette(&quot;my_library&quot;) </code></pre>
<p>Execute an R script from within R</p>
<pre class="r"><code>source(&quot;my_script.R&quot;)</code></pre>
<p>Execute an R script from command-line (the first of the three options is preferred)</p>
<pre class="sh"><code>$ Rscript my_script.R
$ R CMD BATCH my_script.R 
$ R --slave &lt; my_script.R </code></pre>
</div>
<div id="data-types" class="section level2">
<h2>Data Types</h2>
<div id="numeric-data" class="section level3">
<h3>Numeric data</h3>
<p>Example: <code>1, 2, 3, ...</code></p>
<pre class="r"><code>x &lt;- c(1, 2, 3)
x</code></pre>
<pre><code>## [1] 1 2 3</code></pre>
<pre class="r"><code>is.numeric(x)</code></pre>
<pre><code>## [1] TRUE</code></pre>
<pre class="r"><code>as.character(x)</code></pre>
<pre><code>## [1] &quot;1&quot; &quot;2&quot; &quot;3&quot;</code></pre>
</div>
<div id="character-data" class="section level3">
<h3>Character data</h3>
<p>Example: <code>"a", "b", "c", ...</code></p>
<pre class="r"><code>x &lt;- c(&quot;1&quot;, &quot;2&quot;, &quot;3&quot;)
x</code></pre>
<pre><code>## [1] &quot;1&quot; &quot;2&quot; &quot;3&quot;</code></pre>
<pre class="r"><code>is.character(x)</code></pre>
<pre><code>## [1] TRUE</code></pre>
<pre class="r"><code>as.numeric(x)</code></pre>
<pre><code>## [1] 1 2 3</code></pre>
</div>
<div id="complex-data" class="section level3">
<h3>Complex data</h3>
<p>Example: mix of both</p>
<pre class="r"><code>c(1, &quot;b&quot;, 3)</code></pre>
<pre><code>## [1] &quot;1&quot; &quot;b&quot; &quot;3&quot;</code></pre>
</div>
<div id="logical-data" class="section level3">
<h3>Logical data</h3>
<p>Example: <code>TRUE</code> of <code>FALSE</code></p>
<pre class="r"><code>x &lt;- 1:10 &lt; 5
x  </code></pre>
<pre><code>##  [1]  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE</code></pre>
<pre class="r"><code>!x</code></pre>
<pre><code>##  [1] FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE</code></pre>
<pre class="r"><code>which(x) # Returns index for the &#39;TRUE&#39; values in logical vector</code></pre>
<pre><code>## [1] 1 2 3 4</code></pre>
</div>
</div>
<div id="data-objects" class="section level2">
<h2>Data Objects</h2>
<div id="object-types" class="section level3">
<h3>Object types</h3>
<div id="vectors-1d" class="section level4">
<h4>Vectors (1D)</h4>
<p>Definition: <code>numeric</code> or <code>character</code></p>
<pre class="r"><code>myVec &lt;- 1:10; names(myVec) &lt;- letters[1:10]  
myVec &lt;- setNames(1:10, letters[1:10]) # Same as above in single step
myVec[1:5]</code></pre>
<pre><code>## a b c d e 
## 1 2 3 4 5</code></pre>
<pre class="r"><code>myVec[c(2,4,6,8)]</code></pre>
<pre><code>## b d f h 
## 2 4 6 8</code></pre>
<pre class="r"><code>myVec[c(&quot;b&quot;, &quot;d&quot;, &quot;f&quot;)]</code></pre>
<pre><code>## b d f 
## 2 4 6</code></pre>
</div>
<div id="factors-1d" class="section level4">
<h4>Factors (1D)</h4>
<p>Definition: vectors with grouping information</p>
<pre class="r"><code>factor(c(&quot;dog&quot;, &quot;cat&quot;, &quot;mouse&quot;, &quot;dog&quot;, &quot;dog&quot;, &quot;cat&quot;))</code></pre>
<pre><code>## [1] dog   cat   mouse dog   dog   cat  
## Levels: cat dog mouse</code></pre>
</div>
<div id="matrices-2d" class="section level4">
<h4>Matrices (2D)</h4>
<p>Definition: two dimensional structures with data of same type</p>
<pre class="r"><code>myMA &lt;- matrix(1:30, 3, 10, byrow = TRUE) 
class(myMA)</code></pre>
<pre><code>## [1] &quot;matrix&quot; &quot;array&quot;</code></pre>
<pre class="r"><code>myMA[1:2,]</code></pre>
<pre><code>##      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]
## [1,]    1    2    3    4    5    6    7    8    9    10
## [2,]   11   12   13   14   15   16   17   18   19    20</code></pre>
<pre class="r"><code>myMA[1, , drop=FALSE]</code></pre>
<pre><code>##      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]
## [1,]    1    2    3    4    5    6    7    8    9    10</code></pre>
</div>
<div id="data-frames-2d" class="section level4">
<h4>Data Frames (2D)</h4>
<p>Definition: <code>data.frames</code> are two dimensional objects with data of variable types</p>
<pre class="r"><code>myDF &lt;- data.frame(Col1=1:10, Col2=10:1) 
myDF[1:2, ]</code></pre>
<pre><code>##   Col1 Col2
## 1    1   10
## 2    2    9</code></pre>
</div>
<div id="tibbles" class="section level4">
<h4>Tibbles</h4>
<p><code>Tibbles</code> are a more modern version of <code>data.frames</code>. Among many other advantages, one can see
here that <code>tibbles</code> have a nicer printing bahavior. Much more detailed information on this object
class is provided in the <a href="https://girke.bioinformatics.ucr.edu/GEN242/manuals/rbasics/rbasics/#dplyr-environment"><code>dplyr/tidyverse</code></a> manual section.</p>
<pre class="r"><code>library(tidyverse)
as_tibble(iris)</code></pre>
<pre><code>## # A tibble: 150 x 5
##    Sepal.Length Sepal.Width Petal.Length Petal.Width Species
##           &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;  
##  1          5.1         3.5          1.4         0.2 setosa 
##  2          4.9         3            1.4         0.2 setosa 
##  3          4.7         3.2          1.3         0.2 setosa 
##  4          4.6         3.1          1.5         0.2 setosa 
##  5          5           3.6          1.4         0.2 setosa 
##  6          5.4         3.9          1.7         0.4 setosa 
##  7          4.6         3.4          1.4         0.3 setosa 
##  8          5           3.4          1.5         0.2 setosa 
##  9          4.4         2.9          1.4         0.2 setosa 
## 10          4.9         3.1          1.5         0.1 setosa 
## # … with 140 more rows</code></pre>
</div>
<div id="arrays" class="section level4">
<h4>Arrays</h4>
<p>Definition: data structure with one, two or more dimensions</p>
</div>
<div id="lists" class="section level4">
<h4>Lists</h4>
<p>Definition: containers for any object type</p>
<pre class="r"><code>myL &lt;- list(name=&quot;Fred&quot;, wife=&quot;Mary&quot;, no.children=3, child.ages=c(4,7,9)) 
myL</code></pre>
<pre><code>## $name
## [1] &quot;Fred&quot;
## 
## $wife
## [1] &quot;Mary&quot;
## 
## $no.children
## [1] 3
## 
## $child.ages
## [1] 4 7 9</code></pre>
<pre class="r"><code>myL[[4]][1:2] </code></pre>
<pre><code>## [1] 4 7</code></pre>
</div>
</div>
</div>
<div id="functions" class="section level2">
<h2>Functions</h2>
<p>Definition: piece of code</p>
<pre class="r"><code>myfct &lt;- function(arg1, arg2, ...) { 
    function_body 
}</code></pre>
</div>
<div id="subsetting-of-data-objects" class="section level2">
<h2>Subsetting of data objects</h2>
<p><strong>(1.) Subsetting by positive or negative index/position numbers</strong></p>
<pre class="r"><code>myVec &lt;- 1:26; names(myVec) &lt;- LETTERS 
myVec[1:4]</code></pre>
<pre><code>## A B C D 
## 1 2 3 4</code></pre>
<p><strong>(2.) Subsetting by same length logical vectors</strong></p>
<pre class="r"><code>myLog &lt;- myVec &gt; 10
myVec[myLog] </code></pre>
<pre><code>##  K  L  M  N  O  P  Q  R  S  T  U  V  W  X  Y  Z 
## 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26</code></pre>
<p><strong>(3.) Subsetting by field names</strong></p>
<pre class="r"><code>myVec[c(&quot;B&quot;, &quot;K&quot;, &quot;M&quot;)]</code></pre>
<pre><code>##  B  K  M 
##  2 11 13</code></pre>
<p><strong>(4.) Subset with <code>$</code> sign</strong>: references a single column or list component by its name</p>
<pre class="r"><code>iris$Species[1:8]</code></pre>
<pre><code>## [1] setosa setosa setosa setosa setosa setosa setosa setosa
## Levels: setosa versicolor virginica</code></pre>
</div>
<div id="important-utilities" class="section level2">
<h2>Important Utilities</h2>
<div id="combining-objects" class="section level3">
<h3>Combining Objects</h3>
<p>The <code>c</code> function combines vectors and lists</p>
<pre class="r"><code>c(1, 2, 3)</code></pre>
<pre><code>## [1] 1 2 3</code></pre>
<pre class="r"><code>x &lt;- 1:3; y &lt;- 101:103
c(x, y)</code></pre>
<pre><code>## [1]   1   2   3 101 102 103</code></pre>
<p>The <code>cbind</code> and <code>rbind</code> functions can be used to append columns and rows, respecively.</p>
<pre class="r"><code>ma &lt;- cbind(x, y)
ma</code></pre>
<pre><code>##      x   y
## [1,] 1 101
## [2,] 2 102
## [3,] 3 103</code></pre>
<pre class="r"><code>rbind(ma, ma)</code></pre>
<pre><code>##      x   y
## [1,] 1 101
## [2,] 2 102
## [3,] 3 103
## [4,] 1 101
## [5,] 2 102
## [6,] 3 103</code></pre>
</div>
<div id="accessing-dimensions-of-objects" class="section level3">
<h3>Accessing Dimensions of Objects</h3>
<p>Length and dimension information of objects</p>
<pre class="r"><code>length(iris$Species)</code></pre>
<pre><code>## [1] 150</code></pre>
<pre class="r"><code>dim(iris)</code></pre>
<pre><code>## [1] 150   5</code></pre>
</div>
<div id="accessing-name-slots-of-objects" class="section level3">
<h3>Accessing Name Slots of Objects</h3>
<p>Accessing row and column names of 2D objects</p>
<pre class="r"><code>rownames(iris)[1:8]</code></pre>
<pre><code>## [1] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; &quot;5&quot; &quot;6&quot; &quot;7&quot; &quot;8&quot;</code></pre>
<pre class="r"><code>colnames(iris)</code></pre>
<pre><code>## [1] &quot;Sepal.Length&quot; &quot;Sepal.Width&quot;  &quot;Petal.Length&quot; &quot;Petal.Width&quot;  &quot;Species&quot;</code></pre>
<p>Return name field of vectors and lists</p>
<pre class="r"><code>names(myVec)</code></pre>
<pre><code>##  [1] &quot;A&quot; &quot;B&quot; &quot;C&quot; &quot;D&quot; &quot;E&quot; &quot;F&quot; &quot;G&quot; &quot;H&quot; &quot;I&quot; &quot;J&quot; &quot;K&quot; &quot;L&quot; &quot;M&quot; &quot;N&quot; &quot;O&quot; &quot;P&quot; &quot;Q&quot; &quot;R&quot; &quot;S&quot; &quot;T&quot; &quot;U&quot; &quot;V&quot; &quot;W&quot; &quot;X&quot;
## [25] &quot;Y&quot; &quot;Z&quot;</code></pre>
<pre class="r"><code>names(myL)</code></pre>
<pre><code>## [1] &quot;name&quot;        &quot;wife&quot;        &quot;no.children&quot; &quot;child.ages&quot;</code></pre>
</div>
<div id="sorting-objects" class="section level3">
<h3>Sorting Objects</h3>
<p>The function <code>sort</code> returns a vector in ascending or descending order</p>
<pre class="r"><code>sort(10:1)</code></pre>
<pre><code>##  [1]  1  2  3  4  5  6  7  8  9 10</code></pre>
<p>The function <code>order</code> returns a sorting index for sorting an object</p>
<pre class="r"><code>sortindex &lt;- order(iris[,1], decreasing = FALSE)
sortindex[1:12]</code></pre>
<pre><code>##  [1] 14  9 39 43 42  4  7 23 48  3 30 12</code></pre>
<pre class="r"><code>iris[sortindex,][1:2,]</code></pre>
<pre><code>##    Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 14          4.3         3.0          1.1         0.1  setosa
## 9           4.4         2.9          1.4         0.2  setosa</code></pre>
<pre class="r"><code>sortindex &lt;- order(-iris[,1]) # Same as decreasing=TRUE</code></pre>
<p>Sorting multiple columns</p>
<pre class="r"><code>iris[order(iris$Sepal.Length, iris$Sepal.Width),][1:2,]</code></pre>
<pre><code>##    Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 14          4.3         3.0          1.1         0.1  setosa
## 9           4.4         2.9          1.4         0.2  setosa</code></pre>
</div>
</div>
<div id="operators-and-calculations" class="section level2">
<h2>Operators and Calculations</h2>
<div id="comparison-operators" class="section level3">
<h3>Comparison Operators</h3>
<p>Comparison operators: <code>==</code>, <code>!=</code>, <code>&lt;</code>, <code>&gt;</code>, <code>&lt;=</code>, <code>&gt;=</code></p>
<pre class="r"><code>1==1</code></pre>
<pre><code>## [1] TRUE</code></pre>
<p>Logical operators: AND: <code>&amp;</code>, OR: <code>|</code>, NOT: <code>!</code></p>
<pre class="r"><code>x &lt;- 1:10; y &lt;- 10:1
x &gt; y &amp; x &gt; 5</code></pre>
<pre><code>##  [1] FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE</code></pre>
</div>
<div id="basic-calculations" class="section level3">
<h3>Basic Calculations</h3>
<p>To look up math functions, see Function Index <a href="http://cran.at.r-project.org/doc/manuals/R-intro.html#Function-and-variable-index">here</a></p>
<pre class="r"><code>x + y</code></pre>
<pre><code>##  [1] 11 11 11 11 11 11 11 11 11 11</code></pre>
<pre class="r"><code>sum(x)</code></pre>
<pre><code>## [1] 55</code></pre>
<pre class="r"><code>mean(x)</code></pre>
<pre><code>## [1] 5.5</code></pre>
<pre class="r"><code>apply(iris[1:6,1:3], 1, mean) </code></pre>
<pre><code>##        1        2        3        4        5        6 
## 3.333333 3.100000 3.066667 3.066667 3.333333 3.666667</code></pre>
</div>
</div>
<div id="reading-and-writing-external-data" class="section level2">
<h2>Reading and Writing External Data</h2>
<div id="import-of-tabular-data" class="section level3">
<h3>Import of tabular data</h3>
<p>Import of a tab-delimited tabular file</p>
<pre class="r"><code>myDF &lt;- read.delim(&quot;myData.xls&quot;, sep=&quot;\t&quot;)</code></pre>
<p>Import of Google Sheets. The following example imports a sample Google Sheet from <a href="https://docs.google.com/spreadsheets/d/1U-32UcwZP1k3saKeaH1mbvEAOfZRdNHNkWK2GI1rpPM/edit#gid=472150521">here</a>.
Detailed instructions for interacting from R with Google Sheets with the required <code>googlesheets4</code> package are <a href="https://googlesheets4.tidyverse.org/">here</a>.</p>
<pre class="r"><code>library(googlesheets4)
mysheet &lt;- read_sheet(&quot;1U-32UcwZP1k3saKeaH1mbvEAOfZRdNHNkWK2GI1rpPM&quot;, skip=4)
myDF &lt;- as.data.frame(mysheet)
myDF</code></pre>
<p>Import from Excel sheets works well with <code>readxl</code>. For details see the <code>readxl</code> package manual <a href="https://readxl.tidyverse.org/">here</a>. Note: working with tab- or comma-delimited files is more flexible and highly preferred for automated analysis workflows.</p>
<pre class="r"><code>library(&quot;readxl&quot;)
mysheet &lt;- read_excel(targets_path, sheet=&quot;Sheet1&quot;)</code></pre>
<p>Additional import functions are described in the <code>readr</code> package section <a href="https://girke.bioinformatics.ucr.edu/GEN242/manuals/rbasics/rbasics/#reading-and-writing-tabular-files">here</a>.</p>
</div>
<div id="export-of-tabular-data" class="section level3">
<h3>Export of tabular data</h3>
<pre class="r"><code>write.table(myDF, file=&quot;myfile.xls&quot;, sep=&quot;\t&quot;, quote=FALSE, col.names=NA)</code></pre>
</div>
<div id="line-wise-import" class="section level3">
<h3>Line-wise import</h3>
<pre class="r"><code>myDF &lt;- readLines(&quot;myData.txt&quot;)</code></pre>
</div>
<div id="line-wise-export" class="section level3">
<h3>Line-wise export</h3>
<pre class="r"><code>writeLines(month.name, &quot;myData.txt&quot;)</code></pre>
</div>
<div id="export-r-object" class="section level3">
<h3>Export R object</h3>
<pre class="r"><code>mylist &lt;- list(C1=iris[,1], C2=iris[,2]) # Example to export
saveRDS(mylist, &quot;mylist.rds&quot;)</code></pre>
</div>
<div id="import-r-object" class="section level3">
<h3>Import R object</h3>
<pre class="r"><code>mylist &lt;- readRDS(&quot;mylist.rds&quot;)</code></pre>
</div>
<div id="copy-and-paste-into-r" class="section level3">
<h3>Copy and paste into R</h3>
<p>On Windows/Linux systems</p>
<pre class="r"><code>read.delim(&quot;clipboard&quot;) </code></pre>
<p>On Mac OS X systems</p>
<pre class="r"><code>read.delim(pipe(&quot;pbpaste&quot;)) </code></pre>
</div>
<div id="copy-and-paste-from-r" class="section level3">
<h3>Copy and paste from R</h3>
<p>On Windows/Linux systems</p>
<pre class="r"><code>write.table(iris, &quot;clipboard&quot;, sep=&quot;\t&quot;, col.names=NA, quote=F) </code></pre>
<p>On Mac OS X systems</p>
<pre class="r"><code>zz &lt;- pipe(&#39;pbcopy&#39;, &#39;w&#39;)
write.table(iris, zz, sep=&quot;\t&quot;, col.names=NA, quote=F)
close(zz) </code></pre>
</div>
<div id="homework-3a" class="section level3">
<h3>Homework 3A</h3>
<p>Homework 3A: <a href="https://girke.bioinformatics.ucr.edu/GEN242/assignments/homework/hw03/hw03/">Object Subsetting Routines and Import/Export</a></p>
</div>
</div>
<div id="useful-r-functions" class="section level2">
<h2>Useful R Functions</h2>
<div id="unique-entries" class="section level3">
<h3>Unique entries</h3>
<p>Make vector entries unique with <code>unique</code></p>
<pre class="r"><code>length(iris$Sepal.Length)</code></pre>
<pre><code>## [1] 150</code></pre>
<pre class="r"><code>length(unique(iris$Sepal.Length))</code></pre>
<pre><code>## [1] 35</code></pre>
</div>
<div id="count-occurrences" class="section level3">
<h3>Count occurrences</h3>
<p>Count occurrences of entries with <code>table</code></p>
<pre class="r"><code>table(iris$Species)</code></pre>
<pre><code>## 
##     setosa versicolor  virginica 
##         50         50         50</code></pre>
</div>
<div id="aggregate-data" class="section level3">
<h3>Aggregate data</h3>
<p>Compute aggregate statistics with <code>aggregate</code></p>
<pre class="r"><code>aggregate(iris[,1:4], by=list(iris$Species), FUN=mean, na.rm=TRUE)</code></pre>
<pre><code>##      Group.1 Sepal.Length Sepal.Width Petal.Length Petal.Width
## 1     setosa        5.006       3.428        1.462       0.246
## 2 versicolor        5.936       2.770        4.260       1.326
## 3  virginica        6.588       2.974        5.552       2.026</code></pre>
</div>
<div id="intersect-data" class="section level3">
<h3>Intersect data</h3>
<p>Compute intersect between two vectors with <code>%in%</code></p>
<pre class="r"><code>month.name %in% c(&quot;May&quot;, &quot;July&quot;)</code></pre>
<pre><code>##  [1] FALSE FALSE FALSE FALSE  TRUE FALSE  TRUE FALSE FALSE FALSE FALSE FALSE</code></pre>
</div>
<div id="merge-data-frames" class="section level3">
<h3>Merge data frames</h3>
<p>Join two data frames by common field entries with <code>merge</code> (here row names <code>by.x=0</code>). To obtain only the common rows, change <code>all=TRUE</code> to <code>all=FALSE</code>. To merge on specific columns, refer to them by their position numbers or their column names.</p>
<pre class="r"><code>frame1 &lt;- iris[sample(1:length(iris[,1]), 30), ]
frame1[1:2,]</code></pre>
<pre><code>##    Sepal.Length Sepal.Width Petal.Length Petal.Width    Species
## 55          6.5         2.8          4.6         1.5 versicolor
## 49          5.3         3.7          1.5         0.2     setosa</code></pre>
<pre class="r"><code>dim(frame1)</code></pre>
<pre><code>## [1] 30  5</code></pre>
<pre class="r"><code>my_result &lt;- merge(frame1, iris, by.x = 0, by.y = 0, all = TRUE)
dim(my_result)</code></pre>
<pre><code>## [1] 150  11</code></pre>
</div>
</div>
<div id="graphics-in-r" class="section level2">
<h2>Graphics in R</h2>
<div id="advantages" class="section level3">
<h3>Advantages</h3>
<ul>
<li>Powerful environment for visualizing scientific data</li>
<li>Integrated graphics and statistics infrastructure</li>
<li>Publication quality graphics</li>
<li>Fully programmable</li>
<li>Highly reproducible</li>
<li>Full <a href="http://www.latex-project.org/">LaTeX</a> and Markdown support via <code>knitr</code> and <code>R markdown</code></li>
<li>Vast number of R packages with graphics utilities</li>
</ul>
</div>
<div id="documentation-for-r-graphics" class="section level3">
<h3>Documentation for R Graphics</h3>
<p><strong>General</strong></p>
<ul>
<li>Graphics Task Page - <a href="http://cran.r-project.org/web/views/Graphics.html">URL</a></li>
<li>R Graph Gallery - <a href="http://addictedtor.free.fr/graphiques/allgraph.php">URL</a></li>
<li>R Graphical Manual - <a href="http://cged.genes.nig.ac.jp/RGM2/index.php">URL</a></li>
<li>Paul Murrell’s book R (Grid) Graphics - <a href="http://www.stat.auckland.ac.nz/~paul/RGraphics/rgraphics.html">URL</a></li>
</ul>
<p><strong>Interactive graphics</strong></p>
<ul>
<li>rggobi` (GGobi) - <a href="http://www.ggobi.org/">URL</a></li>
<li><code>iplots</code> - <a href="http://www.rosuda.org/iplots/">URL</a></li>
<li>Open GL (<code>rgl</code>) - <a href="http://rgl.neoscientists.org/gallery.shtml">URL</a></li>
</ul>
</div>
<div id="graphics-environments" class="section level3">
<h3>Graphics Environments</h3>
<p><strong>Viewing and saving graphics in R</strong></p>
<ul>
<li>On-screen graphics</li>
<li>postscript, pdf, svg</li>
<li>jpeg, png, wmf, tiff, …</li>
</ul>
<p><strong>Four major graphic environments</strong></p>
<ol style="list-style-type: lower-alpha">
<li>Low-level infrastructure</li>
</ol>
<ul>
<li>R Base Graphics (low- and high-level)</li>
<li><code>grid</code>: <a href="http://www.stat.auckland.ac.nz/~paul/grid/grid.html">Manual</a></li>
</ul>
<ol start="2" style="list-style-type: lower-alpha">
<li>High-level infrastructure
\begin{itemize}</li>
</ol>
<ul>
<li><code>lattice</code>: <a href="http://lmdvr.r-forge.r-project.org">Manual</a>, <a href="http://www.his.sunderland.ac.uk/~cs0her/Statistics/UsingLatticeGraphicsInR.htm">Intro</a>, <a href="http://www.amazon.com/Lattice-Multivariate-Data-Visualization-Use/dp/0387759689">Book</a></li>
<li><code>ggplot2</code>: <a href="http://had.co.nz/ggplot2/">Manual</a>, <a href="http://www.ling.upenn.edu/~joseff/rstudy/summer2010_ggplot2_intro.html">Intro</a>, <a href="http://had.co.nz/ggplot2/book/">Book</a></li>
</ul>
</div>
<div id="base-graphics-overview" class="section level3">
<h3>Base Graphics: Overview</h3>
<p><strong>Important high-level plotting functions</strong></p>
<ul>
<li><code>plot</code>: generic x-y plotting</li>
<li><code>barplot</code>: bar plots</li>
<li><code>boxplot</code>: box-and-whisker plot</li>
<li><code>hist</code>: histograms</li>
<li><code>pie</code>: pie charts</li>
<li><code>dotchart</code>: cleveland dot plots</li>
<li><code>image, heatmap, contour, persp</code>: functions to generate image-like plots</li>
<li><code>qqnorm, qqline, qqplot</code>: distribution comparison plots</li>
<li><code>pairs, coplot</code>: display of multivariant data</li>
</ul>
<p><strong>Help on graphics functions</strong></p>
<ul>
<li><code>?myfct</code></li>
<li><code>?plot</code></li>
<li><code>?par</code></li>
</ul>
<div id="preferred-object-types" class="section level4">
<h4>Preferred Object Types</h4>
<ul>
<li>Matrices and data frames</li>
<li>Vectors</li>
<li>Named vectors</li>
</ul>
</div>
</div>
<div id="scatter-plots" class="section level3">
<h3>Scatter Plots</h3>
</div>
<div id="basic-scatter-plot" class="section level3">
<h3>Basic Scatter Plot</h3>
<p>Sample data set for subsequent plots</p>
<pre class="r"><code>set.seed(1410)
y &lt;- matrix(runif(30), ncol=3, dimnames=list(letters[1:10], LETTERS[1:3]))</code></pre>
<p>Plot data</p>
<pre class="r"><code>plot(y[,1], y[,2]) </code></pre>
<p><img src="/en/tutorials/rbasics/Rbasics_files/figure-html/basic_scatter_plot-1.png" width="672" /></p>
<div id="all-pairs" class="section level4">
<h4>All pairs</h4>
<pre class="r"><code>pairs(y) </code></pre>
<p><img src="/en/tutorials/rbasics/Rbasics_files/figure-html/pairs_scatter_plot-1.png" width="672" /></p>
</div>
<div id="with-labels" class="section level4">
<h4>With labels</h4>
<pre class="r"><code>plot(y[,1], y[,2], pch=20, col=&quot;red&quot;, main=&quot;Symbols and Labels&quot;)
text(y[,1]+0.03, y[,2], rownames(y))</code></pre>
<p><img src="/en/tutorials/rbasics/Rbasics_files/figure-html/labels_scatter_plot-1.png" width="672" /></p>
</div>
</div>
<div id="more-examples" class="section level3">
<h3>More examples</h3>
<p><strong>Print instead of symbols the row names</strong></p>
<pre class="r"><code>plot(y[,1], y[,2], type=&quot;n&quot;, main=&quot;Plot of Labels&quot;)
text(y[,1], y[,2], rownames(y)) </code></pre>
<p><img src="/en/tutorials/rbasics/Rbasics_files/figure-html/row_scatter_plot-1.png" width="672" /></p>
<p><strong>Usage of important plotting parameters</strong></p>
<pre class="r"><code>grid(5, 5, lwd = 2) 
op &lt;- par(mar=c(8,8,8,8), bg=&quot;lightblue&quot;)
plot(y[,1], y[,2], type=&quot;p&quot;, col=&quot;red&quot;, cex.lab=1.2, cex.axis=1.2, 
     cex.main=1.2, cex.sub=1, lwd=4, pch=20, xlab=&quot;x label&quot;, 
     ylab=&quot;y label&quot;, main=&quot;My Main&quot;, sub=&quot;My Sub&quot;)
par(op)</code></pre>
<p><strong>Important arguments</strong></p>
<ul>
<li><code>mar</code>: specifies the margin sizes around the plotting area in order: <code>c(bottom, left, top, right)</code></li>
<li><code>col</code>: color of symbols</li>
<li><code>pch</code>: type of symbols, samples: <code>example(points)</code></li>
<li><code>lwd</code>: size of symbols</li>
<li><code>cex.*</code>: control font sizes</li>
<li>For details see <code>?par</code></li>
</ul>
<div id="add-regression-line" class="section level4">
<h4>Add regression line</h4>
<pre class="r"><code>plot(y[,1], y[,2])
myline &lt;- lm(y[,2]~y[,1]); abline(myline, lwd=2) </code></pre>
<p><img src="/en/tutorials/rbasics/Rbasics_files/figure-html/plot_regression-1.png" width="672" /></p>
<pre class="r"><code>summary(myline) </code></pre>
<pre><code>## 
## Call:
## lm(formula = y[, 2] ~ y[, 1])
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.40357 -0.17912 -0.04299  0.22147  0.46623 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)   0.5764     0.2110   2.732   0.0258 *
## y[, 1]       -0.3647     0.3959  -0.921   0.3839  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.3095 on 8 degrees of freedom
## Multiple R-squared:  0.09589,    Adjusted R-squared:  -0.01712 
## F-statistic: 0.8485 on 1 and 8 DF,  p-value: 0.3839</code></pre>
</div>
<div id="log-scale" class="section level4">
<h4>Log scale</h4>
<p>Same plot as above, but on log scale</p>
<pre class="r"><code>plot(y[,1], y[,2], log=&quot;xy&quot;) </code></pre>
<p><img src="/en/tutorials/rbasics/Rbasics_files/figure-html/plot_regression_log-1.png" width="672" /></p>
</div>
<div id="add-a-mathematical-expression" class="section level4">
<h4>Add a mathematical expression</h4>
<pre class="r"><code>plot(y[,1], y[,2]); text(y[1,1], y[1,2], expression(sum(frac(1,sqrt(x^2*pi)))), cex=1.3) </code></pre>
<p><img src="/en/tutorials/rbasics/Rbasics_files/figure-html/plot_regression_math-1.png" width="672" /></p>
</div>
</div>
<div id="homework-3b" class="section level3">
<h3>Homework 3B</h3>
<p>Homework 3B: <a href="https://girke.bioinformatics.ucr.edu/GEN242/assignments/homework/hw03/hw03/">Scatter Plots</a></p>
</div>
<div id="line-plots" class="section level3">
<h3>Line Plots</h3>
<div id="single-data-set" class="section level4">
<h4>Single data set</h4>
<pre class="r"><code>plot(y[,1], type=&quot;l&quot;, lwd=2, col=&quot;blue&quot;) </code></pre>
<p><img src="/en/tutorials/rbasics/Rbasics_files/figure-html/plot_line_single-1.png" width="672" /></p>
</div>
<div id="many-data-sets" class="section level4">
<h4>Many Data Sets</h4>
<p>Plots line graph for all columns in data frame <code>y</code>. The <code>split.screen</code> function is used in this example in a for loop to overlay several line graphs in the same plot.</p>
<pre class="r"><code>split.screen(c(1,1)) </code></pre>
<pre><code>## [1] 1</code></pre>
<pre class="r"><code>plot(y[,1], ylim=c(0,1), xlab=&quot;Measurement&quot;, ylab=&quot;Intensity&quot;, type=&quot;l&quot;, lwd=2, col=1)
for(i in 2:length(y[1,])) { 
    screen(1, new=FALSE)
    plot(y[,i], ylim=c(0,1), type=&quot;l&quot;, lwd=2, col=i, xaxt=&quot;n&quot;, yaxt=&quot;n&quot;, ylab=&quot;&quot;, xlab=&quot;&quot;, main=&quot;&quot;, bty=&quot;n&quot;) 
}</code></pre>
<p><img src="/en/tutorials/rbasics/Rbasics_files/figure-html/plot_line_many-1.png" width="672" /></p>
<pre class="r"><code>close.screen(all=TRUE) </code></pre>
</div>
</div>
<div id="bar-plots" class="section level3">
<h3>Bar Plots</h3>
<div id="basics" class="section level4">
<h4>Basics</h4>
<pre class="r"><code>barplot(y[1:4,], ylim=c(0, max(y[1:4,])+0.3), beside=TRUE, legend=letters[1:4]) 
text(labels=round(as.vector(as.matrix(y[1:4,])),2), x=seq(1.5, 13, by=1) + sort(rep(c(0,1,2), 4)), y=as.vector(as.matrix(y[1:4,]))+0.04) </code></pre>
<p><img src="/en/tutorials/rbasics/Rbasics_files/figure-html/plot_bar_simple-1.png" width="672" /></p>
</div>
<div id="error-bars" class="section level4">
<h4>Error Bars</h4>
<pre class="r"><code>bar &lt;- barplot(m &lt;- rowMeans(y) * 10, ylim=c(0, 10))
stdev &lt;- sd(t(y))
arrows(bar, m, bar, m + stdev, length=0.15, angle = 90)</code></pre>
<p><img src="/en/tutorials/rbasics/Rbasics_files/figure-html/plot_bar_error-1.png" width="672" /></p>
</div>
</div>
<div id="histograms" class="section level3">
<h3>Histograms</h3>
<pre class="r"><code>hist(y, freq=TRUE, breaks=10)</code></pre>
<p><img src="/en/tutorials/rbasics/Rbasics_files/figure-html/plot_hist-1.png" width="672" /></p>
</div>
<div id="density-plots" class="section level3">
<h3>Density Plots</h3>
<pre class="r"><code>plot(density(y), col=&quot;red&quot;)</code></pre>
<p><img src="/en/tutorials/rbasics/Rbasics_files/figure-html/plot_dens-1.png" width="672" /></p>
</div>
<div id="pie-charts" class="section level3">
<h3>Pie Charts</h3>
<pre class="r"><code>pie(y[,1], col=rainbow(length(y[,1]), start=0.1, end=0.8), clockwise=TRUE)
legend(&quot;topright&quot;, legend=row.names(y), cex=1.3, bty=&quot;n&quot;, pch=15, pt.cex=1.8, 
col=rainbow(length(y[,1]), start=0.1, end=0.8), ncol=1) </code></pre>
<p><img src="/en/tutorials/rbasics/Rbasics_files/figure-html/plot_pie-1.png" width="672" /></p>
</div>
<div id="color-selection-utilities" class="section level3">
<h3>Color Selection Utilities</h3>
<p>Default color palette and how to change it</p>
<pre class="r"><code>palette()</code></pre>
<pre><code>## [1] &quot;black&quot;   &quot;#DF536B&quot; &quot;#61D04F&quot; &quot;#2297E6&quot; &quot;#28E2E5&quot; &quot;#CD0BBC&quot; &quot;#F5C710&quot; &quot;gray62&quot;</code></pre>
<pre class="r"><code>palette(rainbow(5, start=0.1, end=0.2))
palette()</code></pre>
<pre><code>## [1] &quot;#FF9900&quot; &quot;#FFBF00&quot; &quot;#FFE600&quot; &quot;#F2FF00&quot; &quot;#CCFF00&quot;</code></pre>
<pre class="r"><code>palette(&quot;default&quot;)</code></pre>
<p>The <code>gray</code> function allows to select any type of gray shades by providing values from 0 to 1</p>
<pre class="r"><code>gray(seq(0.1, 1, by= 0.2))</code></pre>
<pre><code>## [1] &quot;#1A1A1A&quot; &quot;#4D4D4D&quot; &quot;#808080&quot; &quot;#B3B3B3&quot; &quot;#E6E6E6&quot;</code></pre>
<p>Color gradients with <code>colorpanel</code> function from <code>gplots</code> library`</p>
<pre class="r"><code>library(gplots)
colorpanel(5, &quot;darkblue&quot;, &quot;yellow&quot;, &quot;white&quot;)</code></pre>
<pre><code>## [1] &quot;#00008B&quot; &quot;#808046&quot; &quot;#FFFF00&quot; &quot;#FFFF80&quot; &quot;#FFFFFF&quot;</code></pre>
<p>Much more on colors in R see Earl Glynn’s color chart <a href="http://research.stowers-institute.org/efg/R/Color/Chart/">here</a></p>
</div>
<div id="saving-graphics-to-file" class="section level3">
<h3>Saving Graphics to File</h3>
<p>After the <code>pdf()</code> command all graphs are redirected to file <code>test.pdf</code>. Works for all common formats similarly: jpeg, png, ps, tiff, …</p>
<pre class="r"><code>pdf(&quot;test.pdf&quot;)
plot(1:10, 1:10)
dev.off() </code></pre>
<p>Generates Scalable Vector Graphics (SVG) files that can be edited in vector graphics programs, such as InkScape.</p>
<pre class="r"><code>library(&quot;RSvgDevice&quot;)
devSVG(&quot;test.svg&quot;)
plot(1:10, 1:10)
dev.off() </code></pre>
</div>
<div id="homework-3c" class="section level3">
<h3>Homework 3C</h3>
<p>Homework 3C: <a href="https://girke.bioinformatics.ucr.edu/GEN242/assignments/homework/hw03/hw03/">Bar Plots</a></p>
</div>
</div>
<div id="analysis-routine" class="section level2">
<h2>Analysis Routine</h2>
<div id="overview-1" class="section level3">
<h3>Overview</h3>
<p>The following exercise introduces a variety of useful data analysis utilities in R.</p>
</div>
<div id="analysis-routine-data-import" class="section level3">
<h3>Analysis Routine: Data Import</h3>
<ul>
<li><p><strong>Step 1</strong>: To get started with this exercise, direct your R session to a dedicated workshop directory and download into this directory the following sample tables. Then import the files into Excel and save them as tab delimited text files.</p>
<ul>
<li><a href="http://faculty.ucr.edu/~tgirke/Documents/R_BioCond/Samples/MolecularWeight_tair7.xls">MolecularWeight_tair7.xls</a></li>
<li><a href="http://faculty.ucr.edu/~tgirke/Documents/R_BioCond/Samples/TargetP_analysis_tair7.xls">TargetP_analysis_tair7.xls</a></li>
</ul></li>
</ul>
<p><strong>Import the tables into R</strong></p>
<p>Import molecular weight table</p>
<pre class="r"><code>my_mw &lt;- read.delim(file=&quot;MolecularWeight_tair7.xls&quot;, header=T, sep=&quot;\t&quot;) 
my_mw[1:2,]</code></pre>
<p>Import subcelluar targeting table</p>
<pre class="r"><code>my_target &lt;- read.delim(file=&quot;TargetP_analysis_tair7.xls&quot;, header=T, sep=&quot;\t&quot;) 
my_target[1:2,]</code></pre>
<p>Online import of molecular weight table</p>
<pre class="r"><code>my_mw &lt;- read.delim(file=&quot;http://faculty.ucr.edu/~tgirke/Documents/R_BioCond/Samples/MolecularWeight_tair7.xls&quot;, header=T, sep=&quot;\t&quot;) 
my_mw[1:2,]</code></pre>
<pre><code>##   Sequence.id Molecular.Weight.Da. Residues
## 1 AT1G08520.1                83285      760
## 2 AT1G08530.1                27015      257</code></pre>
<p>Online import of subcelluar targeting table</p>
<pre class="r"><code>my_target &lt;- read.delim(file=&quot;http://faculty.ucr.edu/~tgirke/Documents/R_BioCond/Samples/TargetP_analysis_tair7.xls&quot;, header=T, sep=&quot;\t&quot;) 
my_target[1:2,]</code></pre>
<pre><code>##      GeneName Loc   cTP   mTP    SP other
## 1 AT1G08520.1   C 0.822 0.137 0.029 0.039
## 2 AT1G08530.1   C 0.817 0.058 0.010 0.100</code></pre>
</div>
<div id="merging-data-frames" class="section level3">
<h3>Merging Data Frames</h3>
<ul>
<li><strong>Step 2</strong>: Assign uniform gene ID column titles</li>
</ul>
<pre class="r"><code>colnames(my_target)[1] &lt;- &quot;ID&quot;
colnames(my_mw)[1] &lt;- &quot;ID&quot; </code></pre>
<ul>
<li><strong>Step 3</strong>: Merge the two tables based on common ID field</li>
</ul>
<pre class="r"><code>my_mw_target &lt;- merge(my_mw, my_target, by.x=&quot;ID&quot;, by.y=&quot;ID&quot;, all.x=T)</code></pre>
<ul>
<li><strong>Step 4</strong>: Shorten one table before the merge and then remove the non-matching rows (NAs) in the merged file</li>
</ul>
<pre class="r"><code>my_mw_target2a &lt;- merge(my_mw, my_target[1:40,], by.x=&quot;ID&quot;, by.y=&quot;ID&quot;, all.x=T)  # To remove non-matching rows, use the argument setting &#39;all=F&#39;.
my_mw_target2 &lt;- na.omit(my_mw_target2a) # Removes rows containing &quot;NAs&quot; (non-matching rows).</code></pre>
<ul>
<li><strong>Homework 3D</strong>: How can the merge function in the previous step be executed so that only the common rows among the two data frames are returned? Prove that both methods - the two step version with <code>na.omit</code> and your method - return identical results.</li>
<li><strong>Homework 3E</strong>: Replace all <code>NAs</code> in the data frame <code>my_mw_target2a</code> with zeros.</li>
</ul>
</div>
<div id="filtering-data" class="section level3">
<h3>Filtering Data</h3>
<ul>
<li><strong>Step 5</strong>: Retrieve all records with a value of greater than 100,000 in ‘MW’ column and ‘C’ value in ‘Loc’ column (targeted to chloroplast).</li>
</ul>
<pre class="r"><code>query &lt;- my_mw_target[my_mw_target[, 2] &gt; 100000 &amp; my_mw_target[, 4] == &quot;C&quot;, ] 
query[1:4, ]</code></pre>
<pre><code>##              ID Molecular.Weight.Da. Residues Loc   cTP   mTP    SP other
## 219 AT1G02730.1               132588     1181   C 0.972 0.038 0.008 0.045
## 243 AT1G02890.1               136825     1252   C 0.748 0.529 0.011 0.013
## 281 AT1G03160.1               100732      912   C 0.871 0.235 0.011 0.007
## 547 AT1G05380.1               126360     1138   C 0.740 0.099 0.016 0.358</code></pre>
<pre class="r"><code>dim(query)</code></pre>
<pre><code>## [1] 170   8</code></pre>
<ul>
<li><strong>Homework 3F</strong>: How many protein entries in the <code>my</code>_mw<code>_target</code> data frame have a MW of greater then 4,000 and less then 5,000. Subset the data frame accordingly and sort it by MW to check that your result is correct.</li>
</ul>
</div>
<div id="string-substitutions" class="section level3">
<h3>String Substitutions</h3>
<ul>
<li><strong>Step 6</strong>: Use a regular expression in a substitute function to generate a separate ID column that lacks the gene model extensions.
&lt;&lt;label=Exercise 4.7, eval=TRUE, echo=TRUE, keep.source=TRUE&gt;&gt;=</li>
</ul>
<pre class="r"><code>my_mw_target3 &lt;- data.frame(loci=gsub(&quot;\\..*&quot;, &quot;&quot;, as.character(my_mw_target[,1]), perl = TRUE), my_mw_target)
my_mw_target3[1:3,1:8]</code></pre>
<pre><code>##        loci          ID Molecular.Weight.Da. Residues Loc  cTP   mTP    SP
## 1 AT1G01010 AT1G01010.1                49426      429   _ 0.10 0.090 0.075
## 2 AT1G01020 AT1G01020.1                28092      245   * 0.01 0.636 0.158
## 3 AT1G01020 AT1G01020.2                21711      191   * 0.01 0.636 0.158</code></pre>
<ul>
<li><strong>Homework 3G</strong>: Retrieve those rows in <code>my_mw_target3</code> where the second column contains the following identifiers: <code>c("AT5G52930.1", "AT4G18950.1", "AT1G15385.1", "AT4G36500.1", "AT1G67530.1")</code>. Use the <code>%in%</code> function for this query. As an alternative approach, assign the second column to the row index of the data frame and then perform the same query again using the row index. Explain the difference of the two methods.</li>
</ul>
</div>
<div id="calculations-on-data-frames" class="section level3">
<h3>Calculations on Data Frames</h3>
<ul>
<li><strong>Step 7</strong>: Count the number of duplicates in the loci column with the <code>table</code> function and append the result to the data frame with the <code>cbind</code> function.</li>
</ul>
<pre class="r"><code>mycounts &lt;- table(my_mw_target3[,1])[my_mw_target3[,1]]
my_mw_target4 &lt;- cbind(my_mw_target3, Freq=mycounts[as.character(my_mw_target3[,1])]) </code></pre>
<ul>
<li><strong>Step 8</strong>: Perform a vectorized devision of columns 3 and 4 (average AA weight per protein)</li>
</ul>
<pre class="r"><code>data.frame(my_mw_target4, avg_AA_WT=(my_mw_target4[,3] / my_mw_target4[,4]))[1:2,] </code></pre>
<pre><code>##        loci          ID Molecular.Weight.Da. Residues Loc  cTP   mTP    SP other Freq.Var1
## 1 AT1G01010 AT1G01010.1                49426      429   _ 0.10 0.090 0.075 0.925 AT1G01010
## 2 AT1G01020 AT1G01020.1                28092      245   * 0.01 0.636 0.158 0.448 AT1G01020
##   Freq.Freq avg_AA_WT
## 1         1  115.2121
## 2         2  114.6612</code></pre>
<ul>
<li><strong>Step 9</strong>: Calculate for each row the mean and standard deviation across several columns</li>
</ul>
<pre class="r"><code>mymean &lt;- apply(my_mw_target4[,6:9], 1, mean)
mystdev &lt;- apply(my_mw_target4[,6:9], 1, sd, na.rm=TRUE)
data.frame(my_mw_target4, mean=mymean, stdev=mystdev)[1:2,5:12] </code></pre>
<pre><code>##   Loc  cTP   mTP    SP other Freq.Var1 Freq.Freq   mean
## 1   _ 0.10 0.090 0.075 0.925 AT1G01010         1 0.2975
## 2   * 0.01 0.636 0.158 0.448 AT1G01020         2 0.3130</code></pre>
</div>
<div id="plotting-example" class="section level3">
<h3>Plotting Example</h3>
<ul>
<li><strong>Step 10</strong>: Generate scatter plot columns: ‘MW’ and ‘Residues’</li>
</ul>
<pre class="r"><code>plot(my_mw_target4[1:500,3:4], col=&quot;red&quot;)</code></pre>
<p><img src="/en/tutorials/rbasics/Rbasics_files/figure-html/plot_example-1.png" width="672" /></p>
</div>
<div id="export-results-and-run-entire-exercise-as-script" class="section level3">
<h3>Export Results and Run Entire Exercise as Script</h3>
<ul>
<li><strong>Step 11</strong>: Write the data frame <code>my_mw_target4</code> into a tab-delimited text file and inspect it in Excel.</li>
</ul>
<pre class="r"><code>write.table(my_mw_target4, file=&quot;my_file.xls&quot;, quote=F, sep=&quot;\t&quot;, col.names = NA) </code></pre>
<ul>
<li><strong>Homework 3H</strong>: Write all commands from this exercise into an R script named <code>exerciseRbasics.R</code>, or download it from <a href="http://faculty.ucr.edu/~tgirke/Documents/R_BioCond/My_R_Scripts/exerciseRbasics.R">here</a>. Then execute the script with the <code>source</code> function like this: <code>source("exerciseRbasics.R")</code>. This will run all commands of this exercise and generate the corresponding output files in the current working directory.</li>
</ul>
<pre class="r"><code>source(&quot;exerciseRbasics.R&quot;)</code></pre>
</div>
</div>
<div id="session-info" class="section level2">
<h2>Session Info</h2>
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>## R version 4.0.3 (2020-10-10)
## Platform: x86_64-pc-linux-gnu (64-bit)
## Running under: Debian GNU/Linux 10 (buster)
## 
## Matrix products: default
## BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.8.0
## LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.8.0
## 
## locale:
##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               LC_TIME=en_US.UTF-8       
##  [4] LC_COLLATE=en_US.UTF-8     LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                  LC_ADDRESS=C              
## [10] LC_TELEPHONE=C             LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] knitr_1.30        gplots_3.1.1      RSQLite_2.2.1     data.table_1.13.2 forcats_0.5.0    
##  [6] stringr_1.4.0     dplyr_1.0.2       purrr_0.3.4       readr_1.4.0       tidyr_1.1.2      
## [11] tibble_3.0.4      tidyverse_1.3.0   ggplot2_3.3.2     limma_3.46.0      BiocStyle_2.18.0 
## 
## loaded via a namespace (and not attached):
##  [1] httr_1.4.2          viridisLite_0.3.0   bit64_4.0.5         jsonlite_1.7.1     
##  [5] modelr_0.1.8        gtools_3.8.2        assertthat_0.2.1    BiocManager_1.30.10
##  [9] highr_0.8           blob_1.2.1          cellranger_1.1.0    yaml_2.2.1         
## [13] pillar_1.4.7        backports_1.2.0     glue_1.4.2          digest_0.6.27      
## [17] rvest_0.3.6         colorspace_2.0-0    htmltools_0.5.1.1   plyr_1.8.6         
## [21] pkgconfig_2.0.3     broom_0.7.2         haven_2.3.1         bookdown_0.21      
## [25] scales_1.1.1        generics_0.1.0      farver_2.0.3        ellipsis_0.3.1     
## [29] withr_2.3.0         cli_2.2.0           magrittr_2.0.1      crayon_1.3.4       
## [33] readxl_1.3.1        memoise_1.1.0       evaluate_0.14       ps_1.4.0           
## [37] fs_1.5.0            fansi_0.4.1         xml2_1.3.2          blogdown_1.1.7     
## [41] tools_4.0.3         hms_0.5.3           lifecycle_0.2.0     munsell_0.5.0      
## [45] reprex_0.3.0        compiler_4.0.3      caTools_1.18.1      rlang_0.4.8        
## [49] grid_4.0.3          rstudioapi_0.13     bitops_1.0-6        labeling_0.4.2     
## [53] rmarkdown_2.5       gtable_0.3.0        codetools_0.2-16    DBI_1.1.0          
## [57] reshape2_1.4.4      R6_2.5.0            lubridate_1.7.9.2   bit_4.0.4          
## [61] utf8_1.1.4          KernSmooth_2.23-17  stringi_1.5.3       Rcpp_1.0.5         
## [65] vctrs_0.3.5         dbplyr_2.0.0        tidyselect_1.1.0    xfun_0.20</code></pre>
</div>
<div id="references" class="section level2">
<h2>References</h2>
</div>
