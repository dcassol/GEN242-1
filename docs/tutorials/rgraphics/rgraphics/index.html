<!doctype html>
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.80.0" /><META NAME="ROBOTS" CONTENT="INDEX, FOLLOW">


<link rel="shortcut icon" href="../../../favicons/favicon.ico" >
<link rel="apple-touch-icon" href="../../../favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="../../../favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="../../../favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../../favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="../../../favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="../../../favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="../../../favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../../favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="../../../favicons/android-192x192.png" sizes="192x192">

<title>Graphics and Data Visualization in R | GEN242</title><meta property="og:title" content="Graphics and Data Visualization in R" />
<meta property="og:description" content="document.addEventListener(&#34;DOMContentLoaded&#34;, function() { document.querySelector(&#34;h1&#34;).className = &#34;title&#34;; });  document.addEventListener(&#34;DOMContentLoaded&#34;, function() { var links = document.links; for (var i = 0, linksLength = links.length; i Source code downloads: [ .Rmd ] [ .R ]
 Overview Graphics in R  Powerful environment for visualizing scientific data Integrated graphics and statistics infrastructure Publication quality graphics Fully programmable Highly reproducible Full LaTeX, Sweave, knitr and R Markdown support." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/tutorials/rgraphics/rgraphics/" />
<meta property="article:modified_time" content="2021-05-16T13:18:39-07:00" /><meta property="og:site_name" content="GEN242" />
<meta itemprop="name" content="Graphics and Data Visualization in R">
<meta itemprop="description" content="document.addEventListener(&#34;DOMContentLoaded&#34;, function() { document.querySelector(&#34;h1&#34;).className = &#34;title&#34;; });  document.addEventListener(&#34;DOMContentLoaded&#34;, function() { var links = document.links; for (var i = 0, linksLength = links.length; i Source code downloads: [ .Rmd ] [ .R ]
 Overview Graphics in R  Powerful environment for visualizing scientific data Integrated graphics and statistics infrastructure Publication quality graphics Fully programmable Highly reproducible Full LaTeX, Sweave, knitr and R Markdown support.">
<meta itemprop="dateModified" content="2021-05-16T13:18:39-07:00" />
<meta itemprop="wordCount" content="9348">



<meta itemprop="keywords" content="" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Graphics and Data Visualization in R"/>
<meta name="twitter:description" content="document.addEventListener(&#34;DOMContentLoaded&#34;, function() { document.querySelector(&#34;h1&#34;).className = &#34;title&#34;; });  document.addEventListener(&#34;DOMContentLoaded&#34;, function() { var links = document.links; for (var i = 0, linksLength = links.length; i Source code downloads: [ .Rmd ] [ .R ]
 Overview Graphics in R  Powerful environment for visualizing scientific data Integrated graphics and statistics infrastructure Publication quality graphics Fully programmable Highly reproducible Full LaTeX, Sweave, knitr and R Markdown support."/>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-00000000-0', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>






<link rel="preload" href="../../../scss/main.min.1f416e6a5f646f231d085681bf2b4ebdad5d41f149a3977625affc97f735ab7e.css" as="style">
<link href="../../../scss/main.min.1f416e6a5f646f231d085681bf2b4ebdad5d41f149a3977625affc97f735ab7e.css" rel="stylesheet" integrity="">


<script
  src="https://code.jquery.com/jquery-3.5.1.min.js"
  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
  crossorigin="anonymous"></script>

<script
  src="https://unpkg.com/lunr@2.3.8/lunr.min.js"
  integrity="sha384-vRQ9bDyE0Wnu+lMfm57BlYLO0/XauFuKpVsZPs7KEDwYKktWi5+Kz3MP8++DFlRY"
  crossorigin="anonymous"></script>



<link rel="stylesheet" href="../../../css/prism.css"/>


<script src="../../../js/driver0.9.8.min.js"></script>
<link rel="stylesheet" href="../../../css/driver0.9.8.min.css"/>


<link rel="stylesheet" href="../../../css/site.css"/>
<script src="../../../js/site.js"></script>



  </head>
  <body class="td-page line-numbers">
    <header>
     
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
  <a class="navbar-brand" href="../../../">
		<span class="font-weight-bold">GEN242</span>
	</a>
	<row class="header-switch">
	  	<div class="custom-control custom-switch">
        <input type="checkbox" class="custom-control-input" id="sidebarSwitch" checked=true>
        <label class="custom-control-label" for="sidebarSwitch">sidebar</label>
      </div>
    	<div class="custom-control custom-switch">
        <input type="checkbox" class="custom-control-input" id="tocSwitch" checked=true>
        <label class="custom-control-label" for="tocSwitch">toc</label>
      </div>
	</row>
	<div class="td-navbar-nav-scroll ml-md-auto" id="main_navbar">
		<ul class="navbar-nav mt-2 mt-lg-0">
			
			
			<li class="nav-item mr-4 mb-2 mb-lg-0" style="position: relative">
				
				
				
				
				
          <a class="nav-link dropdown-toggle" href="../../../about/" id="navbarDropdown" role="button">
          	About
          </a>
          <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
          	
          	  
              
              
              <a class="dropdown-item" href="../../../about/introduction/"
              style="padding-left: 1rem; font-weight: calc(3/3*500)">
                 Introduction
              </a>
          	
          	  
              
              
              <a class="dropdown-item" href="../../../about/syllabus/"
              style="padding-left: 1rem; font-weight: calc(3/3*500)">
                 Syllabus
              </a>
          	
          	  
              
              
              <a class="dropdown-item" href="../../../about/schedule/"
              style="padding-left: 1rem; font-weight: calc(3/3*500)">
                 Schedule
              </a>
          	
          	  
              
              
              <a class="dropdown-item" href="../../../about/internal/"
              style="padding-left: 1rem; font-weight: calc(3/3*500)">
                 Internal
              </a>
          	
          	  
              
                
              
              
              <a class="dropdown-item" href="../../../about/internal/internal_resources/"
              style="padding-left: 2rem; font-weight: calc(3/4*500)">
                 Resources
              </a>
          	
          	  
              
                
              
              
              <a class="dropdown-item" href="../../../about/internal/install/"
              style="padding-left: 2rem; font-weight: calc(3/4*500)">
                 Installation
              </a>
          	
          </div>
				
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0" style="position: relative">
				
				
				
				
				
          <a class="nav-link dropdown-toggle" href="../../../slides/" id="navbarDropdown" role="button">
          	Slides
          </a>
          <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
          	
          	  
              
              
              <a class="dropdown-item" href="../../../slides/slides_01"
              style="padding-left: 1rem; font-weight: calc(3/3*500)">
                 Course Introduction (S1)
              </a>
          	
          	  
              
              
              <a class="dropdown-item" href="../../../slides/slides_02"
              style="padding-left: 1rem; font-weight: calc(3/3*500)">
                 Genome Basics (S2)
              </a>
          	
          	  
              
              
              <a class="dropdown-item" href="../../../slides/slides_03"
              style="padding-left: 1rem; font-weight: calc(3/3*500)">
                 Databases and Software (S3)
              </a>
          	
          	  
              
              
              <a class="dropdown-item" href="../../../slides/slides_04"
              style="padding-left: 1rem; font-weight: calc(3/3*500)">
                 DNA Sequencing (S4)
              </a>
          	
          	  
              
              
              <a class="dropdown-item" href="../../../slides/slides_05"
              style="padding-left: 1rem; font-weight: calc(3/3*500)">
                 Introduction to R (S5)
              </a>
          	
          	  
              
              
              <a class="dropdown-item" href="../../../slides/slides_06"
              style="padding-left: 1rem; font-weight: calc(3/3*500)">
                 Sequence Alignments (S6)
              </a>
          	
          	  
              
              
              <a class="dropdown-item" href="../../../slides/slides_07"
              style="padding-left: 1rem; font-weight: calc(3/3*500)">
                 Programming in R (S7)
              </a>
          	
          	  
              
              
              <a class="dropdown-item" href="../../../slides/slides_08"
              style="padding-left: 1rem; font-weight: calc(3/3*500)">
                 Multiple Alignments (S8)
              </a>
          	
          	  
              
              
              <a class="dropdown-item" href="../../../slides/slides_09"
              style="padding-left: 1rem; font-weight: calc(3/3*500)">
                 Short Read Alignments (S9)
              </a>
          	
          	  
              
              
              <a class="dropdown-item" href="../../../slides/slides_10"
              style="padding-left: 1rem; font-weight: calc(3/3*500)">
                 R on HPC (S10)
              </a>
          	
          	  
              
              
              <a class="dropdown-item" href="../../../slides/slides_11"
              style="padding-left: 1rem; font-weight: calc(3/3*500)">
                 NGS Analysis Basics (S11)
              </a>
          	
          	  
              
              
              <a class="dropdown-item" href="../../../slides/slides_12"
              style="padding-left: 1rem; font-weight: calc(3/3*500)">
                 Gene Expression Analysis (S12)
              </a>
          	
          	  
              
              
              <a class="dropdown-item" href="../../../slides/slides_13"
              style="padding-left: 1rem; font-weight: calc(3/3*500)">
                 NGS Workflows (S13)
              </a>
          	
          	  
              
              
              <a class="dropdown-item" href="../../../slides/slides_14/"
              style="padding-left: 1rem; font-weight: calc(3/3*500)">
                 ChIP-Seq Overview (S14)
              </a>
          	
          	  
              
              
              <a class="dropdown-item" href="../../../slides/slides_15/"
              style="padding-left: 1rem; font-weight: calc(3/3*500)">
                 Enrichment Analysis (S15)
              </a>
          	
          	  
              
              
              <a class="dropdown-item" href="../../../slides/slides_16/"
              style="padding-left: 1rem; font-weight: calc(3/3*500)">
                 Cluster Analysis (S16)
              </a>
          	
          	  
              
              
              <a class="dropdown-item" href="../../../slides/slides_17/"
              style="padding-left: 1rem; font-weight: calc(3/3*500)">
                 R Packages and dplyr (S17)
              </a>
          	
          	  
              
              
              <a class="dropdown-item" href="../../../slides/slides_18/"
              style="padding-left: 1rem; font-weight: calc(3/3*500)">
                 Shiny Apps (S18)
              </a>
          	
          	  
              
              
              <a class="dropdown-item" href="../../../slides/slides_19/"
              style="padding-left: 1rem; font-weight: calc(3/3*500)">
                 Profile HMMs (S19)
              </a>
          	
          	  
              
              
              <a class="dropdown-item" href="../../../slides/slides_20/"
              style="padding-left: 1rem; font-weight: calc(3/3*500)">
                 Sequence Assembly (S20)
              </a>
          	
          </div>
				
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0" style="position: relative">
				
				
				
				
				
          <a class="nav-link dropdown-toggle" href="../../../tutorials/" id="navbarDropdown" role="button">
          	Tutorials
          </a>
          <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
          	
          	  
              
              
              <a class="dropdown-item" href="../../../tutorials/github/github/"
              style="padding-left: 1rem; font-weight: calc(3/3*500)">
                 GitHub Introduction (T1)
              </a>
          	
          	  
              
              
              <a class="dropdown-item" href="../../../tutorials/linux/linux/"
              style="padding-left: 1rem; font-weight: calc(3/3*500)">
                 Linux and HPCC Cluster (T2)
              </a>
          	
          	  
              
              
              <a class="dropdown-item" href="../../../tutorials/rbasics/rbasics/"
              style="padding-left: 1rem; font-weight: calc(3/3*500)">
                 Introduction to R (T3)
              </a>
          	
          	  
              
              
              <a class="dropdown-item" href="../../../tutorials/rprogramming/rprogramming/"
              style="padding-left: 1rem; font-weight: calc(3/3*500)">
                 Programming in R (T4)
              </a>
          	
          	  
              
              
              <a class="dropdown-item" href="../../../tutorials/rparallel/rparallel/"
              style="padding-left: 1rem; font-weight: calc(3/3*500)">
                 Parallel R (T5)
              </a>
          	
          	  
              
              
              <a class="dropdown-item" href="../../../tutorials/rsequences/rsequences/"
              style="padding-left: 1rem; font-weight: calc(3/3*500)">
                 NGS Analysis Basics (T6)
              </a>
          	
          	  
              
              
              <a class="dropdown-item" href="../../../tutorials/systempiper/systempiper/"
              style="padding-left: 1rem; font-weight: calc(3/3*500)">
                 Workflows (T7)
              </a>
          	
          	  
              
              
              <a class="dropdown-item" href="../../../tutorials/sprnaseq/sprnaseq/"
              style="padding-left: 1rem; font-weight: calc(3/3*500)">
                 RNA-Seq Workflow (T8)
              </a>
          	
          	  
              
              
              <a class="dropdown-item" href="../../../tutorials/spchipseq/spchipseq/"
              style="padding-left: 1rem; font-weight: calc(3/3*500)">
                 ChIP-Seq Workflow (T9)
              </a>
          	
          	  
              
              
              <a class="dropdown-item" href="../../../tutorials/rmarkdown/rmarkdown/"
              style="padding-left: 1rem; font-weight: calc(3/3*500)">
                 R Markdown (T10)
              </a>
          	
          	  
              
              
              <a class="dropdown-item" href="../../../tutorials/rfea/rfea/"
              style="padding-left: 1rem; font-weight: calc(3/3*500)">
                 Functional Enrichment Analysis (T11)
              </a>
          	
          	  
              
              
              <a class="dropdown-item" href="../../../tutorials/rclustering/rclustering/"
              style="padding-left: 1rem; font-weight: calc(3/3*500)">
                 Cluster Analysis and Data Mining (T12)
              </a>
          	
          	  
              
              
              <a class="dropdown-item" href="../../../tutorials/shinyapps/shinyapps/"
              style="padding-left: 1rem; font-weight: calc(3/3*500)">
                 Shiny Apps (T13)
              </a>
          	
          	  
              
              
              <a class="dropdown-item" href="../../../tutorials/rgraphics/rgraphics/"
              style="padding-left: 1rem; font-weight: calc(3/3*500)">
                 Graphics and Visualization (T14)
              </a>
          	
          </div>
				
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0" style="position: relative">
				
				
				
				
				
          <a class="nav-link dropdown-toggle" href="../../../manuals/" id="navbarDropdown" role="button">
          	Manuals
          </a>
          <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
          	
          	  
              
              
              <a class="dropdown-item" href="../../../manuals/github/github/"
              style="padding-left: 1rem; font-weight: calc(3/3*500)">
                 GitHub
              </a>
          	
          	  
              
              
              <a class="dropdown-item" href="../../../manuals/linux/linux/"
              style="padding-left: 1rem; font-weight: calc(3/3*500)">
                 Linux &amp; HPCC Cluster
              </a>
          	
          	  
              
              
              <a class="dropdown-item" href="../../../manuals/rbasics/rbasics/"
              style="padding-left: 1rem; font-weight: calc(3/3*500)">
                 Introduction to R
              </a>
          	
          	  
              
              
              <a class="dropdown-item" href="../../../manuals/rbasics/sample/"
              style="padding-left: 1rem; font-weight: calc(3/3*500)">
                 Sample R Markdown
              </a>
          	
          	  
              
              
              <a class="dropdown-item" href="../../../manuals/rprogramming/rprogramming/"
              style="padding-left: 1rem; font-weight: calc(3/3*500)">
                 Programming in R
              </a>
          	
          	  
              
              
              <a class="dropdown-item" href="../../../manuals/rparallel/rparallel/"
              style="padding-left: 1rem; font-weight: calc(3/3*500)">
                 Parallel Evaluations in R
              </a>
          	
          	  
              
              
              <a class="dropdown-item" href="../../../manuals/rsequences/rsequences/"
              style="padding-left: 1rem; font-weight: calc(3/3*500)">
                 NGS Analysis Basics
              </a>
          	
          	  
              
              
              <a class="dropdown-item" href="../../../manuals/systempiper/systempiper/"
              style="padding-left: 1rem; font-weight: calc(3/3*500)">
                 NGS Workflow Overview
              </a>
          	
          	  
              
              
              <a class="dropdown-item" href="../../../manuals/sprnaseq/sprnaseq/"
              style="padding-left: 1rem; font-weight: calc(3/3*500)">
                 RNA-Seq Workflow
              </a>
          	
          	  
              
              
              <a class="dropdown-item" href="../../../manuals/spchipseq/spchipseq/"
              style="padding-left: 1rem; font-weight: calc(3/3*500)">
                 ChIP-Seq Workflow
              </a>
          	
          	  
              
              
              <a class="dropdown-item" href="../../../manuals/rfea/rfea/"
              style="padding-left: 1rem; font-weight: calc(3/3*500)">
                 Functional Enrichment Analysis
              </a>
          	
          	  
              
              
              <a class="dropdown-item" href="../../../manuals/rclustering/rclustering/"
              style="padding-left: 1rem; font-weight: calc(3/3*500)">
                 Cluster Analysis and Data Mining
              </a>
          	
          	  
              
              
              <a class="dropdown-item" href="../../../manuals/rgraphics/rgraphics/"
              style="padding-left: 1rem; font-weight: calc(3/3*500)">
                 Graphics and Visualization
              </a>
          	
          </div>
				
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0" style="position: relative">
				
				
				
				
				
          <a class="nav-link dropdown-toggle" href="../../../assignments/" id="navbarDropdown" role="button">
          	Assignments
          </a>
          <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
          	
          	  
              
              
              <a class="dropdown-item" href="../../../assignments/homework/"
              style="padding-left: 1rem; font-weight: calc(3/3*500)">
                 Homework
              </a>
          	
          	  
              
                
              
              
              <a class="dropdown-item" href="../../../assignments/homework/hw01/hw01/"
              style="padding-left: 2rem; font-weight: calc(3/4*500)">
                 HW1: Intro &amp; GitHub
              </a>
          	
          	  
              
                
              
              
              <a class="dropdown-item" href="../../../assignments/homework/hw02/hw02/"
              style="padding-left: 2rem; font-weight: calc(3/4*500)">
                 HW2: Linux &amp; HPC
              </a>
          	
          	  
              
                
              
              
              <a class="dropdown-item" href="../../../assignments/homework/hw03/hw03/"
              style="padding-left: 2rem; font-weight: calc(3/4*500)">
                 HW3: R Basics
              </a>
          	
          	  
              
                
              
              
              <a class="dropdown-item" href="../../../assignments/homework/hw04/hw04/"
              style="padding-left: 2rem; font-weight: calc(3/4*500)">
                 HW4: Alignments
              </a>
          	
          	  
              
                
              
              
              <a class="dropdown-item" href="../../../assignments/homework/hw05/hw05"
              style="padding-left: 2rem; font-weight: calc(3/4*500)">
                 HW5: R Programming
              </a>
          	
          	  
              
                
              
              
              <a class="dropdown-item" href="../../../assignments/homework/hw06/hw06"
              style="padding-left: 2rem; font-weight: calc(3/4*500)">
                 HW6: NGS Analysis Basics
              </a>
          	
          	  
              
                
              
              
              <a class="dropdown-item" href="../../../assignments/homework/hw07/hw07"
              style="padding-left: 2rem; font-weight: calc(3/4*500)">
                 HW7: RNA-Seq Analysis
              </a>
          	
          	  
              
                
              
              
              <a class="dropdown-item" href="../../../assignments/homework/hw08/hw08"
              style="padding-left: 2rem; font-weight: calc(3/4*500)">
                 HW8: R Markdown
              </a>
          	
          	  
              
              
              <a class="dropdown-item" href="../../../assignments/projects/"
              style="padding-left: 1rem; font-weight: calc(3/3*500)">
                 Projects
              </a>
          	
          	  
              
                
              
              
              <a class="dropdown-item" href="../../../assignments/projects/project_overview/"
              style="padding-left: 2rem; font-weight: calc(3/4*500)">
                 Overview of Projects
              </a>
          	
          	  
              
                
              
              
              <a class="dropdown-item" href="../../../assignments/projects/01_rnaseq_aligners/"
              style="padding-left: 2rem; font-weight: calc(3/4*500)">
                 RNA-Seq Aligners
              </a>
          	
          	  
              
                
              
              
              <a class="dropdown-item" href="../../../assignments/projects/02_rnaseq_deg/"
              style="padding-left: 2rem; font-weight: calc(3/4*500)">
                 DEG Methods
              </a>
          	
          	  
              
                
              
              
              <a class="dropdown-item" href="../../../assignments/projects/03_cluster_analysis/"
              style="padding-left: 2rem; font-weight: calc(3/4*500)">
                 Cluster Analysis
              </a>
          	
          	  
              
                
              
              
              <a class="dropdown-item" href="../../../assignments/projects/04_scrnaseq_embedding/"
              style="padding-left: 2rem; font-weight: calc(3/4*500)">
                 scRNA-Seq Embedding
              </a>
          	
          	  
              
                
              
              
              <a class="dropdown-item" href="../../../assignments/projects/05_chipseq_peakcaller/"
              style="padding-left: 2rem; font-weight: calc(3/4*500)">
                 ChIP-Seq Peak Callers
              </a>
          	
          	  
              
                
              
              
              <a class="dropdown-item" href="../../../assignments/projects/06_functional_enrichment/"
              style="padding-left: 2rem; font-weight: calc(3/4*500)">
                 Functional Enrichment
              </a>
          	
          	  
              
                
              
              
              <a class="dropdown-item" href="../../../assignments/projects/07_motif_enrichment/"
              style="padding-left: 2rem; font-weight: calc(3/4*500)">
                 Motif Enrichment
              </a>
          	
          	  
              
                
              
              
              <a class="dropdown-item" href="../../../assignments/projects/08_genome_graphics/"
              style="padding-left: 2rem; font-weight: calc(3/4*500)">
                 Genome Graphics
              </a>
          	
          	  
              
                
              
              
              <a class="dropdown-item" href="../../../assignments/projects/project_data/"
              style="padding-left: 2rem; font-weight: calc(3/4*500)">
                 Project Data
              </a>
          	
          	  
              
              
              <a class="dropdown-item" href="../../../assignments/presentations/"
              style="padding-left: 1rem; font-weight: calc(3/3*500)">
                 Presentations
              </a>
          	
          	  
              
                
              
              
              <a class="dropdown-item" href="../../../assignments/presentations/paper_presentations/"
              style="padding-left: 2rem; font-weight: calc(3/4*500)">
                 Paper Presentations
              </a>
          	
          </div>
				
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0" style="position: relative">
				
				
				
				
				
          <a class="nav-link dropdown-toggle" href="../../../external_resources/" id="navbarDropdown" role="button">
          	Links
          </a>
          <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
          	
          	  
              
              
              <a class="dropdown-item" href="https://piazza.com/ucr/spring2021/gen242/home"
              style="padding-left: 1rem; font-weight: calc(3/3*500)">
                 Piazza
              </a>
          	
          	  
              
              
              <a class="dropdown-item" href="https://classroom.github.com/classrooms/"
              style="padding-left: 1rem; font-weight: calc(3/3*500)">
                 GitHub Classroom
              </a>
          	
          	  
              
              
              <a class="dropdown-item" href="https://github.com/tgirke/GEN242"
              style="padding-left: 1rem; font-weight: calc(3/3*500)">
                 GitHub Repo
              </a>
          	
          	  
              
              
              <a class="dropdown-item" href="https://bioconductor.org/"
              style="padding-left: 1rem; font-weight: calc(3/3*500)">
                 Bioconductor
              </a>
          	
          	  
              
              
              <a class="dropdown-item" href="https://www.dcassol.com/docsy_Rmarkdown/rmarkdown/install/"
              style="padding-left: 1rem; font-weight: calc(3/3*500)">
                 Hugo, Docsy &amp; R
              </a>
          	
          </div>
				
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0" style="position: relative">
				
				
				
				
				
				
				
					<a class="nav-link" href="../../../blog/" ><span>News</span></a>
				
			</li>
			
			
			
		</ul>
	</div>
	<div class="navbar-nav d-none d-lg-block">



<input
  type="search"
  class="form-control td-search-input"
  placeholder="&#xf002; Search this site…"
  aria-label="Search this site…"
  autocomplete="off"
  
  data-offline-search-index-json-src="../../../offline-search-index.a43e8a053ef8d9f275ba6c7ffea32941.json"
  data-offline-search-base-href="../../../"
  data-offline-search-max-results="10"
>

</div>
</nav>

    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
            




<div id="td-sidebar-menu" class="td-sidebar__inner">
  
  <form class="td-sidebar__search d-flex align-items-center">
    



<input
  type="search"
  class="form-control td-search-input"
  placeholder="&#xf002; Search this site…"
  aria-label="Search this site…"
  autocomplete="off"
  
  data-offline-search-index-json-src="../../../offline-search-index.a43e8a053ef8d9f275ba6c7ffea32941.json"
  data-offline-search-base-href="../../../"
  data-offline-search-max-results="10"
>


    <button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type="button" data-toggle="collapse" data-target="#td-section-nav" aria-controls="td-docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    </button>
  </form>
  
  <nav class="collapse td-sidebar-nav" id="td-section-nav">
    
    
    






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="../../../tutorials/" class="align-left pl-0 pr-2 active td-sidebar-link td-sidebar-link__section">Tutorials</a>
  </li>
  <ul>
    <li class="collapse show" id="tutorials">
      
      
      
      
        
          
          
          <a class="td-sidebar-link td-sidebar-link__page " id="m-tutorialsgithubgithub" href="../../../tutorials/github/github/">GitHub</a>
        
      
      
      
        
          
          
          <a class="td-sidebar-link td-sidebar-link__page " id="m-tutorialslinuxlinux" href="../../../tutorials/linux/linux/">Linux &amp; HPCC Cluster</a>
        
      
      
      
        
          
          
          <a class="td-sidebar-link td-sidebar-link__page " id="m-tutorialsrbasicsrbasics" href="../../../tutorials/rbasics/rbasics/">Introduction to R</a>
        
      
      
      
        
          
          
          <a class="td-sidebar-link td-sidebar-link__page " id="m-tutorialsrprogrammingrprogramming" href="../../../tutorials/rprogramming/rprogramming/">Programming in R</a>
        
      
      
      
        
          
          
          <a class="td-sidebar-link td-sidebar-link__page " id="m-tutorialsrparallelrparallel" href="../../../tutorials/rparallel/rparallel/">Parallel Evaluations in R</a>
        
      
      
      
        
          
          
          <a class="td-sidebar-link td-sidebar-link__page " id="m-tutorialsrsequencesrsequences" href="../../../tutorials/rsequences/rsequences/">NGS Analysis Basics</a>
        
      
      
      
        
          
          
          <a class="td-sidebar-link td-sidebar-link__page " id="m-tutorialssystempipersystempiper" href="../../../tutorials/systempiper/systempiper/">systemPipeR: Workflow design and reporting generation environment</a>
        
      
      
      
        
          
          
          <a class="td-sidebar-link td-sidebar-link__page " id="m-tutorialssprnaseqsprnaseq" href="../../../tutorials/sprnaseq/sprnaseq/">RNA-Seq Workflow Template</a>
        
      
      
      
        
          
          
          <a class="td-sidebar-link td-sidebar-link__page " id="m-tutorialsspchipseqspchipseq" href="../../../tutorials/spchipseq/spchipseq/">ChIP-Seq Workflow Template</a>
        
      
      
      
        
          
          
          <a class="td-sidebar-link td-sidebar-link__page " id="m-tutorialsrmarkdownrmarkdown" href="../../../tutorials/rmarkdown/rmarkdown/">R Markdown Tutorial</a>
        
      
      
      
        
          
          
          <a class="td-sidebar-link td-sidebar-link__page " id="m-tutorialsrfearfea" href="../../../tutorials/rfea/rfea/">Functional Enrichment Analysis</a>
        
      
      
      
        
          
          
          <a class="td-sidebar-link td-sidebar-link__page " id="m-tutorialsrclusteringrclustering" href="../../../tutorials/rclustering/rclustering/">Cluster Analysis in R</a>
        
      
      
      
        
          
          
          <a class="td-sidebar-link td-sidebar-link__page " id="m-tutorialsshinyappsshinyapps" href="../../../tutorials/shinyapps/shinyapps/">Shiny Apps</a>
        
      
      
      
        
          
          
          <a class="td-sidebar-link td-sidebar-link__page  active" id="m-tutorialsrgraphicsrgraphics" href="../../../tutorials/rgraphics/rgraphics/">Graphics and Data Visualization in R</a>
        
      
      
    </li>
  </ul>
</ul>

  </nav>
</div>




          </div>
          
          

          
            
          

          
          
              <div class="d-none d-xl-block col-xl-2 td-toc d-print-none">
                
  
  
  
  
  
  <div class="td-page-meta ml-2 pb-1 pt-2 mb-0">
  
    
    
      
    
    
    
    
    
    
    
    


    
    
      <a href="https://raw.githubusercontent.com/tgirke/GEN242//main/content/en/tutorials/rgraphics/rgraphics.Rmd" target="_blank" class="source-link"><i class="fa fa-code fa-fw"></i> View Rmd source</a>
    

    <a href="https://github.com/tgirke/GEN242//edit/main/content/en/tutorials/rgraphics/rgraphics.md" target="_blank"><i class="fa fa-edit fa-fw"></i> Edit this page</a>
    <a href="https://github.com/tgirke/GEN242//new/main/content/en/tutorials/rgraphics/rgraphics.md?filename=change-me.md&amp;value=---%0Atitle%3A&#43;%22Long&#43;Page&#43;Title%22%0AlinkTitle%3A&#43;%22Short&#43;Nav&#43;Title%22%0Aweight%3A&#43;100%0Adescription%3A&#43;%3E-%0A&#43;&#43;&#43;&#43;&#43;Page&#43;description&#43;for&#43;heading&#43;and&#43;indexes.%0A---%0A%0A%23%23&#43;Heading%0A%0AEdit&#43;this&#43;template&#43;to&#43;create&#43;your&#43;new&#43;page.%0A%0A%2A&#43;Give&#43;it&#43;a&#43;good&#43;name%2C&#43;ending&#43;in&#43;%60.md%60&#43;-&#43;e.g.&#43;%60getting-started.md%60%0A%2A&#43;Edit&#43;the&#43;%22front&#43;matter%22&#43;section&#43;at&#43;the&#43;top&#43;of&#43;the&#43;page&#43;%28weight&#43;controls&#43;how&#43;its&#43;ordered&#43;amongst&#43;other&#43;pages&#43;in&#43;the&#43;same&#43;directory%3B&#43;lowest&#43;number&#43;first%29.%0A%2A&#43;Add&#43;a&#43;good&#43;commit&#43;message&#43;at&#43;the&#43;bottom&#43;of&#43;the&#43;page&#43;%28%3C80&#43;characters%3B&#43;use&#43;the&#43;extended&#43;description&#43;field&#43;for&#43;more&#43;detail%29.%0A%2A&#43;Create&#43;a&#43;new&#43;branch&#43;so&#43;you&#43;can&#43;preview&#43;your&#43;new&#43;file&#43;and&#43;request&#43;a&#43;review&#43;via&#43;Pull&#43;Request.%0A" target="_blank"><i class="fa fa-edit fa-fw"></i> Create child page</a>
    <a href="https://github.com/tgirke/GEN242//issues/new?title=Graphics%20and%20Data%20Visualization%20in%20R" target="_blank"><i class="fab fa-github fa-fw"></i> Create documentation issue</a>
    
      
      <a href="https://github.com/tgirke/GEN242/issues/new" target="_blank"><i class="fas fa-tasks fa-fw"></i> Create project issue</a>
    

  
  
  </div>





<nav id="TableOfContents">
  <ul>
    <li><a href="#overview">Overview</a>
      <ul>
        <li><a href="#graphics-in-r">Graphics in R</a></li>
        <li><a href="#documentation-on-graphics-in-r">Documentation on Graphics in R</a></li>
        <li><a href="#graphics-environments">Graphics Environments</a></li>
      </ul>
    </li>
    <li><a href="#base-graphics">Base Graphics</a>
      <ul>
        <li><a href="#overview-1">Overview</a></li>
        <li><a href="#preferred-input-data-objects">Preferred Input Data Objects</a></li>
        <li><a href="#scatter-plots">Scatter Plots</a>
          <ul>
            <li><a href="#basic-scatter-plots">Basic scatter plots</a></li>
            <li><a href="#all-pairs">All pairs</a></li>
            <li><a href="#plot-labels">Plot labels</a></li>
            <li><a href="#more-examples">More examples</a></li>
            <li><a href="#exercise-1">Exercise 1</a></li>
          </ul>
        </li>
        <li><a href="#line-plots">Line Plots</a>
          <ul>
            <li><a href="#single-data-set">Single Data Set</a></li>
            <li><a href="#many-data-sets">Many Data Sets</a></li>
          </ul>
        </li>
        <li><a href="#bar-plots">Bar Plots</a>
          <ul>
            <li><a href="#basics">Basics</a></li>
            <li><a href="#error-bars">Error bars</a></li>
            <li><a href="#mirrored-bar-plot">Mirrored bar plot</a></li>
          </ul>
        </li>
        <li><a href="#histograms">Histograms</a></li>
        <li><a href="#density-plots">Density Plots}</a></li>
        <li><a href="#pie-charts">Pie Charts</a></li>
        <li><a href="#color-selection-utilities">Color Selection Utilities</a></li>
        <li><a href="#arranging-several-plots-on-single-page">Arranging Several Plots on Single Page</a>
          <ul>
            <li><a href="#arranging-plots-with-variable-width">Arranging Plots with Variable Width</a></li>
          </ul>
        </li>
        <li><a href="#saving-graphics-to-files">Saving Graphics to Files</a>
          <ul>
            <li><a href="#exercise-2">Exercise 2</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#grid-graphics">Grid Graphics</a></li>
    <li><a href="#lattice-graphics">lattice Graphics</a>
      <ul>
        <li><a href="#scatter-plot-sample">Scatter Plot Sample</a></li>
        <li><a href="#line-plot-sample">Line Plot Sample</a></li>
      </ul>
    </li>
    <li><a href="#ggplot2-graphics">ggplot2 Graphics</a>
      <ul>
        <li><a href="#ggplot2-usage"><code>ggplot2</code> Usage</a></li>
        <li><a href="#qplot-function"><code>qplot</code> Function</a></li>
        <li><a href="#qplot-scatter-plot-basics"><code>qplot</code>: scatter plot basics</a>
          <ul>
            <li><a href="#colored-groups">Colored groups</a></li>
            <li><a href="#regression-line">Regression line</a></li>
            <li><a href="#local-regression-curve-loess">Local regression curve (loess)</a></li>
          </ul>
        </li>
        <li><a href="#ggplot-function"><code>ggplot</code> Function</a>
          <ul>
            <li><a href="#changing-plotting-themes-in-ggplot">Changing Plotting Themes in <code>ggplot</code></a></li>
            <li><a href="#storing-ggplot-specifications">Storing <code>ggplot</code> Specifications</a></li>
          </ul>
        </li>
        <li><a href="#ggplot-scatter-plots"><code>ggplot</code>: scatter plots</a>
          <ul>
            <li><a href="#basic-example">Basic example</a></li>
            <li><a href="#regression-line-1">Regression line</a></li>
            <li><a href="#several-regression-lines">Several regression lines</a></li>
            <li><a href="#local-regression-curve-loess-1">Local regression curve (loess)</a></li>
          </ul>
        </li>
        <li><a href="#ggplot-line-plot"><code>ggplot</code>: line plot</a></li>
        <li><a href="#faceting">Faceting</a>
          <ul>
            <li><a href="#exercise-3">Exercise 3</a></li>
          </ul>
        </li>
        <li><a href="#bar-plots-1">Bar Plots</a>
          <ul>
            <li><a href="#verical-orientation">Verical orientation</a></li>
            <li><a href="#horizontal-orientation">Horizontal orientation</a></li>
            <li><a href="#faceting-1">Faceting</a></li>
            <li><a href="#error-bars-1">Error bars</a></li>
            <li><a href="#mirrored">Mirrored</a></li>
          </ul>
        </li>
        <li><a href="#changing-color-settings">Changing Color Settings</a>
          <ul>
            <li><a href="#using-standard-colors">Using standard colors</a></li>
            <li><a href="#exercise-4">Exercise 4</a></li>
          </ul>
        </li>
        <li><a href="#data-reformatting-example">Data reformatting example</a></li>
        <li><a href="#jitter-plots">Jitter Plots</a></li>
        <li><a href="#box-plots">Box plots</a></li>
        <li><a href="#violin-plots">Violin plots</a></li>
        <li><a href="#density-plots-1">Density plots</a>
          <ul>
            <li><a href="#line-coloring">Line coloring</a></li>
            <li><a href="#area-coloring">Area coloring</a></li>
          </ul>
        </li>
        <li><a href="#histograms-1">Histograms</a></li>
        <li><a href="#pie-chart">Pie Chart</a></li>
        <li><a href="#wind-rose-pie-chart">Wind Rose Pie Chart</a></li>
        <li><a href="#arranging-graphics-on-page">Arranging Graphics on Page</a></li>
        <li><a href="#inserting-graphics-into-plots">Inserting Graphics into Plots</a></li>
      </ul>
    </li>
    <li><a href="#specialty-graphics">Specialty Graphics</a>
      <ul>
        <li><a href="#venn-diagrams">Venn Diagrams</a></li>
        <li><a href="#compound-structures">Compound Structures</a></li>
        <li><a href="#roc-plots">ROC Plots</a>
          <ul>
            <li><a href="#example">Example</a></li>
          </ul>
        </li>
        <li><a href="#trees">Trees</a></li>
      </ul>
    </li>
    <li><a href="#genome-graphics">Genome Graphics</a>
      <ul>
        <li><a href="#ggbio"><code>ggbio</code></a>
          <ul>
            <li><a href="#tracks-aligning-plots-along-chromosomes">Tracks: aligning plots along chromosomes</a></li>
            <li><a href="#plotting-genomic-ranges">Plotting genomic ranges</a></li>
            <li><a href="#plotting-coverage">Plotting coverage</a></li>
            <li><a href="#mirrored-coverage">Mirrored coverage</a></li>
          </ul>
        </li>
        <li><a href="#circular-genome-plots">Circular genome plots</a>
          <ul>
            <li><a href="#alignments-and-variants">Alignments and variants</a></li>
          </ul>
        </li>
        <li><a href="#additional-examples">Additional examples</a></li>
        <li><a href="#additional-genome-graphics">Additional genome graphics</a></li>
        <li><a href="#genome-browser-igv">Genome Browser: IGV</a>
          <ul>
            <li><a href="#create-symbolic-links">Create symbolic links</a></li>
            <li><a href="#controlling-igv-from-r">Controlling IGV from R</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#references">References</a></li>
  </ul>
</nav>



              </div>
              <main class="col-12 col-md-9 col-xl-8 pl-md-5" role="main">
                
  

                <nav aria-label="breadcrumb" class="d-none d-md-block d-print-none">
	<ol class="breadcrumb spb-1">
		







<li class="breadcrumb-item" >
	<a href="../../../tutorials/">Tutorials</a>
</li>




<li class="breadcrumb-item active" aria-current="page">
	<a href="../../../tutorials/rgraphics/rgraphics/">Graphics and Data Visualization in R</a>
</li>

	</ol>
</nav	>

                
<div class="td-content">
	<h1>Graphics and Data Visualization in R</h1>
    
	
        <p class="reading-time"><i class="fa fa-clock" aria-hidden="true"></i> 44 minute read</p>
           
	<script src="../../../rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="../../../rmarkdown-libs/plotly-binding/plotly.js"></script>
<script src="../../../rmarkdown-libs/typedarray/typedarray.min.js"></script>
<script src="../../../rmarkdown-libs/jquery/jquery.min.js"></script>
<link href="../../../rmarkdown-libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
<script src="../../../rmarkdown-libs/crosstalk/js/crosstalk.min.js"></script>
<link href="../../../rmarkdown-libs/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="../../../rmarkdown-libs/plotly-main/plotly-latest.min.js"></script>
<!--
- Compile from command-line
Rscript -e "rmarkdown::render('rgraphics.Rmd', c('html_document'), clean=F); knitr::knit('rgraphics.Rmd', tangle=TRUE)"
-->
<script type="text/javascript">
document.addEventListener("DOMContentLoaded", function() {
  document.querySelector("h1").className = "title";
});
</script>
<script type="text/javascript">
document.addEventListener("DOMContentLoaded", function() {
  var links = document.links;  
  for (var i = 0, linksLength = links.length; i < linksLength; i++)
    if (links[i].hostname != window.location.hostname)
      links[i].target = '_blank';
});
</script>
<div style="text-align: right">
<p>Source code downloads:    
[ <a href="https://raw.githubusercontent.com/tgirke/GEN242//main/content/en/tutorials/rgraphics/rgraphics.Rmd">.Rmd</a> ]    
[ <a href="https://raw.githubusercontent.com/tgirke/GEN242//main/content/en/tutorials/rgraphics/rgraphics.R">.R</a> ]</p>
</div>
<h2 id="overview">Overview</h2>
<h3 id="graphics-in-r">Graphics in R</h3>
<ul>
<li>Powerful environment for visualizing scientific data</li>
<li>Integrated graphics and statistics infrastructure</li>
<li>Publication quality graphics</li>
<li>Fully programmable</li>
<li>Highly reproducible</li>
<li>Full <a href="http://www.latex-project.org/">LaTeX</a>, <a href="http://www.stat.auckland.ac.nz/~dscott/782/Sweave-manual-20060104.pdf">Sweave</a>, <a href="http://yihui.name/knitr/">knitr</a> and <a href="http://rmarkdown.rstudio.com/">R Markdown</a> support.</li>
<li>Vast number of R packages with graphics utilities</li>
</ul>
<h3 id="documentation-on-graphics-in-r">Documentation on Graphics in R</h3>
<ul>
<li>General
<ul>
<li><a href="http://cran.r-project.org/web/views/Graphics.html">Graphics Task Page</a></li>
<li><a href="http://www.r-graph-gallery.com/">R Graph Gallery</a></li>
<li><a href="https://www.imsbio.co.jp/RGM/R_image_list?page=575&amp;init=true">R Graphical Manual</a></li>
<li><a href="http://www.stat.auckland.ac.nz/~paul/RGraphics/rgraphics.html">Paul Murrell’s book R (Grid) Graphics</a></li>
</ul>
</li>
<li>Interactive graphics
<ul>
<li><a href="http://www.ggobi.org/">rggobi (GGobi)</a></li>
<li><a href="http://www.iplots.org/">iplots</a></li>
<li><a href="http://rgl.neoscientists.org/gallery.shtml">Open GL (<code>rgl</code>)</a></li>
<li><a href="https://plotly.com/r/">plotly</a></li>
</ul>
</li>
</ul>
<h3 id="graphics-environments">Graphics Environments</h3>
<ul>
<li>Viewing and savings graphics in R
<ul>
<li>On-screen graphics</li>
<li>postscript, pdf, svg</li>
<li>jpeg/png/wmf/tiff/…</li>
</ul>
</li>
<li>Four major graphics environments
<ul>
<li>Low-level infrastructure
<ul>
<li>R Base Graphics (low- and high-level)</li>
<li><code>grid</code>: <a href="http://www.stat.auckland.ac.nz/~paul/grid/grid.html">Manual</a>, <a href="http://www.stat.auckland.ac.nz/~paul/RGraphics/rgraphics.html">Book</a></li>
</ul>
</li>
<li>High-level infrastructure
<ul>
<li><code>lattice</code>: <a href="http://lmdvr.r-forge.r-project.org">Manual</a>, <a href="http://www.his.sunderland.ac.uk/~cs0her/Statistics/UsingLatticeGraphicsInR.htm">Intro</a>, <a href="http://www.amazon.com/Lattice-Multivariate-Data-Visualization-Use/dp/0387759689">Book</a></li>
<li><code>ggplot2</code>: <a href="http://docs.ggplot2.org/current/">Manual</a>, <a href="http://www.ling.upenn.edu/~joseff/rstudy/summer2010_ggplot2_intro.html">Intro</a>, <a href="http://had.co.nz/ggplot2/book/">Book</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="base-graphics">Base Graphics</h2>
<h3 id="overview-1">Overview</h3>
<ul>
<li>Important high-level plotting functions
<ul>
<li><code>plot</code>: generic x-y plotting</li>
<li><code>barplot</code>: bar plots</li>
<li><code>boxplot</code>: box-and-whisker plot</li>
<li><code>hist</code>: histograms</li>
<li><code>pie</code>: pie charts</li>
<li><code>dotchart</code>: cleveland dot plots</li>
<li><code>image, heatmap, contour, persp</code>: functions to generate image-like plots</li>
<li><code>qqnorm, qqline, qqplot</code>: distribution comparison plots</li>
<li><code>pairs, coplot</code>: display of multivariant data</li>
</ul>
</li>
<li>Help on these functions
<ul>
<li><code>?myfct</code></li>
<li><code>?plot</code></li>
<li><code>?par</code></li>
</ul>
</li>
</ul>
<h3 id="preferred-input-data-objects">Preferred Input Data Objects</h3>
<ul>
<li>Matrices and data frames</li>
<li>Vectors</li>
<li>Named vectors</li>
</ul>
<h3 id="scatter-plots">Scatter Plots</h3>
<h4 id="basic-scatter-plots">Basic scatter plots</h4>
<p>Sample data set for subsequent plots</p>
<pre><code class="language-r">set.seed(1410)
y &lt;- matrix(runif(30), ncol=3, dimnames=list(letters[1:10], LETTERS[1:3]))
y
</code></pre>
<pre><code>##            A          B            C
## a 0.26904539 0.47439030 0.4427788756
## b 0.53178658 0.31128960 0.3233293493
## c 0.93379571 0.04576263 0.0004628517
## d 0.14314802 0.12066723 0.4104402000
## e 0.57627063 0.83251909 0.9884746270
## f 0.49001235 0.38298651 0.8235850153
## g 0.66562596 0.70857731 0.7490944304
## h 0.50089252 0.24772695 0.2117313873
## i 0.57033245 0.06044799 0.8776291364
## j 0.04087422 0.85814118 0.1061618729
</code></pre>
<pre><code class="language-r">plot(y[,1], y[,2]) 
</code></pre>
<p><img src="../../../en/tutorials/rgraphics/rgraphics_files/figure-html/scatter_plot_basic-1.png" width="672" /></p>
<h4 id="all-pairs">All pairs</h4>
<pre><code class="language-r">pairs(y) 
</code></pre>
<p><img src="../../../en/tutorials/rgraphics/rgraphics_files/figure-html/scatter_plot_allpairs-1.png" width="672" /></p>
<h4 id="plot-labels">Plot labels</h4>
<pre><code class="language-r">plot(y[,1], y[,2], pch=20, col=&quot;red&quot;, main=&quot;Symbols and Labels&quot;)
text(y[,1]+0.03, y[,2], rownames(y))
</code></pre>
<p><img src="../../../en/tutorials/rgraphics/rgraphics_files/figure-html/scatter_plot_labels-1.png" width="672" /></p>
<h4 id="more-examples">More examples</h4>
<p>Print instead of symbols the row names</p>
<pre><code class="language-r">plot(y[,1], y[,2], type=&quot;n&quot;, main=&quot;Plot of Labels&quot;)
text(y[,1], y[,2], rownames(y)) 
</code></pre>
<p>Usage of important plotting parameters</p>
<pre><code class="language-r">grid(5, 5, lwd = 2) 
op &lt;- par(mar=c(8,8,8,8), bg=&quot;lightblue&quot;)
plot(y[,1], y[,2], type=&quot;p&quot;, col=&quot;red&quot;, cex.lab=1.2, cex.axis=1.2, 
     cex.main=1.2, cex.sub=1, lwd=4, pch=20, xlab=&quot;x label&quot;, 
     ylab=&quot;y label&quot;, main=&quot;My Main&quot;, sub=&quot;My Sub&quot;)
par(op)
</code></pre>
<p>Important arguments}</p>
<ul>
<li><code>mar</code>: specifies the margin sizes around the plotting area in order: <code>c(bottom, left, top, right)</code></li>
<li><code>col</code>: color of symbols</li>
<li><code>pch</code>: type of symbols, samples: <code>example(points)</code></li>
<li><code>lwd</code>: size of symbols</li>
<li><code>cex.*</code>: control font sizes</li>
<li>For details see <code>?par</code></li>
</ul>
<p>Add a regression line to a plot</p>
<pre><code class="language-r">plot(y[,1], y[,2])
myline &lt;- lm(y[,2]~y[,1]); abline(myline, lwd=2) 
</code></pre>
<p><img src="../../../en/tutorials/rgraphics/rgraphics_files/figure-html/scatter_plot_regress-1.png" width="672" /></p>
<pre><code class="language-r">summary(myline) 
</code></pre>
<pre><code>## 
## Call:
## lm(formula = y[, 2] ~ y[, 1])
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.40357 -0.17912 -0.04299  0.22147  0.46623 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)   0.5764     0.2110   2.732   0.0258 *
## y[, 1]       -0.3647     0.3959  -0.921   0.3839  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.3095 on 8 degrees of freedom
## Multiple R-squared:  0.09589,    Adjusted R-squared:  -0.01712 
## F-statistic: 0.8485 on 1 and 8 DF,  p-value: 0.3839
</code></pre>
<p>Same plot as above, but on log scale</p>
<pre><code class="language-r">plot(y[,1], y[,2], log=&quot;xy&quot;) 
</code></pre>
<p><img src="../../../en/tutorials/rgraphics/rgraphics_files/figure-html/scatter_plot_log_scale-1.png" width="672" /></p>
<p>Add a mathematical expression to a plot</p>
<pre><code class="language-r">plot(y[,1], y[,2]); text(y[1,1], y[1,2], 
     expression(sum(frac(1,sqrt(x^2*pi)))), cex=1.3) 
</code></pre>
<p><img src="../../../en/tutorials/rgraphics/rgraphics_files/figure-html/scatter_plot_math-1.png" width="672" /></p>
<h4 id="exercise-1">Exercise 1</h4>
<ul>
<li><strong>Task 1</strong>: Generate scatter plot for first two columns in <code>iris</code> data frame and color dots by its <code>Species</code> column.</li>
<li><strong>Task 2</strong>: Use the <code>xlim/ylim</code> arguments to set limits on the x- and y-axes so that all data points are restricted to the left bottom quadrant of the plot.</li>
</ul>
<p>Structure of iris data set:</p>
<pre><code class="language-r">class(iris)
</code></pre>
<pre><code>## [1] &quot;data.frame&quot;
</code></pre>
<pre><code class="language-r">iris[1:4,]
</code></pre>
<pre><code>##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1          5.1         3.5          1.4         0.2  setosa
## 2          4.9         3.0          1.4         0.2  setosa
## 3          4.7         3.2          1.3         0.2  setosa
## 4          4.6         3.1          1.5         0.2  setosa
</code></pre>
<pre><code class="language-r">table(iris$Species)
</code></pre>
<pre><code>## 
##     setosa versicolor  virginica 
##         50         50         50
</code></pre>
<h3 id="line-plots">Line Plots</h3>
<h4 id="single-data-set">Single Data Set</h4>
<pre><code class="language-r">plot(y[,1], type=&quot;l&quot;, lwd=2, col=&quot;blue&quot;) 
</code></pre>
<p><img src="../../../en/tutorials/rgraphics/rgraphics_files/figure-html/line_plot_single-1.png" width="672" /></p>
<h4 id="many-data-sets">Many Data Sets</h4>
<p>Plots line graph for all columns in data frame <code>y</code>. The <code>split.screen</code> function is used in this example in a for loop to overlay several line graphs in the same plot.</p>
<pre><code class="language-r">split.screen(c(1,1)) 
</code></pre>
<pre><code>## [1] 1
</code></pre>
<pre><code class="language-r">plot(y[,1], ylim=c(0,1), xlab=&quot;Measurement&quot;, ylab=&quot;Intensity&quot;, type=&quot;l&quot;, lwd=2, col=1)
for(i in 2:length(y[1,])) { 
    screen(1, new=FALSE)
    plot(y[,i], ylim=c(0,1), type=&quot;l&quot;, lwd=2, col=i, xaxt=&quot;n&quot;, yaxt=&quot;n&quot;, ylab=&quot;&quot;, 
             xlab=&quot;&quot;, main=&quot;&quot;, bty=&quot;n&quot;) 
}
</code></pre>
<p><img src="../../../en/tutorials/rgraphics/rgraphics_files/figure-html/line_plot_many-1.png" width="672" /></p>
<pre><code class="language-r">close.screen(all=TRUE) 
</code></pre>
<h3 id="bar-plots">Bar Plots</h3>
<h4 id="basics">Basics</h4>
<pre><code class="language-r">barplot(y[1:4,], ylim=c(0, max(y[1:4,])+0.3), beside=TRUE, 
        legend=letters[1:4]) 
text(labels=round(as.vector(as.matrix(y[1:4,])),2), x=seq(1.5, 13, by=1)
     +sort(rep(c(0,1,2), 4)), y=as.vector(as.matrix(y[1:4,]))+0.04) 
</code></pre>
<p><img src="../../../en/tutorials/rgraphics/rgraphics_files/figure-html/bar_plot_basic-1.png" width="672" /></p>
<h4 id="error-bars">Error bars</h4>
<pre><code class="language-r">bar &lt;- barplot(m &lt;- rowMeans(y) * 10, ylim=c(0, 10))
stdev &lt;- sd(t(y))
arrows(bar, m, bar, m + stdev, length=0.15, angle = 90)
</code></pre>
<p><img src="../../../en/tutorials/rgraphics/rgraphics_files/figure-html/bar_plot_error_bar-1.png" width="672" /></p>
<h4 id="mirrored-bar-plot">Mirrored bar plot</h4>
<pre><code class="language-r">df &lt;- data.frame(group = rep(c(&quot;Above&quot;, &quot;Below&quot;), each=10), x = rep(1:10, 2), y = c(runif(10, 0, 1), runif(10, -1, 0)))
plot(c(0,12), range(df$y), type = &quot;n&quot;)
barplot(height = df$y[df$group == &quot;Above&quot;], add = TRUE, axes = FALSE)
barplot(height = df$y[df$group == &quot;Below&quot;], add = TRUE, axes = FALSE)
</code></pre>
<p><img src="../../../en/tutorials/rgraphics/rgraphics_files/figure-html/bar_plot_mirrored-1.png" width="672" /></p>
<h3 id="histograms">Histograms</h3>
<pre><code class="language-r">hist(y, freq=TRUE, breaks=10)
</code></pre>
<p><img src="../../../en/tutorials/rgraphics/rgraphics_files/figure-html/hist_plot-1.png" width="672" /></p>
<h3 id="density-plots">Density Plots}</h3>
<pre><code class="language-r">plot(density(y), col=&quot;red&quot;)
</code></pre>
<p><img src="../../../en/tutorials/rgraphics/rgraphics_files/figure-html/density_plot-1.png" width="672" /></p>
<h3 id="pie-charts">Pie Charts</h3>
<pre><code class="language-r">pie(y[,1], col=rainbow(length(y[,1]), start=0.1, end=0.8), clockwise=TRUE)
legend(&quot;topright&quot;, legend=row.names(y), cex=1.3, bty=&quot;n&quot;, pch=15, pt.cex=1.8, 
col=rainbow(length(y[,1]), start=0.1, end=0.8), ncol=1) 
</code></pre>
<p><img src="../../../en/tutorials/rgraphics/rgraphics_files/figure-html/pie_chart-1.png" width="672" /></p>
<h3 id="color-selection-utilities">Color Selection Utilities</h3>
<p>Default color palette and how to change it</p>
<pre><code class="language-r">palette()
</code></pre>
<pre><code>## [1] &quot;black&quot;   &quot;#DF536B&quot; &quot;#61D04F&quot; &quot;#2297E6&quot; &quot;#28E2E5&quot; &quot;#CD0BBC&quot; &quot;#F5C710&quot; &quot;gray62&quot;
</code></pre>
<pre><code class="language-r">palette(rainbow(5, start=0.1, end=0.2))
palette()
</code></pre>
<pre><code>## [1] &quot;#FF9900&quot; &quot;#FFBF00&quot; &quot;#FFE600&quot; &quot;#F2FF00&quot; &quot;#CCFF00&quot;
</code></pre>
<pre><code class="language-r">palette(&quot;default&quot;)
</code></pre>
<p>The <code>gray</code> function allows to select any type of gray shades by providing values from 0 to 1</p>
<pre><code class="language-r">gray(seq(0.1, 1, by= 0.2))
</code></pre>
<pre><code>## [1] &quot;#1A1A1A&quot; &quot;#4D4D4D&quot; &quot;#808080&quot; &quot;#B3B3B3&quot; &quot;#E6E6E6&quot;
</code></pre>
<p>Color gradients with <code>colorpanel</code> function from <code>gplots</code> library</p>
<pre><code class="language-r">library(gplots)
colorpanel(5, &quot;darkblue&quot;, &quot;yellow&quot;, &quot;white&quot;)
</code></pre>
<p>Much more on colors in R see Earl Glynn’s <a href="http://research.stowers-institute.org/efg/R/Color/Chart/">color chart</a></p>
<h3 id="arranging-several-plots-on-single-page">Arranging Several Plots on Single Page</h3>
<p>With <code>par(mfrow=c(nrow, ncol))</code> one can define how several plots are arranged next to each other.</p>
<pre><code class="language-r">par(mfrow=c(2,3)) 
for(i in 1:6) plot(1:10) 
</code></pre>
<p><img src="../../../en/tutorials/rgraphics/rgraphics_files/figure-html/par_mfrow-1.png" width="672" /></p>
<h4 id="arranging-plots-with-variable-width">Arranging Plots with Variable Width</h4>
<p>The <code>layout</code> function allows to divide the plotting device into variable numbers of rows and columns with the column-widths and the row-heights specified in the respective arguments.</p>
<pre><code class="language-r">nf &lt;- layout(matrix(c(1,2,3,3), 2, 2, byrow=TRUE), c(3,7), c(5,5), 
             respect=TRUE)
# layout.show(nf)
for(i in 1:3) barplot(1:10) 
</code></pre>
<p><img src="../../../en/tutorials/rgraphics/rgraphics_files/figure-html/layout_plot-1.png" width="672" /></p>
<h3 id="saving-graphics-to-files">Saving Graphics to Files</h3>
<p>After the <code>pdf()</code> command all graphs are redirected to file <code>test.pdf</code>. Works for all common formats similarly: jpeg, png, ps, tiff, …</p>
<pre><code class="language-r">pdf(&quot;test.pdf&quot;); plot(1:10, 1:10); dev.off() 
</code></pre>
<p>Generates Scalable Vector Graphics (SVG) files that can be edited in vector graphics programs, such as InkScape.</p>
<pre><code class="language-r">svg(&quot;test.svg&quot;); plot(1:10, 1:10); dev.off() 
</code></pre>
<h4 id="exercise-2">Exercise 2</h4>
<p>Bar plots</p>
<ul>
<li><strong>Task 1</strong>: Calculate the mean values for the <code>Species</code> components of the first four columns in the <code>iris</code> data set. Organize the results in a matrix where the row names are the unique values from the <code>iris Species</code> column and the column names are the same as in the first four <code>iris</code> columns.</li>
<li><strong>Task 2</strong>: Generate two bar plots: one with stacked bars and one with horizontally arranged bars.</li>
</ul>
<p>Structure of iris data set:</p>
<pre><code class="language-r">class(iris)
</code></pre>
<pre><code>## [1] &quot;data.frame&quot;
</code></pre>
<pre><code class="language-r">iris[1:4,]
</code></pre>
<pre><code>##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1          5.1         3.5          1.4         0.2  setosa
## 2          4.9         3.0          1.4         0.2  setosa
## 3          4.7         3.2          1.3         0.2  setosa
## 4          4.6         3.1          1.5         0.2  setosa
</code></pre>
<pre><code class="language-r">table(iris$Species)
</code></pre>
<pre><code>## 
##     setosa versicolor  virginica 
##         50         50         50
</code></pre>
<h2 id="grid-graphics">Grid Graphics</h2>
<ul>
<li>What is <code>grid</code>?
<ul>
<li>Low-level graphics system</li>
<li>Highly flexible and controllable system</li>
<li>Does not provide high-level functions</li>
<li>Intended as development environment for custom plotting functions</li>
<li>Pre-installed on new R distributions</li>
</ul>
</li>
<li>Documentation and Help
<ul>
<li><a href="http://www.stat.auckland.ac.nz/~paul/grid/grid.html">Manual</a></li>
<li><a href="http://www.stat.auckland.ac.nz/~paul/RGraphics/rgraphics.html">Book</a></li>
</ul>
</li>
</ul>
<h2 id="lattice-graphics">lattice Graphics</h2>
<ul>
<li>What is <code>lattice</code>?
<ul>
<li>High-level graphics system</li>
<li>Developed by Deepayan Sarkar</li>
<li>Implements Trellis graphics system from S-Plus</li>
<li>Simplifies high-level plotting tasks: arranging complex graphical features</li>
<li>Syntax similar to R’s base graphics</li>
</ul>
</li>
<li>Documentation and Help
<ul>
<li><a href="http://lmdvr.r-forge.r-project.org">Manual</a></li>
<li><a href="https://www.statmethods.net/advgraphs/trellis.html">Intro</a></li>
<li><a href="http://www.amazon.com/Lattice-Multivariate-Data-Visualization-Use/dp/0387759689">Book</a></li>
</ul>
</li>
</ul>
<p>Open a list of all functions available in the lattice package</p>
<pre><code class="language-r">library(lattice) 
library(help=lattice) 
</code></pre>
<p>Accessing and changing global parameters:</p>
<pre><code class="language-r">?lattice.options
?trellis.device
</code></pre>
<h3 id="scatter-plot-sample">Scatter Plot Sample</h3>
<pre><code class="language-r">library(lattice)
p1 &lt;- xyplot(1:8 ~ 1:8 | rep(LETTERS[1:4], each=2), as.table=TRUE) 
plot(p1)
</code></pre>
<p><img src="../../../en/tutorials/rgraphics/rgraphics_files/figure-html/scatter_plot_lattice-1.png" width="672" /></p>
<h3 id="line-plot-sample">Line Plot Sample</h3>
<pre><code class="language-r">library(lattice)
p2 &lt;- parallelplot(~iris[1:4] | Species, iris, horizontal.axis = FALSE, 
              layout = c(1, 3, 1))  
plot(p2)
</code></pre>
<p><img src="../../../en/tutorials/rgraphics/rgraphics_files/figure-html/line_plot_lattice-1.png" width="672" /></p>
<h2 id="ggplot2-graphics">ggplot2 Graphics</h2>
<ul>
<li>What is <code>ggplot2</code>?
<ul>
<li>High-level graphics system developed by Hadley Wickham</li>
<li>Implements grammar of graphics from <a href="http://www.amazon.com/Grammar-Graphics-Leland-Wilkinson/dp/0387987746">Leland Wilkinson</a></li>
<li>Streamlines many graphics workflows for complex plots</li>
<li>Syntax centered around main <code>ggplot</code> function</li>
<li>Simpler <code>qplot</code> function provides many shortcuts</li>
</ul>
</li>
<li>Documentation and Help
<ul>
<li><a href="https://ggplot2.tidyverse.org/reference/">Manual</a></li>
<li><a href="https://ggplot2-book.org/">Book</a></li>
<li><a href="http://www.cookbook-r.com/Graphs/">Cookbook for R</a></li>
</ul>
</li>
</ul>
<h3 id="ggplot2-usage"><code>ggplot2</code> Usage</h3>
<ul>
<li><code>ggplot</code> function accepts two main arguments
<ul>
<li>Data set to be plotted</li>
<li>Aesthetic mappings provided by <code>aes</code> function</li>
</ul>
</li>
<li>Additional parameters such as geometric objects (<em>e.g.</em> points, lines, bars) are passed on by appending them with <code>+</code> as separator.</li>
<li>List of available <code>geom_*</code> functions see <a href="https://ggplot2.tidyverse.org/reference/">here</a></li>
<li>Settings of plotting theme can be accessed with the command <code>theme_get()</code> and its settings can be changed with <code>theme()</code>.</li>
<li>Preferred input data object
<ul>
<li><code>qplot</code>: <code>data.frame</code> or <code>tibble</code> (support for <code>vector</code>, <code>matrix</code>, <code>...</code>)</li>
<li><code>ggplot</code>: <code>data.frame</code> or <code>tibble</code></li>
</ul>
</li>
<li>Packages with convenience utilities to create expected inputs
<ul>
<li><code>dplyr</code> (<code>plyr</code>)</li>
<li><code>reshape</code></li>
</ul>
</li>
</ul>
<h3 id="qplot-function"><code>qplot</code> Function</h3>
<p>The syntax of <code>qplot</code> is similar as R’s basic <code>plot</code> function</p>
<ul>
<li>Arguments
<ul>
<li><code>x</code>: x-coordinates (<em>e.g.</em> <code>col1</code>)</li>
<li><code>y</code>: y-coordinates (<em>e.g.</em> <code>col2</code>)</li>
<li><code>data</code>: <code>data.frame</code> or <code>tibble</code> with corresponding column names</li>
<li><code>xlim, ylim</code>: <em>e.g.</em> <code>xlim=c(0,10)</code></li>
<li><code>log</code>: <em>e.g.</em> <code>log=&quot;x&quot;</code> or <code>log=&quot;xy&quot;</code></li>
<li><code>main</code>: main title; see <code>?plotmath</code> for mathematical formula</li>
<li><code>xlab, ylab</code>: labels for the x- and y-axes</li>
<li><code>color</code>, <code>shape</code>, <code>size</code></li>
<li><code>...</code>: many arguments accepted by <code>plot</code> function</li>
</ul>
</li>
</ul>
<h3 id="qplot-scatter-plot-basics"><code>qplot</code>: scatter plot basics</h3>
<p>Create sample data, here 3 vectors: <code>x</code>, <code>y</code> and <code>cat</code></p>
<pre><code class="language-r">library(ggplot2)
x &lt;- sample(1:10, 10); y &lt;- sample(1:10, 10); cat &lt;- rep(c(&quot;A&quot;, &quot;B&quot;), 5)
</code></pre>
<p>Simple scatter plot</p>
<pre><code class="language-r">qplot(x, y, geom=&quot;point&quot;)
</code></pre>
<p><img src="../../../en/tutorials/rgraphics/rgraphics_files/figure-html/qplot_scatter_plot-1.png" width="672" /></p>
<p>Prints dots with different sizes and colors</p>
<pre><code class="language-r">qplot(x, y, geom=&quot;point&quot;, size=x, color=cat, 
      main=&quot;Dot Size and Color Relative to Some Values&quot;)
</code></pre>
<p><img src="../../../en/tutorials/rgraphics/rgraphics_files/figure-html/qplot_scatter_plot_dot_param-1.png" width="672" /></p>
<p>Drops legend</p>
<pre><code class="language-r">qplot(x, y, geom=&quot;point&quot;, size=x, color=cat) + 
      theme(legend.position = &quot;none&quot;)
</code></pre>
<p><img src="../../../en/tutorials/rgraphics/rgraphics_files/figure-html/qplot_scatter_plot_no_legend-1.png" width="672" /></p>
<p>Plot different shapes</p>
<pre><code class="language-r">qplot(x, y, geom=&quot;point&quot;, size=5, shape=cat)
</code></pre>
<p><img src="../../../en/tutorials/rgraphics/rgraphics_files/figure-html/qplot_scatter_plot_shapes-1.png" width="672" /></p>
<h4 id="colored-groups">Colored groups</h4>
<pre><code class="language-r">p &lt;- qplot(x, y, geom=&quot;point&quot;, size=x, color=cat, 
            main=&quot;Dot Size and Color Relative to Some Values&quot;) + 
     theme(legend.position = &quot;none&quot;)
print(p)
</code></pre>
<p><img src="../../../en/tutorials/rgraphics/rgraphics_files/figure-html/qplot_scatter_plot_colored_groups-1.png" width="672" /></p>
<h4 id="regression-line">Regression line</h4>
<pre><code class="language-r">set.seed(1410)
dsmall &lt;- diamonds[sample(nrow(diamonds), 1000), ]
p &lt;- qplot(carat, price, data = dsmall) +
           geom_smooth(method=&quot;lm&quot;)
print(p)
</code></pre>
<p><img src="../../../en/tutorials/rgraphics/rgraphics_files/figure-html/qplot_scatter_regression_line-1.png" width="672" /></p>
<h4 id="local-regression-curve-loess">Local regression curve (loess)</h4>
<pre><code class="language-r">p &lt;- qplot(carat, price, data=dsmall, geom=c(&quot;point&quot;, &quot;smooth&quot;)) 
print(p) # Setting se=FALSE removes error shade
</code></pre>
<p><img src="../../../en/tutorials/rgraphics/rgraphics_files/figure-html/qplot_scatter_regression_loess-1.png" width="672" /></p>
<h3 id="ggplot-function"><code>ggplot</code> Function</h3>
<ul>
<li>More important than <code>qplot</code> to access full functionality of <code>ggplot2</code></li>
<li>Main arguments
<ul>
<li>data set, usually a <code>data.frame</code> or <code>tibble</code></li>
<li>aesthetic mappings provided by <code>aes</code> function</li>
</ul>
</li>
<li>General <code>ggplot</code> syntax
<ul>
<li><code>ggplot(data, aes(...)) + geom() + ... + stat() + ...</code></li>
</ul>
</li>
<li>Layer specifications
<ul>
<li><code>geom(mapping, data, ..., geom, position)</code></li>
<li><code>stat(mapping, data, ..., stat, position)</code></li>
</ul>
</li>
<li>Additional components
<ul>
<li><code>scales</code></li>
<li><code>coordinates</code></li>
<li><code>facet</code></li>
</ul>
</li>
<li><code>aes()</code> mappings can be passed on to all components (<code>ggplot, geom</code>, etc.). Effects are global when passed on to <code>ggplot()</code> and local for other components.
<ul>
<li><code>x, y</code></li>
<li><code>color</code>: grouping vector (factor)</li>
<li><code>group</code>: grouping vector (factor)</li>
</ul>
</li>
</ul>
<h4 id="changing-plotting-themes-in-ggplot">Changing Plotting Themes in <code>ggplot</code></h4>
<ul>
<li>Theme settings can be accessed with <code>theme_get()</code></li>
<li>Their settings can be changed with <code>theme()</code></li>
</ul>
<p>Example how to change background color to white</p>
<pre><code class="language-r">... + theme(panel.background=element_rect(fill = &quot;white&quot;, colour = &quot;black&quot;)) 
</code></pre>
<h4 id="storing-ggplot-specifications">Storing <code>ggplot</code> Specifications</h4>
<p>Plots and layers can be stored in variables</p>
<pre><code class="language-r">p &lt;- ggplot(dsmall, aes(carat, price)) + geom_point() 
p # or print(p)
</code></pre>
<p>Returns information about data and aesthetic mappings followed by each layer</p>
<pre><code class="language-r">summary(p) 
</code></pre>
<p>Print dots with different sizes and colors</p>
<pre><code class="language-r">bestfit &lt;- geom_smooth(method = &quot;lm&quot;, se = F, color = alpha(&quot;steelblue&quot;, 0.5), size = 2)
p + bestfit # Plot with custom regression line
</code></pre>
<p>Syntax to pass on other data sets</p>
<pre><code class="language-r">p %+% diamonds[sample(nrow(diamonds), 100),] 
</code></pre>
<p>Saves plot stored in variable <code>p</code> to file</p>
<pre><code class="language-r">ggsave(p, file=&quot;myplot.pdf&quot;) 
</code></pre>
<p>Standard R export functons for graphics work as well (see <a href="https://girke.bioinformatics.ucr.edu/GEN242/tutorials/rgraphics/rgraphics/#saving-graphics-to-files">here</a>).</p>
<h3 id="ggplot-scatter-plots"><code>ggplot</code>: scatter plots</h3>
<h4 id="basic-example">Basic example</h4>
<pre><code class="language-r">set.seed(1410)  
dsmall &lt;- as.data.frame(diamonds[sample(nrow(diamonds), 1000), ])
p &lt;- ggplot(dsmall, aes(carat, price, color=color)) + 
            geom_point(size=4)
print(p) 
</code></pre>
<p><img src="../../../en/tutorials/rgraphics/rgraphics_files/figure-html/ggplot_scatter_plot1-1.png" width="672" /></p>
<p>Interactive version with graphics with <code>plotly</code></p>
<pre><code class="language-r">library(plotly)
ggplotly(p)
</code></pre>
<div id="htmlwidget-1" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"data":[{"x":[0.32,0.34,1.54,1.52,1.51,0.52,0.32,0.52,0.66,1,1,0.5,0.47,1.09,0.35,1.01,0.53,0.42,0.5,2.03,1,0.61,0.9,0.56,0.9,0.28,0.33,1.34,0.52,0.79,0.5,0.7,0.27,0.9,0.31,1.5,0.57,0.57,0.61,0.37,0.9,0.32,0.77,0.3,0.33,0.65,0.57,0.9,1.52,0.42,1.08,0.23,0.32,1.18,0.31,0.48,0.9,0.53,1.01,0.71,1.02,0.9,0.79,0.85,0.72,0.41,0.5,0.93,0.44,0.31,0.43,0.39,0.33,0.24,0.52,0.32,1,0.43,0.7,0.37,0.26,0.7,0.74,1.2,1.03,1.05,1.01,1.04,1.71,0.31,1.13,0.51,0.44,0.38,0.46,0.41,0.41,1.11,0.36,0.31,0.24,0.25,0.32,1.58,1.5,2.03,0.23,0.54,0.58,0.36,0.35,1,0.36,0.41,0.53,0.5,0.79,0.31,1.03,0.52,0.8,1,0.36,0.38,0.6,0.36,1.03,0.7,1.02,0.31,0.74,0.31,0.92,0.34,0.91,0.7,0.23],"y":[589,805,16889,7702,12738,1605,756,1919,3915,3965,16073,1272,1270,5164,829,5543,1956,1621,958,13858,5286,3397,4435,1243,3205,452,492,6303,1774,3328,1589,2355,622,4068,1075,15240,2015,1262,2266,857,3812,756,3428,670,492,4275,2047,6872,9789,1031,5758,530,758,5168,766,2329,3755,2266,5939,2516,4912,8239,2823,2737,2951,920,1354,4140,1235,942,774,1170,492,367,3284,657,5775,919,2596,1124,554,2218,3138,4203,4845,7965,7303,6115,11737,982,4406,1431,1294,871,1262,1295,1018,6241,1064,732,552,548,972,13329,12060,13229,425,1786,1879,689,1026,6762,851,791,1412,1436,3270,734,5804,2217,3312,4786,713,1257,2010,1042,8645,1770,5918,593,2906,571,3916,803,5535,2804,680],"text":["carat: 0.32<br />price:   589<br />color: D","carat: 0.34<br />price:   805<br />color: D","carat: 1.54<br />price: 16889<br />color: D","carat: 1.52<br />price:  7702<br />color: D","carat: 1.51<br />price: 12738<br />color: D","carat: 0.52<br />price:  1605<br />color: D","carat: 0.32<br />price:   756<br />color: D","carat: 0.52<br />price:  1919<br />color: D","carat: 0.66<br />price:  3915<br />color: D","carat: 1.00<br />price:  3965<br />color: D","carat: 1.00<br />price: 16073<br />color: D","carat: 0.50<br />price:  1272<br />color: D","carat: 0.47<br />price:  1270<br />color: D","carat: 1.09<br />price:  5164<br />color: D","carat: 0.35<br />price:   829<br />color: D","carat: 1.01<br />price:  5543<br />color: D","carat: 0.53<br />price:  1956<br />color: D","carat: 0.42<br />price:  1621<br />color: D","carat: 0.50<br />price:   958<br />color: D","carat: 2.03<br />price: 13858<br />color: D","carat: 1.00<br />price:  5286<br />color: D","carat: 0.61<br />price:  3397<br />color: D","carat: 0.90<br />price:  4435<br />color: D","carat: 0.56<br />price:  1243<br />color: D","carat: 0.90<br />price:  3205<br />color: D","carat: 0.28<br />price:   452<br />color: D","carat: 0.33<br />price:   492<br />color: D","carat: 1.34<br />price:  6303<br />color: D","carat: 0.52<br />price:  1774<br />color: D","carat: 0.79<br />price:  3328<br />color: D","carat: 0.50<br />price:  1589<br />color: D","carat: 0.70<br />price:  2355<br />color: D","carat: 0.27<br />price:   622<br />color: D","carat: 0.90<br />price:  4068<br />color: D","carat: 0.31<br />price:  1075<br />color: D","carat: 1.50<br />price: 15240<br />color: D","carat: 0.57<br />price:  2015<br />color: D","carat: 0.57<br />price:  1262<br />color: D","carat: 0.61<br />price:  2266<br />color: D","carat: 0.37<br />price:   857<br />color: D","carat: 0.90<br />price:  3812<br />color: D","carat: 0.32<br />price:   756<br />color: D","carat: 0.77<br />price:  3428<br />color: D","carat: 0.30<br />price:   670<br />color: D","carat: 0.33<br />price:   492<br />color: D","carat: 0.65<br />price:  4275<br />color: D","carat: 0.57<br />price:  2047<br />color: D","carat: 0.90<br />price:  6872<br />color: D","carat: 1.52<br />price:  9789<br />color: D","carat: 0.42<br />price:  1031<br />color: D","carat: 1.08<br />price:  5758<br />color: D","carat: 0.23<br />price:   530<br />color: D","carat: 0.32<br />price:   758<br />color: D","carat: 1.18<br />price:  5168<br />color: D","carat: 0.31<br />price:   766<br />color: D","carat: 0.48<br />price:  2329<br />color: D","carat: 0.90<br />price:  3755<br />color: D","carat: 0.53<br />price:  2266<br />color: D","carat: 1.01<br />price:  5939<br />color: D","carat: 0.71<br />price:  2516<br />color: D","carat: 1.02<br />price:  4912<br />color: D","carat: 0.90<br />price:  8239<br />color: D","carat: 0.79<br />price:  2823<br />color: D","carat: 0.85<br />price:  2737<br />color: D","carat: 0.72<br />price:  2951<br />color: D","carat: 0.41<br />price:   920<br />color: D","carat: 0.50<br />price:  1354<br />color: D","carat: 0.93<br />price:  4140<br />color: D","carat: 0.44<br />price:  1235<br />color: D","carat: 0.31<br />price:   942<br />color: D","carat: 0.43<br />price:   774<br />color: D","carat: 0.39<br />price:  1170<br />color: D","carat: 0.33<br />price:   492<br />color: D","carat: 0.24<br />price:   367<br />color: D","carat: 0.52<br />price:  3284<br />color: D","carat: 0.32<br />price:   657<br />color: D","carat: 1.00<br />price:  5775<br />color: D","carat: 0.43<br />price:   919<br />color: D","carat: 0.70<br />price:  2596<br />color: D","carat: 0.37<br />price:  1124<br />color: D","carat: 0.26<br />price:   554<br />color: D","carat: 0.70<br />price:  2218<br />color: D","carat: 0.74<br />price:  3138<br />color: D","carat: 1.20<br />price:  4203<br />color: D","carat: 1.03<br />price:  4845<br />color: D","carat: 1.05<br />price:  7965<br />color: D","carat: 1.01<br />price:  7303<br />color: D","carat: 1.04<br />price:  6115<br />color: D","carat: 1.71<br />price: 11737<br />color: D","carat: 0.31<br />price:   982<br />color: D","carat: 1.13<br />price:  4406<br />color: D","carat: 0.51<br />price:  1431<br />color: D","carat: 0.44<br />price:  1294<br />color: D","carat: 0.38<br />price:   871<br />color: D","carat: 0.46<br />price:  1262<br />color: D","carat: 0.41<br />price:  1295<br />color: D","carat: 0.41<br />price:  1018<br />color: D","carat: 1.11<br />price:  6241<br />color: D","carat: 0.36<br />price:  1064<br />color: D","carat: 0.31<br />price:   732<br />color: D","carat: 0.24<br />price:   552<br />color: D","carat: 0.25<br />price:   548<br />color: D","carat: 0.32<br />price:   972<br />color: D","carat: 1.58<br />price: 13329<br />color: D","carat: 1.50<br />price: 12060<br />color: D","carat: 2.03<br />price: 13229<br />color: D","carat: 0.23<br />price:   425<br />color: D","carat: 0.54<br />price:  1786<br />color: D","carat: 0.58<br />price:  1879<br />color: D","carat: 0.36<br />price:   689<br />color: D","carat: 0.35<br />price:  1026<br />color: D","carat: 1.00<br />price:  6762<br />color: D","carat: 0.36<br />price:   851<br />color: D","carat: 0.41<br />price:   791<br />color: D","carat: 0.53<br />price:  1412<br />color: D","carat: 0.50<br />price:  1436<br />color: D","carat: 0.79<br />price:  3270<br />color: D","carat: 0.31<br />price:   734<br />color: D","carat: 1.03<br />price:  5804<br />color: D","carat: 0.52<br />price:  2217<br />color: D","carat: 0.80<br />price:  3312<br />color: D","carat: 1.00<br />price:  4786<br />color: D","carat: 0.36<br />price:   713<br />color: D","carat: 0.38<br />price:  1257<br />color: D","carat: 0.60<br />price:  2010<br />color: D","carat: 0.36<br />price:  1042<br />color: D","carat: 1.03<br />price:  8645<br />color: D","carat: 0.70<br />price:  1770<br />color: D","carat: 1.02<br />price:  5918<br />color: D","carat: 0.31<br />price:   593<br />color: D","carat: 0.74<br />price:  2906<br />color: D","carat: 0.31<br />price:   571<br />color: D","carat: 0.92<br />price:  3916<br />color: D","carat: 0.34<br />price:   803<br />color: D","carat: 0.91<br />price:  5535<br />color: D","carat: 0.70<br />price:  2804<br />color: D","carat: 0.23<br />price:   680<br />color: D"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(68,1,84,1)","opacity":1,"size":15.1181102362205,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(68,1,84,1)"}},"hoveron":"points","name":"D","legendgroup":"D","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.25,0.9,0.75,1.01,1.01,0.54,0.39,0.7,1.01,0.34,0.51,0.41,1.02,0.38,0.43,0.6,1.71,0.71,0.31,0.33,1.51,0.31,2.01,0.91,1.09,0.39,0.5,1.51,0.46,0.35,0.36,0.56,1.26,1.12,0.56,0.63,0.35,0.33,1.66,0.32,0.41,0.37,1.02,0.26,0.74,0.72,0.36,1.63,0.34,0.41,0.52,0.31,2,0.7,0.43,0.38,1.52,0.95,0.41,0.51,0.55,1.01,0.78,0.31,0.41,0.33,1.51,0.34,0.41,0.63,0.34,1.09,0.53,0.29,0.38,0.33,0.89,0.41,1,0.3,0.75,0.32,1.21,1,1.12,0.24,0.5,0.34,0.73,1.11,0.46,0.58,0.41,0.5,0.5,0.71,0.78,0.32,0.5,0.57,0.31,0.33,0.43,0.9,0.23,0.55,0.32,1,0.51,1,0.28,0.75,0.33,0.5,1.57,0.71,2,2.01,1.05,0.26,0.3,0.9,1,0.74,0.76,0.55,0.3,0.52,0.71,0.77,0.32,0.4,1.7,0.31,0.3,1.42,0.37,1.02,0.72,1.01,0.28,0.59,1.01,0.72,1,1,1.01,1.36,1,0.28,0.48,1.6,0.52,0.31,0.7,0.73,0.51,0.23,0.52,0.3,1.22,0.31,0.33,1.6,0.79,0.35,1.03,0.7,0.26,1.01,0.54,1.02,0.7,0.71,0.31,0.32,1.11,0.52,0.34,0.7,1.01,1.01],"y":[783,3239,3231,4912,8976,1250,601,3504,5279,556,1656,1249,7277,1267,1433,2774,14319,3360,816,804,12530,879,16733,3743,10111,985,1217,9302,1661,767,933,1915,6085,5546,1915,2765,921,957,10553,768,1079,1041,4465,556,2999,2498,738,17825,765,1153,1601,872,15840,3419,716,866,12418,4738,638,1340,1551,6128,2379,872,981,693,9343,612,1431,2565,1033,5127,1438,619,1053,928,3872,1187,4435,895,2940,1095,6708,6315,7589,362,1240,1014,2409,4532,1070,1641,818,1351,1410,2190,3444,1095,1746,1613,872,1002,669,3662,530,1448,1080,5330,1831,3763,642,2674,928,1259,10362,2891,16064,15618,5494,599,526,4092,9139,2464,2580,1675,564,1229,2329,3291,954,1125,9596,936,895,8019,999,11128,3235,4608,470,2177,5751,3550,9224,4916,6268,7677,4805,688,1323,10798,1646,958,2952,2886,1443,530,1793,578,7395,734,743,12467,3539,767,5010,2757,554,6968,1163,4540,2415,2921,1133,528,6800,1689,881,2952,5366,4751],"text":["carat: 0.25<br />price:   783<br />color: E","carat: 0.90<br />price:  3239<br />color: E","carat: 0.75<br />price:  3231<br />color: E","carat: 1.01<br />price:  4912<br />color: E","carat: 1.01<br />price:  8976<br />color: E","carat: 0.54<br />price:  1250<br />color: E","carat: 0.39<br />price:   601<br />color: E","carat: 0.70<br />price:  3504<br />color: E","carat: 1.01<br />price:  5279<br />color: E","carat: 0.34<br />price:   556<br />color: E","carat: 0.51<br />price:  1656<br />color: E","carat: 0.41<br />price:  1249<br />color: E","carat: 1.02<br />price:  7277<br />color: E","carat: 0.38<br />price:  1267<br />color: E","carat: 0.43<br />price:  1433<br />color: E","carat: 0.60<br />price:  2774<br />color: E","carat: 1.71<br />price: 14319<br />color: E","carat: 0.71<br />price:  3360<br />color: E","carat: 0.31<br />price:   816<br />color: E","carat: 0.33<br />price:   804<br />color: E","carat: 1.51<br />price: 12530<br />color: E","carat: 0.31<br />price:   879<br />color: E","carat: 2.01<br />price: 16733<br />color: E","carat: 0.91<br />price:  3743<br />color: E","carat: 1.09<br />price: 10111<br />color: E","carat: 0.39<br />price:   985<br />color: E","carat: 0.50<br />price:  1217<br />color: E","carat: 1.51<br />price:  9302<br />color: E","carat: 0.46<br />price:  1661<br />color: E","carat: 0.35<br />price:   767<br />color: E","carat: 0.36<br />price:   933<br />color: E","carat: 0.56<br />price:  1915<br />color: E","carat: 1.26<br />price:  6085<br />color: E","carat: 1.12<br />price:  5546<br />color: E","carat: 0.56<br />price:  1915<br />color: E","carat: 0.63<br />price:  2765<br />color: E","carat: 0.35<br />price:   921<br />color: E","carat: 0.33<br />price:   957<br />color: E","carat: 1.66<br />price: 10553<br />color: E","carat: 0.32<br />price:   768<br />color: E","carat: 0.41<br />price:  1079<br />color: E","carat: 0.37<br />price:  1041<br />color: E","carat: 1.02<br />price:  4465<br />color: E","carat: 0.26<br />price:   556<br />color: E","carat: 0.74<br />price:  2999<br />color: E","carat: 0.72<br />price:  2498<br />color: E","carat: 0.36<br />price:   738<br />color: E","carat: 1.63<br />price: 17825<br />color: E","carat: 0.34<br />price:   765<br />color: E","carat: 0.41<br />price:  1153<br />color: E","carat: 0.52<br />price:  1601<br />color: E","carat: 0.31<br />price:   872<br />color: E","carat: 2.00<br />price: 15840<br />color: E","carat: 0.70<br />price:  3419<br />color: E","carat: 0.43<br />price:   716<br />color: E","carat: 0.38<br />price:   866<br />color: E","carat: 1.52<br />price: 12418<br />color: E","carat: 0.95<br />price:  4738<br />color: E","carat: 0.41<br />price:   638<br />color: E","carat: 0.51<br />price:  1340<br />color: E","carat: 0.55<br />price:  1551<br />color: E","carat: 1.01<br />price:  6128<br />color: E","carat: 0.78<br />price:  2379<br />color: E","carat: 0.31<br />price:   872<br />color: E","carat: 0.41<br />price:   981<br />color: E","carat: 0.33<br />price:   693<br />color: E","carat: 1.51<br />price:  9343<br />color: E","carat: 0.34<br />price:   612<br />color: E","carat: 0.41<br />price:  1431<br />color: E","carat: 0.63<br />price:  2565<br />color: E","carat: 0.34<br />price:  1033<br />color: E","carat: 1.09<br />price:  5127<br />color: E","carat: 0.53<br />price:  1438<br />color: E","carat: 0.29<br />price:   619<br />color: E","carat: 0.38<br />price:  1053<br />color: E","carat: 0.33<br />price:   928<br />color: E","carat: 0.89<br />price:  3872<br />color: E","carat: 0.41<br />price:  1187<br />color: E","carat: 1.00<br />price:  4435<br />color: E","carat: 0.30<br />price:   895<br />color: E","carat: 0.75<br />price:  2940<br />color: E","carat: 0.32<br />price:  1095<br />color: E","carat: 1.21<br />price:  6708<br />color: E","carat: 1.00<br />price:  6315<br />color: E","carat: 1.12<br />price:  7589<br />color: E","carat: 0.24<br />price:   362<br />color: E","carat: 0.50<br />price:  1240<br />color: E","carat: 0.34<br />price:  1014<br />color: E","carat: 0.73<br />price:  2409<br />color: E","carat: 1.11<br />price:  4532<br />color: E","carat: 0.46<br />price:  1070<br />color: E","carat: 0.58<br />price:  1641<br />color: E","carat: 0.41<br />price:   818<br />color: E","carat: 0.50<br />price:  1351<br />color: E","carat: 0.50<br />price:  1410<br />color: E","carat: 0.71<br />price:  2190<br />color: E","carat: 0.78<br />price:  3444<br />color: E","carat: 0.32<br />price:  1095<br />color: E","carat: 0.50<br />price:  1746<br />color: E","carat: 0.57<br />price:  1613<br />color: E","carat: 0.31<br />price:   872<br />color: E","carat: 0.33<br />price:  1002<br />color: E","carat: 0.43<br />price:   669<br />color: E","carat: 0.90<br />price:  3662<br />color: E","carat: 0.23<br />price:   530<br />color: E","carat: 0.55<br />price:  1448<br />color: E","carat: 0.32<br />price:  1080<br />color: E","carat: 1.00<br />price:  5330<br />color: E","carat: 0.51<br />price:  1831<br />color: E","carat: 1.00<br />price:  3763<br />color: E","carat: 0.28<br />price:   642<br />color: E","carat: 0.75<br />price:  2674<br />color: E","carat: 0.33<br />price:   928<br />color: E","carat: 0.50<br />price:  1259<br />color: E","carat: 1.57<br />price: 10362<br />color: E","carat: 0.71<br />price:  2891<br />color: E","carat: 2.00<br />price: 16064<br />color: E","carat: 2.01<br />price: 15618<br />color: E","carat: 1.05<br />price:  5494<br />color: E","carat: 0.26<br />price:   599<br />color: E","carat: 0.30<br />price:   526<br />color: E","carat: 0.90<br />price:  4092<br />color: E","carat: 1.00<br />price:  9139<br />color: E","carat: 0.74<br />price:  2464<br />color: E","carat: 0.76<br />price:  2580<br />color: E","carat: 0.55<br />price:  1675<br />color: E","carat: 0.30<br />price:   564<br />color: E","carat: 0.52<br />price:  1229<br />color: E","carat: 0.71<br />price:  2329<br />color: E","carat: 0.77<br />price:  3291<br />color: E","carat: 0.32<br />price:   954<br />color: E","carat: 0.40<br />price:  1125<br />color: E","carat: 1.70<br />price:  9596<br />color: E","carat: 0.31<br />price:   936<br />color: E","carat: 0.30<br />price:   895<br />color: E","carat: 1.42<br />price:  8019<br />color: E","carat: 0.37<br />price:   999<br />color: E","carat: 1.02<br />price: 11128<br />color: E","carat: 0.72<br />price:  3235<br />color: E","carat: 1.01<br />price:  4608<br />color: E","carat: 0.28<br />price:   470<br />color: E","carat: 0.59<br />price:  2177<br />color: E","carat: 1.01<br />price:  5751<br />color: E","carat: 0.72<br />price:  3550<br />color: E","carat: 1.00<br />price:  9224<br />color: E","carat: 1.00<br />price:  4916<br />color: E","carat: 1.01<br />price:  6268<br />color: E","carat: 1.36<br />price:  7677<br />color: E","carat: 1.00<br />price:  4805<br />color: E","carat: 0.28<br />price:   688<br />color: E","carat: 0.48<br />price:  1323<br />color: E","carat: 1.60<br />price: 10798<br />color: E","carat: 0.52<br />price:  1646<br />color: E","carat: 0.31<br />price:   958<br />color: E","carat: 0.70<br />price:  2952<br />color: E","carat: 0.73<br />price:  2886<br />color: E","carat: 0.51<br />price:  1443<br />color: E","carat: 0.23<br />price:   530<br />color: E","carat: 0.52<br />price:  1793<br />color: E","carat: 0.30<br />price:   578<br />color: E","carat: 1.22<br />price:  7395<br />color: E","carat: 0.31<br />price:   734<br />color: E","carat: 0.33<br />price:   743<br />color: E","carat: 1.60<br />price: 12467<br />color: E","carat: 0.79<br />price:  3539<br />color: E","carat: 0.35<br />price:   767<br />color: E","carat: 1.03<br />price:  5010<br />color: E","carat: 0.70<br />price:  2757<br />color: E","carat: 0.26<br />price:   554<br />color: E","carat: 1.01<br />price:  6968<br />color: E","carat: 0.54<br />price:  1163<br />color: E","carat: 1.02<br />price:  4540<br />color: E","carat: 0.70<br />price:  2415<br />color: E","carat: 0.71<br />price:  2921<br />color: E","carat: 0.31<br />price:  1133<br />color: E","carat: 0.32<br />price:   528<br />color: E","carat: 1.11<br />price:  6800<br />color: E","carat: 0.52<br />price:  1689<br />color: E","carat: 0.34<br />price:   881<br />color: E","carat: 0.70<br />price:  2952<br />color: E","carat: 1.01<br />price:  5366<br />color: E","carat: 1.01<br />price:  4751<br />color: E"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(68,58,131,1)","opacity":1,"size":15.1181102362205,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(68,58,131,1)"}},"hoveron":"points","name":"E","legendgroup":"E","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.25,1.04,0.9,0.69,0.58,1.11,0.73,0.8,1.16,0.71,0.9,1.02,0.91,0.3,0.57,0.91,1.59,2.07,0.32,0.79,0.39,1.04,1.29,0.83,0.51,0.32,0.3,1.02,1.05,0.72,1.52,0.43,1.5,1.21,0.42,0.9,0.59,0.3,0.9,0.35,1.2,0.4,0.4,0.4,0.52,0.51,0.41,1.07,0.7,0.54,0.56,0.7,0.43,0.31,1,0.74,1.23,0.7,0.3,0.74,1.62,0.32,1.01,0.42,0.3,0.41,1.23,0.81,0.5,0.3,0.64,0.51,1.24,0.34,0.52,1.11,0.3,0.72,0.41,0.25,0.41,0.37,1.27,0.7,1.27,1.5,0.31,1.01,1.01,1.33,0.73,0.33,0.57,0.31,1.29,1.14,0.75,0.71,0.3,0.5,0.3,1,0.54,0.54,0.41,0.7,1.01,0.35,0.9,0.29,2.02,1.51,2.05,1.01,0.27,0.28,1.74,2,1.22,1.01,0.95,0.3,1.05,0.3,0.32,0.24,1.22,0.7,0.56,0.38,0.32,0.71,0.26,1.09,0.36,0.42,1.18,0.55,0.71,0.71,0.53,0.31,0.48,0.9,0.27,1.32,0.52,1,2.02,1.21,0.55,0.33,0.31,0.33,0.4,0.71,0.6,1.03,0.24,1.01,0.7,0.42,1.47,0.71,0.31,0.24,0.3,0.36,0.51,1,0.73,0.61,0.73,0.41,0.37,1.01,1,2.02,0.55,0.31,0.55,0.31,0.61,0.33,0.23,0.57],"y":[8764,5650,3470,1951,1401,10141,2355,3293,10809,2999,4441,4162,4423,945,1760,3489,9972,18611,828,3806,1183,4321,7126,1968,1574,828,776,4043,6933,2607,11405,1169,12389,8879,910,3619,1195,658,2964,872,9586,982,1404,945,1227,2041,1356,6828,2662,1385,2554,3154,1422,625,5221,2319,11141,3300,886,3454,11733,828,6702,926,886,755,9660,2761,1849,730,2074,1334,10033,784,1250,7823,795,2829,1007,633,870,957,5308,2373,13823,10962,917,4791,6083,8163,2527,1040,1397,625,4977,7293,2648,2809,873,1333,694,6927,1937,1836,1323,1134,5662,906,4232,555,13453,11302,15017,4416,820,825,6821,16580,6518,5345,2867,776,7276,886,977,540,10100,1806,1950,870,645,2409,597,8422,781,773,12175,1692,2416,2590,1610,921,1279,3898,560,12736,1600,4037,18274,8691,1698,957,394,841,1323,2130,1367,5356,370,8552,3270,1031,8115,2103,802,678,601,803,1100,4155,2951,2634,2801,1107,957,7122,6424,15261,1580,901,1692,802,1547,801,402,1746],"text":["carat: 1.25<br />price:  8764<br />color: F","carat: 1.04<br />price:  5650<br />color: F","carat: 0.90<br />price:  3470<br />color: F","carat: 0.69<br />price:  1951<br />color: F","carat: 0.58<br />price:  1401<br />color: F","carat: 1.11<br />price: 10141<br />color: F","carat: 0.73<br />price:  2355<br />color: F","carat: 0.80<br />price:  3293<br />color: F","carat: 1.16<br />price: 10809<br />color: F","carat: 0.71<br />price:  2999<br />color: F","carat: 0.90<br />price:  4441<br />color: F","carat: 1.02<br />price:  4162<br />color: F","carat: 0.91<br />price:  4423<br />color: F","carat: 0.30<br />price:   945<br />color: F","carat: 0.57<br />price:  1760<br />color: F","carat: 0.91<br />price:  3489<br />color: F","carat: 1.59<br />price:  9972<br />color: F","carat: 2.07<br />price: 18611<br />color: F","carat: 0.32<br />price:   828<br />color: F","carat: 0.79<br />price:  3806<br />color: F","carat: 0.39<br />price:  1183<br />color: F","carat: 1.04<br />price:  4321<br />color: F","carat: 1.29<br />price:  7126<br />color: F","carat: 0.83<br />price:  1968<br />color: F","carat: 0.51<br />price:  1574<br />color: F","carat: 0.32<br />price:   828<br />color: F","carat: 0.30<br />price:   776<br />color: F","carat: 1.02<br />price:  4043<br />color: F","carat: 1.05<br />price:  6933<br />color: F","carat: 0.72<br />price:  2607<br />color: F","carat: 1.52<br />price: 11405<br />color: F","carat: 0.43<br />price:  1169<br />color: F","carat: 1.50<br />price: 12389<br />color: F","carat: 1.21<br />price:  8879<br />color: F","carat: 0.42<br />price:   910<br />color: F","carat: 0.90<br />price:  3619<br />color: F","carat: 0.59<br />price:  1195<br />color: F","carat: 0.30<br />price:   658<br />color: F","carat: 0.90<br />price:  2964<br />color: F","carat: 0.35<br />price:   872<br />color: F","carat: 1.20<br />price:  9586<br />color: F","carat: 0.40<br />price:   982<br />color: F","carat: 0.40<br />price:  1404<br />color: F","carat: 0.40<br />price:   945<br />color: F","carat: 0.52<br />price:  1227<br />color: F","carat: 0.51<br />price:  2041<br />color: F","carat: 0.41<br />price:  1356<br />color: F","carat: 1.07<br />price:  6828<br />color: F","carat: 0.70<br />price:  2662<br />color: F","carat: 0.54<br />price:  1385<br />color: F","carat: 0.56<br />price:  2554<br />color: F","carat: 0.70<br />price:  3154<br />color: F","carat: 0.43<br />price:  1422<br />color: F","carat: 0.31<br />price:   625<br />color: F","carat: 1.00<br />price:  5221<br />color: F","carat: 0.74<br />price:  2319<br />color: F","carat: 1.23<br />price: 11141<br />color: F","carat: 0.70<br />price:  3300<br />color: F","carat: 0.30<br />price:   886<br />color: F","carat: 0.74<br />price:  3454<br />color: F","carat: 1.62<br />price: 11733<br />color: F","carat: 0.32<br />price:   828<br />color: F","carat: 1.01<br />price:  6702<br />color: F","carat: 0.42<br />price:   926<br />color: F","carat: 0.30<br />price:   886<br />color: F","carat: 0.41<br />price:   755<br />color: F","carat: 1.23<br />price:  9660<br />color: F","carat: 0.81<br />price:  2761<br />color: F","carat: 0.50<br />price:  1849<br />color: F","carat: 0.30<br />price:   730<br />color: F","carat: 0.64<br />price:  2074<br />color: F","carat: 0.51<br />price:  1334<br />color: F","carat: 1.24<br />price: 10033<br />color: F","carat: 0.34<br />price:   784<br />color: F","carat: 0.52<br />price:  1250<br />color: F","carat: 1.11<br />price:  7823<br />color: F","carat: 0.30<br />price:   795<br />color: F","carat: 0.72<br />price:  2829<br />color: F","carat: 0.41<br />price:  1007<br />color: F","carat: 0.25<br />price:   633<br />color: F","carat: 0.41<br />price:   870<br />color: F","carat: 0.37<br />price:   957<br />color: F","carat: 1.27<br />price:  5308<br />color: F","carat: 0.70<br />price:  2373<br />color: F","carat: 1.27<br />price: 13823<br />color: F","carat: 1.50<br />price: 10962<br />color: F","carat: 0.31<br />price:   917<br />color: F","carat: 1.01<br />price:  4791<br />color: F","carat: 1.01<br />price:  6083<br />color: F","carat: 1.33<br />price:  8163<br />color: F","carat: 0.73<br />price:  2527<br />color: F","carat: 0.33<br />price:  1040<br />color: F","carat: 0.57<br />price:  1397<br />color: F","carat: 0.31<br />price:   625<br />color: F","carat: 1.29<br />price:  4977<br />color: F","carat: 1.14<br />price:  7293<br />color: F","carat: 0.75<br />price:  2648<br />color: F","carat: 0.71<br />price:  2809<br />color: F","carat: 0.30<br />price:   873<br />color: F","carat: 0.50<br />price:  1333<br />color: F","carat: 0.30<br />price:   694<br />color: F","carat: 1.00<br />price:  6927<br />color: F","carat: 0.54<br />price:  1937<br />color: F","carat: 0.54<br />price:  1836<br />color: F","carat: 0.41<br />price:  1323<br />color: F","carat: 0.70<br />price:  1134<br />color: F","carat: 1.01<br />price:  5662<br />color: F","carat: 0.35<br />price:   906<br />color: F","carat: 0.90<br />price:  4232<br />color: F","carat: 0.29<br />price:   555<br />color: F","carat: 2.02<br />price: 13453<br />color: F","carat: 1.51<br />price: 11302<br />color: F","carat: 2.05<br />price: 15017<br />color: F","carat: 1.01<br />price:  4416<br />color: F","carat: 0.27<br />price:   820<br />color: F","carat: 0.28<br />price:   825<br />color: F","carat: 1.74<br />price:  6821<br />color: F","carat: 2.00<br />price: 16580<br />color: F","carat: 1.22<br />price:  6518<br />color: F","carat: 1.01<br />price:  5345<br />color: F","carat: 0.95<br />price:  2867<br />color: F","carat: 0.30<br />price:   776<br />color: F","carat: 1.05<br />price:  7276<br />color: F","carat: 0.30<br />price:   886<br />color: F","carat: 0.32<br />price:   977<br />color: F","carat: 0.24<br />price:   540<br />color: F","carat: 1.22<br />price: 10100<br />color: F","carat: 0.70<br />price:  1806<br />color: F","carat: 0.56<br />price:  1950<br />color: F","carat: 0.38<br />price:   870<br />color: F","carat: 0.32<br />price:   645<br />color: F","carat: 0.71<br />price:  2409<br />color: F","carat: 0.26<br />price:   597<br />color: F","carat: 1.09<br />price:  8422<br />color: F","carat: 0.36<br />price:   781<br />color: F","carat: 0.42<br />price:   773<br />color: F","carat: 1.18<br />price: 12175<br />color: F","carat: 0.55<br />price:  1692<br />color: F","carat: 0.71<br />price:  2416<br />color: F","carat: 0.71<br />price:  2590<br />color: F","carat: 0.53<br />price:  1610<br />color: F","carat: 0.31<br />price:   921<br />color: F","carat: 0.48<br />price:  1279<br />color: F","carat: 0.90<br />price:  3898<br />color: F","carat: 0.27<br />price:   560<br />color: F","carat: 1.32<br />price: 12736<br />color: F","carat: 0.52<br />price:  1600<br />color: F","carat: 1.00<br />price:  4037<br />color: F","carat: 2.02<br />price: 18274<br />color: F","carat: 1.21<br />price:  8691<br />color: F","carat: 0.55<br />price:  1698<br />color: F","carat: 0.33<br />price:   957<br />color: F","carat: 0.31<br />price:   394<br />color: F","carat: 0.33<br />price:   841<br />color: F","carat: 0.40<br />price:  1323<br />color: F","carat: 0.71<br />price:  2130<br />color: F","carat: 0.60<br />price:  1367<br />color: F","carat: 1.03<br />price:  5356<br />color: F","carat: 0.24<br />price:   370<br />color: F","carat: 1.01<br />price:  8552<br />color: F","carat: 0.70<br />price:  3270<br />color: F","carat: 0.42<br />price:  1031<br />color: F","carat: 1.47<br />price:  8115<br />color: F","carat: 0.71<br />price:  2103<br />color: F","carat: 0.31<br />price:   802<br />color: F","carat: 0.24<br />price:   678<br />color: F","carat: 0.30<br />price:   601<br />color: F","carat: 0.36<br />price:   803<br />color: F","carat: 0.51<br />price:  1100<br />color: F","carat: 1.00<br />price:  4155<br />color: F","carat: 0.73<br />price:  2951<br />color: F","carat: 0.61<br />price:  2634<br />color: F","carat: 0.73<br />price:  2801<br />color: F","carat: 0.41<br />price:  1107<br />color: F","carat: 0.37<br />price:   957<br />color: F","carat: 1.01<br />price:  7122<br />color: F","carat: 1.00<br />price:  6424<br />color: F","carat: 2.02<br />price: 15261<br />color: F","carat: 0.55<br />price:  1580<br />color: F","carat: 0.31<br />price:   901<br />color: F","carat: 0.55<br />price:  1692<br />color: F","carat: 0.31<br />price:   802<br />color: F","carat: 0.61<br />price:  1547<br />color: F","carat: 0.33<br />price:   801<br />color: F","carat: 0.23<br />price:   402<br />color: F","carat: 0.57<br />price:  1746<br />color: F"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(49,104,142,1)","opacity":1,"size":15.1181102362205,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(49,104,142,1)"}},"hoveron":"points","name":"F","legendgroup":"F","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.3,0.9,0.57,0.3,1.5,0.4,0.3,0.41,0.32,1.16,1.62,0.7,1.01,0.71,2.02,1.24,0.7,0.31,1.12,1,1.06,0.3,0.7,1.5,1.2,0.9,1.05,0.32,1.01,0.31,0.53,0.41,1.53,1,1.07,0.5,1.74,0.42,1.05,0.35,0.31,0.3,0.7,1.01,0.26,1.02,1.55,0.3,1.28,1.2,0.31,2,1,1.03,1.25,0.3,2.03,0.9,0.5,1.03,1.54,0.3,1.15,2.18,1.18,0.59,0.73,0.59,0.31,0.33,1.01,0.54,0.38,0.33,0.7,0.33,0.55,1.25,0.4,1.02,0.45,1.51,0.5,1.01,2.14,0.92,0.96,1.04,0.72,0.5,0.73,0.71,0.49,1.51,1.09,1.26,0.51,0.42,0.53,1.03,1.32,1,0.29,1.21,1.3,0.56,1.04,0.3,0.9,0.62,0.32,0.41,0.71,0.54,2.04,0.73,0.5,0.31,1.05,0.42,1,0.43,0.71,0.42,1.06,0.9,0.7,0.32,0.37,0.46,0.5,0.32,1.06,0.39,0.59,0.9,0.41,0.71,0.43,0.82,0.31,1.07,1.01,1.2,1.52,0.24,0.35,0.39,0.54,1.01,0.4,0.43,0.32,0.52,0.25,0.55,1.71,0.33,0.35,0.53,0.41,1.01,0.31,0.31,1.13,0.5,0.33,0.5,0.32,0.41,0.71,0.51,1,0.31,1.53,0.5,1.04,0.74,0.51,0.31,0.31,0.25,1,0.71,0.9,1.7,0.76,0.4,0.32,0.52,2.32,0.44,0.53,1.17,0.31,1.01,0.55,0.32,0.71,1.07,0.72],"y":[878,4314,1617,684,14067,822,673,801,936,9901,15318,2010,4588,2386,17099,6895,2282,544,8072,4816,6325,863,1420,13998,7380,3976,9013,607,6734,605,1273,899,9572,5500,6779,1935,16316,882,7028,659,891,655,2478,8029,394,8489,14106,956,9505,6494,391,12654,6699,5518,11089,650,18680,4133,1787,5814,14438,638,7175,18003,9366,1782,3183,1355,500,1052,6295,2274,983,594,2056,702,2028,9173,1035,5398,1297,14674,1449,5049,12792,3377,3858,6831,2720,1659,2825,3299,1865,11153,3601,8113,1825,1048,1598,6479,9715,3965,712,8774,9540,1819,4200,776,3820,933,842,671,2334,1090,14900,2919,1449,629,3599,1087,7623,929,2443,737,5435,5978,2562,720,746,1560,1020,828,4238,855,1437,5855,839,2492,729,3652,542,7858,4672,5996,12161,559,756,1095,1985,6239,765,1264,698,2012,460,1667,11227,1114,669,1655,1068,4004,583,802,4707,1153,868,1354,645,986,2649,1438,5483,698,13994,1966,9465,3402,1438,816,816,454,4095,2515,3303,18718,2972,870,720,1244,18532,990,1692,9289,789,5741,2016,918,2613,4419,3179],"text":["carat: 0.30<br />price:   878<br />color: G","carat: 0.90<br />price:  4314<br />color: G","carat: 0.57<br />price:  1617<br />color: G","carat: 0.30<br />price:   684<br />color: G","carat: 1.50<br />price: 14067<br />color: G","carat: 0.40<br />price:   822<br />color: G","carat: 0.30<br />price:   673<br />color: G","carat: 0.41<br />price:   801<br />color: G","carat: 0.32<br />price:   936<br />color: G","carat: 1.16<br />price:  9901<br />color: G","carat: 1.62<br />price: 15318<br />color: G","carat: 0.70<br />price:  2010<br />color: G","carat: 1.01<br />price:  4588<br />color: G","carat: 0.71<br />price:  2386<br />color: G","carat: 2.02<br />price: 17099<br />color: G","carat: 1.24<br />price:  6895<br />color: G","carat: 0.70<br />price:  2282<br />color: G","carat: 0.31<br />price:   544<br />color: G","carat: 1.12<br />price:  8072<br />color: G","carat: 1.00<br />price:  4816<br />color: G","carat: 1.06<br />price:  6325<br />color: G","carat: 0.30<br />price:   863<br />color: G","carat: 0.70<br />price:  1420<br />color: G","carat: 1.50<br />price: 13998<br />color: G","carat: 1.20<br />price:  7380<br />color: G","carat: 0.90<br />price:  3976<br />color: G","carat: 1.05<br />price:  9013<br />color: G","carat: 0.32<br />price:   607<br />color: G","carat: 1.01<br />price:  6734<br />color: G","carat: 0.31<br />price:   605<br />color: G","carat: 0.53<br />price:  1273<br />color: G","carat: 0.41<br />price:   899<br />color: G","carat: 1.53<br />price:  9572<br />color: G","carat: 1.00<br />price:  5500<br />color: G","carat: 1.07<br />price:  6779<br />color: G","carat: 0.50<br />price:  1935<br />color: G","carat: 1.74<br />price: 16316<br />color: G","carat: 0.42<br />price:   882<br />color: G","carat: 1.05<br />price:  7028<br />color: G","carat: 0.35<br />price:   659<br />color: G","carat: 0.31<br />price:   891<br />color: G","carat: 0.30<br />price:   655<br />color: G","carat: 0.70<br />price:  2478<br />color: G","carat: 1.01<br />price:  8029<br />color: G","carat: 0.26<br />price:   394<br />color: G","carat: 1.02<br />price:  8489<br />color: G","carat: 1.55<br />price: 14106<br />color: G","carat: 0.30<br />price:   956<br />color: G","carat: 1.28<br />price:  9505<br />color: G","carat: 1.20<br />price:  6494<br />color: G","carat: 0.31<br />price:   391<br />color: G","carat: 2.00<br />price: 12654<br />color: G","carat: 1.00<br />price:  6699<br />color: G","carat: 1.03<br />price:  5518<br />color: G","carat: 1.25<br />price: 11089<br />color: G","carat: 0.30<br />price:   650<br />color: G","carat: 2.03<br />price: 18680<br />color: G","carat: 0.90<br />price:  4133<br />color: G","carat: 0.50<br />price:  1787<br />color: G","carat: 1.03<br />price:  5814<br />color: G","carat: 1.54<br />price: 14438<br />color: G","carat: 0.30<br />price:   638<br />color: G","carat: 1.15<br />price:  7175<br />color: G","carat: 2.18<br />price: 18003<br />color: G","carat: 1.18<br />price:  9366<br />color: G","carat: 0.59<br />price:  1782<br />color: G","carat: 0.73<br />price:  3183<br />color: G","carat: 0.59<br />price:  1355<br />color: G","carat: 0.31<br />price:   500<br />color: G","carat: 0.33<br />price:  1052<br />color: G","carat: 1.01<br />price:  6295<br />color: G","carat: 0.54<br />price:  2274<br />color: G","carat: 0.38<br />price:   983<br />color: G","carat: 0.33<br />price:   594<br />color: G","carat: 0.70<br />price:  2056<br />color: G","carat: 0.33<br />price:   702<br />color: G","carat: 0.55<br />price:  2028<br />color: G","carat: 1.25<br />price:  9173<br />color: G","carat: 0.40<br />price:  1035<br />color: G","carat: 1.02<br />price:  5398<br />color: G","carat: 0.45<br />price:  1297<br />color: G","carat: 1.51<br />price: 14674<br />color: G","carat: 0.50<br />price:  1449<br />color: G","carat: 1.01<br />price:  5049<br />color: G","carat: 2.14<br />price: 12792<br />color: G","carat: 0.92<br />price:  3377<br />color: G","carat: 0.96<br />price:  3858<br />color: G","carat: 1.04<br />price:  6831<br />color: G","carat: 0.72<br />price:  2720<br />color: G","carat: 0.50<br />price:  1659<br />color: G","carat: 0.73<br />price:  2825<br />color: G","carat: 0.71<br />price:  3299<br />color: G","carat: 0.49<br />price:  1865<br />color: G","carat: 1.51<br />price: 11153<br />color: G","carat: 1.09<br />price:  3601<br />color: G","carat: 1.26<br />price:  8113<br />color: G","carat: 0.51<br />price:  1825<br />color: G","carat: 0.42<br />price:  1048<br />color: G","carat: 0.53<br />price:  1598<br />color: G","carat: 1.03<br />price:  6479<br />color: G","carat: 1.32<br />price:  9715<br />color: G","carat: 1.00<br />price:  3965<br />color: G","carat: 0.29<br />price:   712<br />color: G","carat: 1.21<br />price:  8774<br />color: G","carat: 1.30<br />price:  9540<br />color: G","carat: 0.56<br />price:  1819<br />color: G","carat: 1.04<br />price:  4200<br />color: G","carat: 0.30<br />price:   776<br />color: G","carat: 0.90<br />price:  3820<br />color: G","carat: 0.62<br />price:   933<br />color: G","carat: 0.32<br />price:   842<br />color: G","carat: 0.41<br />price:   671<br />color: G","carat: 0.71<br />price:  2334<br />color: G","carat: 0.54<br />price:  1090<br />color: G","carat: 2.04<br />price: 14900<br />color: G","carat: 0.73<br />price:  2919<br />color: G","carat: 0.50<br />price:  1449<br />color: G","carat: 0.31<br />price:   629<br />color: G","carat: 1.05<br />price:  3599<br />color: G","carat: 0.42<br />price:  1087<br />color: G","carat: 1.00<br />price:  7623<br />color: G","carat: 0.43<br />price:   929<br />color: G","carat: 0.71<br />price:  2443<br />color: G","carat: 0.42<br />price:   737<br />color: G","carat: 1.06<br />price:  5435<br />color: G","carat: 0.90<br />price:  5978<br />color: G","carat: 0.70<br />price:  2562<br />color: G","carat: 0.32<br />price:   720<br />color: G","carat: 0.37<br />price:   746<br />color: G","carat: 0.46<br />price:  1560<br />color: G","carat: 0.50<br />price:  1020<br />color: G","carat: 0.32<br />price:   828<br />color: G","carat: 1.06<br />price:  4238<br />color: G","carat: 0.39<br />price:   855<br />color: G","carat: 0.59<br />price:  1437<br />color: G","carat: 0.90<br />price:  5855<br />color: G","carat: 0.41<br />price:   839<br />color: G","carat: 0.71<br />price:  2492<br />color: G","carat: 0.43<br />price:   729<br />color: G","carat: 0.82<br />price:  3652<br />color: G","carat: 0.31<br />price:   542<br />color: G","carat: 1.07<br />price:  7858<br />color: G","carat: 1.01<br />price:  4672<br />color: G","carat: 1.20<br />price:  5996<br />color: G","carat: 1.52<br />price: 12161<br />color: G","carat: 0.24<br />price:   559<br />color: G","carat: 0.35<br />price:   756<br />color: G","carat: 0.39<br />price:  1095<br />color: G","carat: 0.54<br />price:  1985<br />color: G","carat: 1.01<br />price:  6239<br />color: G","carat: 0.40<br />price:   765<br />color: G","carat: 0.43<br />price:  1264<br />color: G","carat: 0.32<br />price:   698<br />color: G","carat: 0.52<br />price:  2012<br />color: G","carat: 0.25<br />price:   460<br />color: G","carat: 0.55<br />price:  1667<br />color: G","carat: 1.71<br />price: 11227<br />color: G","carat: 0.33<br />price:  1114<br />color: G","carat: 0.35<br />price:   669<br />color: G","carat: 0.53<br />price:  1655<br />color: G","carat: 0.41<br />price:  1068<br />color: G","carat: 1.01<br />price:  4004<br />color: G","carat: 0.31<br />price:   583<br />color: G","carat: 0.31<br />price:   802<br />color: G","carat: 1.13<br />price:  4707<br />color: G","carat: 0.50<br />price:  1153<br />color: G","carat: 0.33<br />price:   868<br />color: G","carat: 0.50<br />price:  1354<br />color: G","carat: 0.32<br />price:   645<br />color: G","carat: 0.41<br />price:   986<br />color: G","carat: 0.71<br />price:  2649<br />color: G","carat: 0.51<br />price:  1438<br />color: G","carat: 1.00<br />price:  5483<br />color: G","carat: 0.31<br />price:   698<br />color: G","carat: 1.53<br />price: 13994<br />color: G","carat: 0.50<br />price:  1966<br />color: G","carat: 1.04<br />price:  9465<br />color: G","carat: 0.74<br />price:  3402<br />color: G","carat: 0.51<br />price:  1438<br />color: G","carat: 0.31<br />price:   816<br />color: G","carat: 0.31<br />price:   816<br />color: G","carat: 0.25<br />price:   454<br />color: G","carat: 1.00<br />price:  4095<br />color: G","carat: 0.71<br />price:  2515<br />color: G","carat: 0.90<br />price:  3303<br />color: G","carat: 1.70<br />price: 18718<br />color: G","carat: 0.76<br />price:  2972<br />color: G","carat: 0.40<br />price:   870<br />color: G","carat: 0.32<br />price:   720<br />color: G","carat: 0.52<br />price:  1244<br />color: G","carat: 2.32<br />price: 18532<br />color: G","carat: 0.44<br />price:   990<br />color: G","carat: 0.53<br />price:  1692<br />color: G","carat: 1.17<br />price:  9289<br />color: G","carat: 0.31<br />price:   789<br />color: G","carat: 1.01<br />price:  5741<br />color: G","carat: 0.55<br />price:  2016<br />color: G","carat: 0.32<br />price:   918<br />color: G","carat: 0.71<br />price:  2613<br />color: G","carat: 1.07<br />price:  4419<br />color: G","carat: 0.72<br />price:  3179<br />color: G"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(33,144,140,1)","opacity":1,"size":15.1181102362205,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(33,144,140,1)"}},"hoveron":"points","name":"G","legendgroup":"G","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.76,0.9,0.54,1.19,1.02,0.75,2.08,0.57,1.11,1.5,0.9,0.41,1.1,1.56,1.2,0.42,0.72,1.21,0.86,0.43,2,0.35,0.83,0.53,1.3,1.19,0.31,0.53,0.32,1.41,1.5,0.57,1,0.41,1.52,1.1,0.3,0.36,0.43,0.32,0.41,0.7,0.35,0.7,0.33,1.73,1,0.44,0.53,1.41,1.29,1,0.7,2.77,0.8,1.51,0.35,1.45,0.9,0.32,1.28,0.3,0.4,0.36,1.51,1.21,0.62,0.9,0.32,1.37,0.37,0.42,0.71,0.3,0.42,0.51,1.28,0.34,0.63,0.3,0.35,0.32,1.23,2.01,1.21,0.41,0.71,0.9,2.02,1.2,0.5,1.16,1.02,0.4,1,0.7,1.2,0.77,0.7,0.32,1.01,1.18,0.32,1.56,1.09,0.3,0.31,2.01,1.71,0.37,1,0.9,1.71,1.63,0.5,1.17,1.09,0.34,1.06,1.01,0.3,0.44,0.77,1.5,1.5,0.54,0.33,0.41,0.31,0.51,0.32,0.96,0.85,1.7,0.52,0.26,0.36,0.34,0.71,0.9,1.01,0.3,1.21,2.19,1.71,2,0.92,0.97,1],"y":[13626,4194,1439,7147,5335,3011,15065,1077,4456,10584,4657,1115,4276,12098,5016,1087,2056,5936,3115,716,12554,647,2201,1020,5824,7152,435,2031,936,9752,9987,1558,5000,1043,9527,5729,378,794,919,561,1011,2508,788,2137,854,6007,3248,1124,2154,9254,6588,4702,2010,10424,2867,10763,798,8550,4234,580,3355,450,1017,475,10411,7426,1616,4082,708,6337,666,1108,2918,540,898,1443,6093,852,1196,655,859,505,5717,17458,6974,876,2246,3989,15996,6129,1844,6954,4703,800,5069,2066,5082,3996,2815,461,3999,5674,461,11922,4700,675,660,6592,9193,749,4732,4309,13376,12620,1068,4717,4639,526,4401,4965,878,1196,3208,10206,9576,1560,787,827,558,1438,936,4456,1274,14275,1639,482,980,477,2096,2934,4242,776,4249,17016,14893,12765,3854,4943,4042],"text":["carat: 1.76<br />price: 13626<br />color: H","carat: 0.90<br />price:  4194<br />color: H","carat: 0.54<br />price:  1439<br />color: H","carat: 1.19<br />price:  7147<br />color: H","carat: 1.02<br />price:  5335<br />color: H","carat: 0.75<br />price:  3011<br />color: H","carat: 2.08<br />price: 15065<br />color: H","carat: 0.57<br />price:  1077<br />color: H","carat: 1.11<br />price:  4456<br />color: H","carat: 1.50<br />price: 10584<br />color: H","carat: 0.90<br />price:  4657<br />color: H","carat: 0.41<br />price:  1115<br />color: H","carat: 1.10<br />price:  4276<br />color: H","carat: 1.56<br />price: 12098<br />color: H","carat: 1.20<br />price:  5016<br />color: H","carat: 0.42<br />price:  1087<br />color: H","carat: 0.72<br />price:  2056<br />color: H","carat: 1.21<br />price:  5936<br />color: H","carat: 0.86<br />price:  3115<br />color: H","carat: 0.43<br />price:   716<br />color: H","carat: 2.00<br />price: 12554<br />color: H","carat: 0.35<br />price:   647<br />color: H","carat: 0.83<br />price:  2201<br />color: H","carat: 0.53<br />price:  1020<br />color: H","carat: 1.30<br />price:  5824<br />color: H","carat: 1.19<br />price:  7152<br />color: H","carat: 0.31<br />price:   435<br />color: H","carat: 0.53<br />price:  2031<br />color: H","carat: 0.32<br />price:   936<br />color: H","carat: 1.41<br />price:  9752<br />color: H","carat: 1.50<br />price:  9987<br />color: H","carat: 0.57<br />price:  1558<br />color: H","carat: 1.00<br />price:  5000<br />color: H","carat: 0.41<br />price:  1043<br />color: H","carat: 1.52<br />price:  9527<br />color: H","carat: 1.10<br />price:  5729<br />color: H","carat: 0.30<br />price:   378<br />color: H","carat: 0.36<br />price:   794<br />color: H","carat: 0.43<br />price:   919<br />color: H","carat: 0.32<br />price:   561<br />color: H","carat: 0.41<br />price:  1011<br />color: H","carat: 0.70<br />price:  2508<br />color: H","carat: 0.35<br />price:   788<br />color: H","carat: 0.70<br />price:  2137<br />color: H","carat: 0.33<br />price:   854<br />color: H","carat: 1.73<br />price:  6007<br />color: H","carat: 1.00<br />price:  3248<br />color: H","carat: 0.44<br />price:  1124<br />color: H","carat: 0.53<br />price:  2154<br />color: H","carat: 1.41<br />price:  9254<br />color: H","carat: 1.29<br />price:  6588<br />color: H","carat: 1.00<br />price:  4702<br />color: H","carat: 0.70<br />price:  2010<br />color: H","carat: 2.77<br />price: 10424<br />color: H","carat: 0.80<br />price:  2867<br />color: H","carat: 1.51<br />price: 10763<br />color: H","carat: 0.35<br />price:   798<br />color: H","carat: 1.45<br />price:  8550<br />color: H","carat: 0.90<br />price:  4234<br />color: H","carat: 0.32<br />price:   580<br />color: H","carat: 1.28<br />price:  3355<br />color: H","carat: 0.30<br />price:   450<br />color: H","carat: 0.40<br />price:  1017<br />color: H","carat: 0.36<br />price:   475<br />color: H","carat: 1.51<br />price: 10411<br />color: H","carat: 1.21<br />price:  7426<br />color: H","carat: 0.62<br />price:  1616<br />color: H","carat: 0.90<br />price:  4082<br />color: H","carat: 0.32<br />price:   708<br />color: H","carat: 1.37<br />price:  6337<br />color: H","carat: 0.37<br />price:   666<br />color: H","carat: 0.42<br />price:  1108<br />color: H","carat: 0.71<br />price:  2918<br />color: H","carat: 0.30<br />price:   540<br />color: H","carat: 0.42<br />price:   898<br />color: H","carat: 0.51<br />price:  1443<br />color: H","carat: 1.28<br />price:  6093<br />color: H","carat: 0.34<br />price:   852<br />color: H","carat: 0.63<br />price:  1196<br />color: H","carat: 0.30<br />price:   655<br />color: H","carat: 0.35<br />price:   859<br />color: H","carat: 0.32<br />price:   505<br />color: H","carat: 1.23<br />price:  5717<br />color: H","carat: 2.01<br />price: 17458<br />color: H","carat: 1.21<br />price:  6974<br />color: H","carat: 0.41<br />price:   876<br />color: H","carat: 0.71<br />price:  2246<br />color: H","carat: 0.90<br />price:  3989<br />color: H","carat: 2.02<br />price: 15996<br />color: H","carat: 1.20<br />price:  6129<br />color: H","carat: 0.50<br />price:  1844<br />color: H","carat: 1.16<br />price:  6954<br />color: H","carat: 1.02<br />price:  4703<br />color: H","carat: 0.40<br />price:   800<br />color: H","carat: 1.00<br />price:  5069<br />color: H","carat: 0.70<br />price:  2066<br />color: H","carat: 1.20<br />price:  5082<br />color: H","carat: 0.77<br />price:  3996<br />color: H","carat: 0.70<br />price:  2815<br />color: H","carat: 0.32<br />price:   461<br />color: H","carat: 1.01<br />price:  3999<br />color: H","carat: 1.18<br />price:  5674<br />color: H","carat: 0.32<br />price:   461<br />color: H","carat: 1.56<br />price: 11922<br />color: H","carat: 1.09<br />price:  4700<br />color: H","carat: 0.30<br />price:   675<br />color: H","carat: 0.31<br />price:   660<br />color: H","carat: 2.01<br />price:  6592<br />color: H","carat: 1.71<br />price:  9193<br />color: H","carat: 0.37<br />price:   749<br />color: H","carat: 1.00<br />price:  4732<br />color: H","carat: 0.90<br />price:  4309<br />color: H","carat: 1.71<br />price: 13376<br />color: H","carat: 1.63<br />price: 12620<br />color: H","carat: 0.50<br />price:  1068<br />color: H","carat: 1.17<br />price:  4717<br />color: H","carat: 1.09<br />price:  4639<br />color: H","carat: 0.34<br />price:   526<br />color: H","carat: 1.06<br />price:  4401<br />color: H","carat: 1.01<br />price:  4965<br />color: H","carat: 0.30<br />price:   878<br />color: H","carat: 0.44<br />price:  1196<br />color: H","carat: 0.77<br />price:  3208<br />color: H","carat: 1.50<br />price: 10206<br />color: H","carat: 1.50<br />price:  9576<br />color: H","carat: 0.54<br />price:  1560<br />color: H","carat: 0.33<br />price:   787<br />color: H","carat: 0.41<br />price:   827<br />color: H","carat: 0.31<br />price:   558<br />color: H","carat: 0.51<br />price:  1438<br />color: H","carat: 0.32<br />price:   936<br />color: H","carat: 0.96<br />price:  4456<br />color: H","carat: 0.85<br />price:  1274<br />color: H","carat: 1.70<br />price: 14275<br />color: H","carat: 0.52<br />price:  1639<br />color: H","carat: 0.26<br />price:   482<br />color: H","carat: 0.36<br />price:   980<br />color: H","carat: 0.34<br />price:   477<br />color: H","carat: 0.71<br />price:  2096<br />color: H","carat: 0.90<br />price:  2934<br />color: H","carat: 1.01<br />price:  4242<br />color: H","carat: 0.30<br />price:   776<br />color: H","carat: 1.21<br />price:  4249<br />color: H","carat: 2.19<br />price: 17016<br />color: H","carat: 1.71<br />price: 14893<br />color: H","carat: 2.00<br />price: 12765<br />color: H","carat: 0.92<br />price:  3854<br />color: H","carat: 0.97<br />price:  4943<br />color: H","carat: 1.00<br />price:  4042<br />color: H"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(53,183,121,1)","opacity":1,"size":15.1181102362205,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(53,183,121,1)"}},"hoveron":"points","name":"H","legendgroup":"H","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.61,1.21,1,1.5,1.5,0.57,0.76,1.04,1.7,1.27,1.61,1.11,2.02,0.4,0.7,1.06,1.22,1.01,0.34,2.11,0.51,0.71,2,0.73,1.01,1.5,2.01,1.27,0.88,2.01,0.26,1.28,0.72,0.7,0.71,0.71,1.83,1.33,0.27,0.72,1.18,0.72,1.21,1.02,0.5,0.7,0.27,1.21,0.47,0.32,1.56,1.01,1.21,1.52,1.01,1.21,0.71,1.61,1.33,0.37,0.33,0.3,1.22,1,1.58,2.04,0.55,0.79,2.01,1.26,1.55,2.04,0.37,0.4,0.4,2.48,0.38,0.7,1.02,1.02,1.04,1.5,1.42,0.33,1.5,0.9,0.9,0.57,1,1.07,1.26,0.77,0.3,0.34],"y":[9341,5124,3276,9702,6115,1180,2175,4013,11888,5249,10098,3183,16128,765,1724,4745,5368,4759,574,15282,1140,2218,16407,2351,4118,7912,15475,7312,3328,10711,445,6762,2148,2083,2400,2161,13711,5094,534,2650,5551,2441,5421,3656,1054,2332,432,7086,884,648,7326,4872,5866,7506,3299,5962,2376,8978,7325,754,608,405,4099,4538,9457,15543,1281,2539,15952,5207,8056,16874,666,849,667,16820,746,2335,3856,4478,3774,8920,7157,891,12148,3274,2948,1212,3360,4451,6566,2375,422,765],"text":["carat: 1.61<br />price:  9341<br />color: I","carat: 1.21<br />price:  5124<br />color: I","carat: 1.00<br />price:  3276<br />color: I","carat: 1.50<br />price:  9702<br />color: I","carat: 1.50<br />price:  6115<br />color: I","carat: 0.57<br />price:  1180<br />color: I","carat: 0.76<br />price:  2175<br />color: I","carat: 1.04<br />price:  4013<br />color: I","carat: 1.70<br />price: 11888<br />color: I","carat: 1.27<br />price:  5249<br />color: I","carat: 1.61<br />price: 10098<br />color: I","carat: 1.11<br />price:  3183<br />color: I","carat: 2.02<br />price: 16128<br />color: I","carat: 0.40<br />price:   765<br />color: I","carat: 0.70<br />price:  1724<br />color: I","carat: 1.06<br />price:  4745<br />color: I","carat: 1.22<br />price:  5368<br />color: I","carat: 1.01<br />price:  4759<br />color: I","carat: 0.34<br />price:   574<br />color: I","carat: 2.11<br />price: 15282<br />color: I","carat: 0.51<br />price:  1140<br />color: I","carat: 0.71<br />price:  2218<br />color: I","carat: 2.00<br />price: 16407<br />color: I","carat: 0.73<br />price:  2351<br />color: I","carat: 1.01<br />price:  4118<br />color: I","carat: 1.50<br />price:  7912<br />color: I","carat: 2.01<br />price: 15475<br />color: I","carat: 1.27<br />price:  7312<br />color: I","carat: 0.88<br />price:  3328<br />color: I","carat: 2.01<br />price: 10711<br />color: I","carat: 0.26<br />price:   445<br />color: I","carat: 1.28<br />price:  6762<br />color: I","carat: 0.72<br />price:  2148<br />color: I","carat: 0.70<br />price:  2083<br />color: I","carat: 0.71<br />price:  2400<br />color: I","carat: 0.71<br />price:  2161<br />color: I","carat: 1.83<br />price: 13711<br />color: I","carat: 1.33<br />price:  5094<br />color: I","carat: 0.27<br />price:   534<br />color: I","carat: 0.72<br />price:  2650<br />color: I","carat: 1.18<br />price:  5551<br />color: I","carat: 0.72<br />price:  2441<br />color: I","carat: 1.21<br />price:  5421<br />color: I","carat: 1.02<br />price:  3656<br />color: I","carat: 0.50<br />price:  1054<br />color: I","carat: 0.70<br />price:  2332<br />color: I","carat: 0.27<br />price:   432<br />color: I","carat: 1.21<br />price:  7086<br />color: I","carat: 0.47<br />price:   884<br />color: I","carat: 0.32<br />price:   648<br />color: I","carat: 1.56<br />price:  7326<br />color: I","carat: 1.01<br />price:  4872<br />color: I","carat: 1.21<br />price:  5866<br />color: I","carat: 1.52<br />price:  7506<br />color: I","carat: 1.01<br />price:  3299<br />color: I","carat: 1.21<br />price:  5962<br />color: I","carat: 0.71<br />price:  2376<br />color: I","carat: 1.61<br />price:  8978<br />color: I","carat: 1.33<br />price:  7325<br />color: I","carat: 0.37<br />price:   754<br />color: I","carat: 0.33<br />price:   608<br />color: I","carat: 0.30<br />price:   405<br />color: I","carat: 1.22<br />price:  4099<br />color: I","carat: 1.00<br />price:  4538<br />color: I","carat: 1.58<br />price:  9457<br />color: I","carat: 2.04<br />price: 15543<br />color: I","carat: 0.55<br />price:  1281<br />color: I","carat: 0.79<br />price:  2539<br />color: I","carat: 2.01<br />price: 15952<br />color: I","carat: 1.26<br />price:  5207<br />color: I","carat: 1.55<br />price:  8056<br />color: I","carat: 2.04<br />price: 16874<br />color: I","carat: 0.37<br />price:   666<br />color: I","carat: 0.40<br />price:   849<br />color: I","carat: 0.40<br />price:   667<br />color: I","carat: 2.48<br />price: 16820<br />color: I","carat: 0.38<br />price:   746<br />color: I","carat: 0.70<br />price:  2335<br />color: I","carat: 1.02<br />price:  3856<br />color: I","carat: 1.02<br />price:  4478<br />color: I","carat: 1.04<br />price:  3774<br />color: I","carat: 1.50<br />price:  8920<br />color: I","carat: 1.42<br />price:  7157<br />color: I","carat: 0.33<br />price:   891<br />color: I","carat: 1.50<br />price: 12148<br />color: I","carat: 0.90<br />price:  3274<br />color: I","carat: 0.90<br />price:  2948<br />color: I","carat: 0.57<br />price:  1212<br />color: I","carat: 1.00<br />price:  3360<br />color: I","carat: 1.07<br />price:  4451<br />color: I","carat: 1.26<br />price:  6566<br />color: I","carat: 0.77<br />price:  2375<br />color: I","carat: 0.30<br />price:   422<br />color: I","carat: 0.34<br />price:   765<br />color: I"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(143,215,68,1)","opacity":1,"size":15.1181102362205,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(143,215,68,1)"}},"hoveron":"points","name":"I","legendgroup":"I","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.38,1.05,0.51,0.85,1.02,0.61,4.5,0.74,2.03,1.6,0.3,2.01,1.11,1.12,1.65,1.5,1.07,0.4,0.76,0.77,1.35,1.22,1.74,0.34,2,1.6,1.25,1.07,0.4,2.01,0.31,0.72,1.08,1.25,1.55,0.35,1.21,1.37,1.17,1.25,0.56,2.31,1.01,0.53,0.41,2,1.5,1.27,0.9,2.01,1.76],"y":[6494,4145,1071,2295,3879,1233,18531,2154,12268,8904,394,12607,4497,4066,5914,8760,4686,641,1809,2086,4974,4676,8690,469,6521,7550,4690,4422,631,12209,453,2136,4633,5110,8749,591,6299,5063,2825,4331,1119,12369,3906,1122,637,11189,6750,5690,3024,9725,9053],"text":["carat: 1.38<br />price:  6494<br />color: J","carat: 1.05<br />price:  4145<br />color: J","carat: 0.51<br />price:  1071<br />color: J","carat: 0.85<br />price:  2295<br />color: J","carat: 1.02<br />price:  3879<br />color: J","carat: 0.61<br />price:  1233<br />color: J","carat: 4.50<br />price: 18531<br />color: J","carat: 0.74<br />price:  2154<br />color: J","carat: 2.03<br />price: 12268<br />color: J","carat: 1.60<br />price:  8904<br />color: J","carat: 0.30<br />price:   394<br />color: J","carat: 2.01<br />price: 12607<br />color: J","carat: 1.11<br />price:  4497<br />color: J","carat: 1.12<br />price:  4066<br />color: J","carat: 1.65<br />price:  5914<br />color: J","carat: 1.50<br />price:  8760<br />color: J","carat: 1.07<br />price:  4686<br />color: J","carat: 0.40<br />price:   641<br />color: J","carat: 0.76<br />price:  1809<br />color: J","carat: 0.77<br />price:  2086<br />color: J","carat: 1.35<br />price:  4974<br />color: J","carat: 1.22<br />price:  4676<br />color: J","carat: 1.74<br />price:  8690<br />color: J","carat: 0.34<br />price:   469<br />color: J","carat: 2.00<br />price:  6521<br />color: J","carat: 1.60<br />price:  7550<br />color: J","carat: 1.25<br />price:  4690<br />color: J","carat: 1.07<br />price:  4422<br />color: J","carat: 0.40<br />price:   631<br />color: J","carat: 2.01<br />price: 12209<br />color: J","carat: 0.31<br />price:   453<br />color: J","carat: 0.72<br />price:  2136<br />color: J","carat: 1.08<br />price:  4633<br />color: J","carat: 1.25<br />price:  5110<br />color: J","carat: 1.55<br />price:  8749<br />color: J","carat: 0.35<br />price:   591<br />color: J","carat: 1.21<br />price:  6299<br />color: J","carat: 1.37<br />price:  5063<br />color: J","carat: 1.17<br />price:  2825<br />color: J","carat: 1.25<br />price:  4331<br />color: J","carat: 0.56<br />price:  1119<br />color: J","carat: 2.31<br />price: 12369<br />color: J","carat: 1.01<br />price:  3906<br />color: J","carat: 0.53<br />price:  1122<br />color: J","carat: 0.41<br />price:   637<br />color: J","carat: 2.00<br />price: 11189<br />color: J","carat: 1.50<br />price:  6750<br />color: J","carat: 1.27<br />price:  5690<br />color: J","carat: 0.90<br />price:  3024<br />color: J","carat: 2.01<br />price:  9725<br />color: J","carat: 1.76<br />price:  9053<br />color: J"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(253,231,37,1)","opacity":1,"size":15.1181102362205,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(253,231,37,1)"}},"hoveron":"points","name":"J","legendgroup":"J","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.2283105022831,"r":7.30593607305936,"b":40.1826484018265,"l":54.7945205479452},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.0165,4.7135],"tickmode":"array","ticktext":["1","2","3","4"],"tickvals":[1,2,3,4],"categoryorder":"array","categoryarray":["1","2","3","4"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"carat","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-555.8,19635.8],"tickmode":"array","ticktext":["0","5000","10000","15000"],"tickvals":[0,5000,10000,15000],"categoryorder":"array","categoryarray":["0","5000","10000","15000"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"price","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":0.96751968503937},"annotations":[{"text":"color","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"249d494e9865":{"x":{},"y":{},"colour":{},"type":"scatter"}},"cur_data":"249d494e9865","visdat":{"249d494e9865":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<h4 id="regression-line-1">Regression line</h4>
<pre><code class="language-r">p &lt;- ggplot(dsmall, aes(carat, price)) + geom_point() + 
            geom_smooth(method=&quot;lm&quot;, se=FALSE) +
            theme(panel.background=element_rect(fill = &quot;white&quot;, colour = &quot;black&quot;))
print(p) 
</code></pre>
<p><img src="../../../en/tutorials/rgraphics/rgraphics_files/figure-html/ggplot_regression_line-1.png" width="672" /></p>
<h4 id="several-regression-lines">Several regression lines</h4>
<pre><code class="language-r">p &lt;- ggplot(dsmall, aes(carat, price, group=color)) + 
            geom_point(aes(color=color), size=2) + 
            geom_smooth(aes(color=color), method = &quot;lm&quot;, se=FALSE) 
print(p) 
</code></pre>
<p><img src="../../../en/tutorials/rgraphics/rgraphics_files/figure-html/ggplot_many_regression_lines-1.png" width="672" /></p>
<h4 id="local-regression-curve-loess-1">Local regression curve (loess)</h4>
<pre><code class="language-r">p &lt;- ggplot(dsmall, aes(carat, price)) + geom_point() + geom_smooth() 
print(p) # Setting se=FALSE removes error shade
</code></pre>
<p><img src="../../../en/tutorials/rgraphics/rgraphics_files/figure-html/ggplot_loess_regression-1.png" width="672" /></p>
<h3 id="ggplot-line-plot"><code>ggplot</code>: line plot</h3>
<pre><code class="language-r">p &lt;- ggplot(iris, aes(Petal.Length, Petal.Width, group=Species, 
            color=Species)) + geom_line() 
print(p) 
</code></pre>
<p><img src="../../../en/tutorials/rgraphics/rgraphics_files/figure-html/ggplot_line_plot-1.png" width="672" /></p>
<h3 id="faceting">Faceting</h3>
<pre><code class="language-r">p &lt;- ggplot(iris, aes(Sepal.Length, Sepal.Width)) + 
            geom_line(aes(color=Species), size=1) + 
            facet_wrap(~Species, ncol=1)
print(p) 
</code></pre>
<p><img src="../../../en/tutorials/rgraphics/rgraphics_files/figure-html/ggplot_line_plot_faceting-1.png" width="672" /></p>
<h4 id="exercise-3">Exercise 3</h4>
<p>Scatter plots with <code>ggplot2</code></p>
<ul>
<li><strong>Task 1</strong>: Generate scatter plot for first two columns in <code>iris</code> data frame and color dots by its <code>Species</code> column.</li>
<li><strong>Task 2</strong>: Use the <code>xlim</code> and <code>ylim</code> arguments to set limits on the x- and y-axes so that all data points are restricted to the left bottom quadrant of the plot.</li>
<li><strong>Task 3</strong>: Generate corresponding line plot with faceting show individual data sets in saparate plots.</li>
</ul>
<p>Structure of <code>iris</code> data set</p>
<pre><code class="language-r">class(iris)
</code></pre>
<pre><code>## [1] &quot;data.frame&quot;
</code></pre>
<pre><code class="language-r">iris[1:4,]
</code></pre>
<pre><code>##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1          5.1         3.5          1.4         0.2  setosa
## 2          4.9         3.0          1.4         0.2  setosa
## 3          4.7         3.2          1.3         0.2  setosa
## 4          4.6         3.1          1.5         0.2  setosa
</code></pre>
<pre><code class="language-r">table(iris$Species)
</code></pre>
<pre><code>## 
##     setosa versicolor  virginica 
##         50         50         50
</code></pre>
<h3 id="bar-plots-1">Bar Plots</h3>
<p>Sample Set: the following transforms the <code>iris</code> data set into a ggplot2-friendly format.</p>
<p>Calculate mean values for aggregates given by <code>Species</code> column in <code>iris</code> data set</p>
<pre><code class="language-r">iris_mean &lt;- aggregate(iris[,1:4], by=list(Species=iris$Species), FUN=mean) 
</code></pre>
<p>Calculate standard deviations for aggregates given by <code>Species</code> column in <code>iris</code> data set</p>
<pre><code class="language-r">iris_sd &lt;- aggregate(iris[,1:4], by=list(Species=iris$Species), FUN=sd) 
</code></pre>
<p>Reformat <code>iris_mean</code> with <code>melt</code></p>
<pre><code class="language-r">library(reshape2) # Defines melt function
df_mean &lt;- melt(iris_mean, id.vars=c(&quot;Species&quot;), variable.name = &quot;Samples&quot;, value.name=&quot;Values&quot;)
</code></pre>
<p>Reformat <code>iris_sd</code> with <code>melt</code></p>
<pre><code class="language-r">df_sd &lt;- melt(iris_sd, id.vars=c(&quot;Species&quot;), variable.name = &quot;Samples&quot;, value.name=&quot;Values&quot;)
</code></pre>
<p>Define standard deviation limits</p>
<pre><code class="language-r">limits &lt;- aes(ymax = df_mean[,&quot;Values&quot;] + df_sd[,&quot;Values&quot;], ymin=df_mean[,&quot;Values&quot;] - df_sd[,&quot;Values&quot;])
</code></pre>
<h4 id="verical-orientation">Verical orientation</h4>
<pre><code class="language-r">p &lt;- ggplot(df_mean, aes(Samples, Values, fill = Species)) + 
        geom_bar(position=&quot;dodge&quot;, stat=&quot;identity&quot;)
print(p) 
</code></pre>
<p><img src="../../../en/tutorials/rgraphics/rgraphics_files/figure-html/iris_mean_bar_plot-1.png" width="672" /></p>
<p>To enforce that the bars are plotted in the order specified in the input data, one can instruct <code>ggplot</code>
to do so by turning the corresponding column (here <code>Species</code>) into an ordered factor as follows.</p>
<pre><code class="language-r">df_mean$Species &lt;- factor(df_mean$Species, levels=unique(df_mean$Species), ordered=TRUE)
</code></pre>
<p>In the above example this is not necessary since <code>ggplot</code> uses this order already.</p>
<h4 id="horizontal-orientation">Horizontal orientation</h4>
<pre><code class="language-r">p &lt;- ggplot(df_mean, aes(Samples, Values, fill = Species)) + 
            geom_bar(position=&quot;dodge&quot;, stat=&quot;identity&quot;) + coord_flip() + 
            theme(axis.text.y=element_text(angle=0, hjust=1))
print(p) 
</code></pre>
<p><img src="../../../en/tutorials/rgraphics/rgraphics_files/figure-html/iris_mean_bar_plot_sideways-1.png" width="672" /></p>
<h4 id="faceting-1">Faceting</h4>
<pre><code class="language-r">p &lt;- ggplot(df_mean, aes(Samples, Values)) + geom_bar(aes(fill = Species), stat=&quot;identity&quot;) +
            facet_wrap(~Species, ncol=1)
print(p) 
</code></pre>
<h4 id="error-bars-1">Error bars</h4>
<pre><code class="language-r">p &lt;- ggplot(df_mean, aes(Samples, Values, fill = Species)) + 
        geom_bar(position=&quot;dodge&quot;, stat=&quot;identity&quot;) + geom_errorbar(limits, position=&quot;dodge&quot;) 
print(p) 
</code></pre>
<p><img src="../../../en/tutorials/rgraphics/rgraphics_files/figure-html/iris_mean_bar_plot_error-1.png" width="672" /></p>
<h4 id="mirrored">Mirrored</h4>
<pre><code class="language-r">df &lt;- data.frame(group = rep(c(&quot;Above&quot;, &quot;Below&quot;), each=10), x = rep(1:10, 2), y = c(runif(10, 0, 1), runif(10, -1, 0)))
p &lt;- ggplot(df, aes(x=x, y=y, fill=group)) + 
        geom_bar(stat=&quot;identity&quot;, position=&quot;identity&quot;)
print(p) 
</code></pre>
<p><img src="../../../en/tutorials/rgraphics/rgraphics_files/figure-html/ggplot2_mirrored_barplot-1.png" width="672" /></p>
<h3 id="changing-color-settings">Changing Color Settings</h3>
<pre><code class="language-r">library(RColorBrewer)
# display.brewer.all() 
p &lt;- ggplot(df_mean, aes(Samples, Values, fill=Species, color=Species)) +
            geom_bar(position=&quot;dodge&quot;, stat=&quot;identity&quot;) + geom_errorbar(limits, position=&quot;dodge&quot;) + 
            scale_fill_brewer(palette=&quot;Blues&quot;) + scale_color_brewer(palette = &quot;Greys&quot;) 
print(p) 
</code></pre>
<p><img src="../../../en/tutorials/rgraphics/rgraphics_files/figure-html/ggplot2_color1-1.png" width="672" /></p>
<h4 id="using-standard-colors">Using standard colors</h4>
<pre><code class="language-r">p &lt;- ggplot(df_mean, aes(Samples, Values, fill=Species, color=Species)) + 
            geom_bar(position=&quot;dodge&quot;, stat=&quot;identity&quot;) + geom_errorbar(limits, position=&quot;dodge&quot;) + 
            scale_fill_manual(values=c(&quot;red&quot;, &quot;green3&quot;, &quot;blue&quot;)) + 
            scale_color_manual(values=c(&quot;red&quot;, &quot;green3&quot;, &quot;blue&quot;)) 
print(p) 
</code></pre>
<p><img src="../../../en/tutorials/rgraphics/rgraphics_files/figure-html/ggplot2_color2-1.png" width="672" /></p>
<h4 id="exercise-4">Exercise 4</h4>
<p>Bar plots</p>
<ul>
<li><strong>Task 1</strong>: Calculate the mean values for the <code>Species</code> components of the first four columns in the <code>iris</code> data set. Use the <code>melt</code> function from the <code>reshape2</code> package to bring the data into the expected format for <code>ggplot</code>.</li>
<li><strong>Task 2</strong>: Generate two bar plots: one with stacked bars and one with horizontally arranged bars.</li>
</ul>
<p>Structure of iris data set</p>
<pre><code class="language-r">class(iris)
</code></pre>
<pre><code>## [1] &quot;data.frame&quot;
</code></pre>
<pre><code class="language-r">iris[1:4,]
</code></pre>
<pre><code>##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1          5.1         3.5          1.4         0.2  setosa
## 2          4.9         3.0          1.4         0.2  setosa
## 3          4.7         3.2          1.3         0.2  setosa
## 4          4.6         3.1          1.5         0.2  setosa
</code></pre>
<pre><code class="language-r">table(iris$Species)
</code></pre>
<pre><code>## 
##     setosa versicolor  virginica 
##         50         50         50
</code></pre>
<h3 id="data-reformatting-example">Data reformatting example</h3>
<p>Here for line plot</p>
<pre><code class="language-r">y &lt;- matrix(rnorm(500), 100, 5, dimnames=list(paste(&quot;g&quot;, 1:100, sep=&quot;&quot;), paste(&quot;Sample&quot;, 1:5, sep=&quot;&quot;)))
y &lt;- data.frame(Position=1:length(y[,1]), y)
y[1:4, ] # First rows of input format expected by melt()
</code></pre>
<pre><code>##    Position    Sample1    Sample2    Sample3    Sample4     Sample5
## g1        1  1.5336975 -1.0365027 -2.0276195 -0.4580396 -0.06460952
## g2        2 -2.0960304  2.1878704  0.7260334  0.8274617  0.24192162
## g3        3 -0.8233125  0.4250477  0.6526331 -0.4509962 -1.06778801
## g4        4  1.0961555  0.8101104 -0.3403762 -0.7222191 -0.72737741
</code></pre>
<pre><code class="language-r">df &lt;- melt(y, id.vars=c(&quot;Position&quot;), variable.name = &quot;Samples&quot;, value.name=&quot;Values&quot;)
p &lt;- ggplot(df, aes(Position, Values)) + geom_line(aes(color=Samples)) + facet_wrap(~Samples, ncol=1)
print(p)
</code></pre>
<p><img src="../../../en/tutorials/rgraphics/rgraphics_files/figure-html/ggplot_melt_data-1.png" width="672" /></p>
<p>Same data can be represented in box plot as follows</p>
<pre><code class="language-r">ggplot(df, aes(Samples, Values, fill=Samples)) + geom_boxplot()
</code></pre>
<h3 id="jitter-plots">Jitter Plots</h3>
<pre><code class="language-r">p &lt;- ggplot(dsmall, aes(color, price/carat)) + 
            geom_jitter(alpha = I(1 / 2), aes(color=color))
print(p) 
</code></pre>
<p><img src="../../../en/tutorials/rgraphics/rgraphics_files/figure-html/ggplot_jitter_plot-1.png" width="672" /></p>
<h3 id="box-plots">Box plots</h3>
<pre><code class="language-r">p &lt;- ggplot(dsmall, aes(color, price/carat, fill=color)) + geom_boxplot()
print(p) 
</code></pre>
<p><img src="../../../en/tutorials/rgraphics/rgraphics_files/figure-html/ggplot_box_plot2-1.png" width="672" /></p>
<h3 id="violin-plots">Violin plots</h3>
<pre><code class="language-r">p &lt;- ggplot(dsmall, aes(color, price/carat, fill=color)) + geom_violin()                                                                                                      
print(p)                                                                                                                                                                      
</code></pre>
<p><img src="../../../en/tutorials/rgraphics/rgraphics_files/figure-html/ggplot_box_violin-1.png" width="672" /></p>
<h3 id="density-plots-1">Density plots</h3>
<h4 id="line-coloring">Line coloring</h4>
<pre><code class="language-r">p &lt;- ggplot(dsmall, aes(carat)) + geom_density(aes(color = color))
print(p) 
</code></pre>
<p><img src="../../../en/tutorials/rgraphics/rgraphics_files/figure-html/ggplot_density_plot_linecol-1.png" width="672" /></p>
<h4 id="area-coloring">Area coloring</h4>
<pre><code class="language-r">p &lt;- ggplot(dsmall, aes(carat)) + geom_density(aes(fill = color))
print(p) 
</code></pre>
<p><img src="../../../en/tutorials/rgraphics/rgraphics_files/figure-html/ggplot_density_plot_areacol-1.png" width="672" /></p>
<h3 id="histograms-1">Histograms</h3>
<pre><code class="language-r">p &lt;- ggplot(iris, aes(x=Sepal.Width)) + geom_histogram(aes(y = ..density.., 
            fill = ..count..), binwidth=0.2) + geom_density()  
print(p) 
</code></pre>
<p><img src="../../../en/tutorials/rgraphics/rgraphics_files/figure-html/ggplot_histogram-1.png" width="672" /></p>
<h3 id="pie-chart">Pie Chart</h3>
<pre><code class="language-r">df &lt;- data.frame(variable=rep(c(&quot;cat&quot;, &quot;mouse&quot;, &quot;dog&quot;, &quot;bird&quot;, &quot;fly&quot;)), 
                 value=c(1,3,3,4,2)) 
p &lt;- ggplot(df, aes(x = &quot;&quot;, y = value, fill = variable)) + 
            geom_bar(width = 1, stat=&quot;identity&quot;) + 
            coord_polar(&quot;y&quot;, start=pi / 3) + ggtitle(&quot;Pie Chart&quot;) 
print(p) 
</code></pre>
<p><img src="../../../en/tutorials/rgraphics/rgraphics_files/figure-html/ggplot_pie_chart-1.png" width="672" /></p>
<h3 id="wind-rose-pie-chart">Wind Rose Pie Chart</h3>
<pre><code class="language-r">p &lt;- ggplot(df, aes(x = variable, y = value, fill = variable)) + 
       geom_bar(width = 1, stat=&quot;identity&quot;) + coord_polar(&quot;y&quot;, start=pi / 3) + 
       ggtitle(&quot;Pie Chart&quot;) 
print(p) 
</code></pre>
<p><img src="../../../en/tutorials/rgraphics/rgraphics_files/figure-html/ggplot_windrose_pie_chart-1.png" width="672" /></p>
<h3 id="arranging-graphics-on-page">Arranging Graphics on Page</h3>
<p>Using <code>grid</code> package</p>
<pre><code class="language-r">library(grid)
a &lt;- ggplot(dsmall, aes(color, price/carat)) + geom_jitter(size=4, alpha = I(1 / 1.5), aes(color=color))
b &lt;- ggplot(dsmall, aes(color, price/carat, color=color)) + geom_boxplot()
c &lt;- ggplot(dsmall, aes(color, price/carat, fill=color)) + geom_boxplot() + theme(legend.position = &quot;none&quot;)
grid.newpage() # Open a new page on grid device
pushViewport(viewport(layout = grid.layout(2, 2))) # Assign to device viewport with 2 by 2 grid layout 
print(a, vp = viewport(layout.pos.row = 1, layout.pos.col = 1:2))
print(b, vp = viewport(layout.pos.row = 2, layout.pos.col = 1))
print(c, vp = viewport(layout.pos.row = 2, layout.pos.col = 2, width=0.3, height=0.3, x=0.8, y=0.8))
</code></pre>
<p><img src="../../../en/tutorials/rgraphics/rgraphics_files/figure-html/ggplot_arrange_graphics-1.png" width="672" /></p>
<p>Using <code>gridExtra</code> package</p>
<pre><code class="language-r">library(gridExtra)                                                                                                                                                            
grid.arrange(a, b, c, nrow = 2, ncol=2)                                                                                                                                       
</code></pre>
<p><img src="../../../en/tutorials/rgraphics/rgraphics_files/figure-html/ggplot_arrange_graphics2-1.png" width="672" /></p>
<h3 id="inserting-graphics-into-plots">Inserting Graphics into Plots</h3>
<pre><code class="language-r">library(grid)
print(a)
print(b, vp=viewport(width=0.3, height=0.3, x=0.8, y=0.8))
</code></pre>
<p><img src="../../../en/tutorials/rgraphics/rgraphics_files/figure-html/ggplot_insert_graphics-1.png" width="672" /></p>
<h2 id="specialty-graphics">Specialty Graphics</h2>
<h3 id="venn-diagrams">Venn Diagrams</h3>
<pre><code class="language-r">library(systemPipeR)
setlist5 &lt;- list(A=sample(letters, 18), B=sample(letters, 16), C=sample(letters, 20), D=sample(letters, 22), E=sample(letters, 18))
OLlist5 &lt;- overLapper(setlist=setlist5, sep=&quot;_&quot;, type=&quot;vennsets&quot;)
vennPlot(OLlist5, mymain=&quot;&quot;, mysub=&quot;&quot;, colmode=2, ccol=c(&quot;blue&quot;, &quot;red&quot;))
</code></pre>
<p><img src="../../../en/tutorials/rgraphics/rgraphics_files/figure-html/specgraph_venn-1.png" width="672" /></p>
<h3 id="compound-structures">Compound Structures</h3>
<p>Plots depictions of small molecules with <code>ChemmineR</code> package</p>
<pre><code class="language-r">library(ChemmineR)
data(sdfsample)
plot(sdfsample[1], print=FALSE)
</code></pre>
<p><img src="../../../en/tutorials/rgraphics/rgraphics_files/figure-html/specgraph_structure-1.png" width="672" /></p>
<h3 id="roc-plots">ROC Plots</h3>
<p>A variety of libraries are available for plotting receiver operating characteristic (ROC) curves in R:</p>
<ul>
<li><a href="http://rocr.bioinf.mpi-sb.mpg.de/">ROCR</a></li>
<li><a href="http://bioconductor.org/packages/release/bioc/html/ROC.html">ROC</a></li>
<li><a href="http://web.expasy.org/pROC/">pROC</a></li>
<li><a href="http://largedata.blogspot.com/2011/07/plotting-roc-curves-in-ggplot2.html">ggplot2</a></li>
</ul>
<h4 id="example">Example</h4>
<p>Most commonly, in an ROC we plot the true positive rate (y-axis) against the false positive rate (x-axis) at decreasing thresholds.
An illustrative example is provided in the <code>ROCR</code> package where one wants to inspect the content of the <code>ROCR.simple</code> object
defining the structure of the input data in two vectors.</p>
<pre><code class="language-r"># install.packages(&quot;ROCR&quot;) # Install if necessary on your laptop
library(ROCR)
data(ROCR.simple)
ROCR.simple
</code></pre>
<pre><code>## $predictions
##   [1] 0.612547843 0.364270971 0.432136142 0.140291078 0.384895941 0.244415489 0.970641299
##   [8] 0.890172812 0.781781371 0.868751832 0.716680598 0.360168796 0.547983407 0.385240464
##  [15] 0.423739359 0.101699993 0.628095575 0.744769966 0.657732644 0.490119891 0.072369921
##  [22] 0.172741714 0.105722115 0.890078186 0.945548941 0.984667270 0.360180429 0.448687336
##  [29] 0.014823599 0.543533783 0.292368449 0.701561487 0.715459280 0.714985914 0.120604738
##  [36] 0.319672178 0.911723615 0.757325590 0.090988280 0.529402244 0.257402979 0.589909284
##  [43] 0.708412104 0.326672910 0.086546283 0.879459891 0.362693564 0.230157183 0.779771989
##  [50] 0.876086217 0.353281048 0.212014560 0.703293499 0.689075677 0.627012496 0.240911145
##  [57] 0.402801992 0.134794140 0.120473353 0.665444679 0.536339509 0.623494622 0.885179651
##  [64] 0.353777439 0.408939895 0.265686095 0.932159806 0.248500489 0.858876675 0.491735594
##  [71] 0.151350957 0.694457482 0.496513160 0.123504905 0.499788081 0.310718619 0.907651100
##  [78] 0.340078180 0.195097957 0.371936985 0.517308606 0.419560072 0.865639036 0.018527600
##  [85] 0.539086009 0.005422562 0.772728821 0.703885141 0.348213542 0.277656869 0.458674210
##  [92] 0.059045866 0.133257805 0.083685883 0.531958184 0.429650397 0.717845453 0.537091350
##  [99] 0.212404891 0.930846938 0.083048377 0.468610247 0.393378108 0.663367560 0.349540913
## [106] 0.194398425 0.844415442 0.959417835 0.211378771 0.943432189 0.598162949 0.834803976
## [113] 0.576836208 0.380396459 0.161874325 0.912325837 0.642933593 0.392173971 0.122284044
## [120] 0.586857799 0.180631658 0.085993218 0.700501359 0.060413627 0.531464015 0.084254795
## [127] 0.448484671 0.938583020 0.531006532 0.785213140 0.905121019 0.748438143 0.605235403
## [134] 0.842974300 0.835981859 0.364288579 0.492596896 0.488179708 0.259278968 0.991096434
## [141] 0.757364019 0.288258273 0.773336236 0.040906997 0.110241034 0.760726142 0.984599159
## [148] 0.253271061 0.697235328 0.620501132 0.814586047 0.300973098 0.378092079 0.016694412
## [155] 0.698826511 0.658692553 0.470206008 0.501489336 0.239143340 0.050999138 0.088450984
## [162] 0.107031842 0.746588080 0.480100183 0.336592126 0.579511087 0.118555284 0.233160827
## [169] 0.461150807 0.370549294 0.770178504 0.537336015 0.463227453 0.790240205 0.883431431
## [176] 0.745110673 0.007746305 0.012653524 0.868331219 0.439399995 0.540221346 0.567043171
## [183] 0.035815400 0.806543942 0.248707470 0.696702150 0.081439129 0.336315317 0.126480399
## [190] 0.636728451 0.030235062 0.268138293 0.983494405 0.728536415 0.739554341 0.522384507
## [197] 0.858970526 0.383807972 0.606960209 0.138387070
## 
## $labels
##   [1] 1 1 0 0 0 1 1 1 1 0 1 0 1 0 0 0 1 1 1 0 0 0 0 1 0 1 0 0 1 1 0 1 1 1 0 0 1 1 0 1 0 1 0 1 0 1 0
##  [48] 1 0 1 1 0 1 0 1 0 0 0 0 1 1 1 1 0 0 0 1 0 1 0 0 1 0 0 0 0 0 0 0 0 1 0 1 0 0 1 1 0 0 1 0 0 1 0
##  [95] 1 0 1 1 0 1 0 0 0 1 0 0 1 0 0 1 1 1 0 0 0 1 1 0 0 1 0 0 1 0 1 0 0 1 1 1 1 1 0 1 1 0 0 0 0 1 1
## [142] 0 1 0 1 0 1 1 1 1 1 0 0 0 1 1 0 1 0 0 0 0 1 0 0 1 0 0 0 0 1 1 0 1 1 1 0 1 1 0 1 1 0 1 0 0 0 1
## [189] 0 0 0 1 0 1 1 0 1 0 1 0
</code></pre>
<pre><code class="language-r">pred &lt;- prediction(ROCR.simple$predictions, ROCR.simple$labels)
perf &lt;- performance( pred, &quot;tpr&quot;, &quot;fpr&quot; )
plot(perf)
</code></pre>
<p><img src="../../../en/tutorials/rgraphics/rgraphics_files/figure-html/ROCR_example-1.png" width="672" /></p>
<p>Obtain area under the curve (AUC)</p>
<pre><code class="language-r">auc &lt;- performance( pred, &quot;tpr&quot;, &quot;fpr&quot;, measure = &quot;auc&quot;)                                                                                                                      
auc@y.values[[1]]                                                                                                                                                             
</code></pre>
<pre><code>## [1] 0.8341875
</code></pre>
<h3 id="trees">Trees</h3>
<p>The <a href="http://ape-package.ird.fr/ape_screenshots.html"><code>ape</code></a> package provides many useful utilities for phylogenetic analysis and tree plotting. Another useful package for
plotting trees is <a href="http://bioconductor.org/packages/release/bioc/html/ggtree.html"><code>ggtree</code></a>. The following example plots two trees face to face with links to identical
leaf labels.</p>
<pre><code class="language-r">library(ape)
tree1 &lt;- rtree(40)
tree2 &lt;- rtree(20)
association &lt;- cbind(tree2$tip.label, tree2$tip.label)
cophyloplot(tree1, tree2, assoc = association,
            length.line = 4, space = 28, gap = 3)
</code></pre>
<p><img src="../../../en/tutorials/rgraphics/rgraphics_files/figure-html/trees_ape1-1.png" width="672" /></p>
<h2 id="genome-graphics">Genome Graphics</h2>
<h3 id="ggbio"><code>ggbio</code></h3>
<ul>
<li>What is <code>ggbio</code>?
<ul>
<li>A programmable genome browser environment</li>
</ul>
</li>
<li>Genome broswer concepts
<ul>
<li>A genome browser is a visulalization tool for plotting different types of genomic data in separate tracks along chromosomes.</li>
<li>The <code>ggbio</code> package (Yin, Cook, and Lawrence 2012) facilitates plotting of complex genome data objects, such as read alignments (SAM/BAM), genomic context/annotation information (gff/txdb), variant calls (VCF/BCF), and more. To easily compare these data sets, it extends the faceting facility of <code>ggplot2</code> to genome browser-like tracks.</li>
<li>Most of the core object types for handling genomic data with R/Bioconductor are supported: <code>GRanges</code>, <code>GAlignments</code>, <code>VCF</code>, etc. For more details, see Table 1.1 of the <code>ggbio</code> vignette <a href="http://www.bioconductor.org/packages/release/bioc/vignettes/ggbio/inst/doc/ggbio.pdf">here</a>.</li>
<li><code>ggbio</code>’s convenience plotting function is <code>autoplot</code>. For more customizable plots, one can use the generic <code>ggplot</code> function.</li>
<li>Apart from the standard <code>ggplot2</code> plotting components, <code>ggbio</code> defines serval new components useful for genomic data visualization. A detailed list is given in Table 1.2 of the vignette <a href="http://www.bioconductor.org/packages/release/bioc/vignettes/ggbio/inst/doc/ggbio.pdf">here</a>.</li>
<li>Useful web sites: - <a href="http://www.tengfei.name/ggbio/docs/">ggbio manual</a>
<ul>
<li><a href="http://www.tengfei.name/ggbio/docs/man/">ggbio functions</a></li>
<li><a href="http://www.tengfei.name/ggbio/docs/man/autoplot-method.html">autoplot demo</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="tracks-aligning-plots-along-chromosomes">Tracks: aligning plots along chromosomes</h4>
<pre><code class="language-r">library(ggbio)
df1 &lt;- data.frame(time = 1:100, score = sin((1:100)/20)*10)
p1 &lt;- qplot(data = df1, x = time, y = score, geom = &quot;line&quot;)
df2 &lt;- data.frame(time = 30:120, score = sin((30:120)/20)*10, value = rnorm(120-30 +1))
p2 &lt;- ggplot(data = df2, aes(x = time, y = score)) + geom_line() + geom_point(size = 2, aes(color = value))
tracks(time1 = p1, time2 = p2) + xlim(1, 40) + theme_tracks_sunset()
</code></pre>
<p><img src="../../../en/tutorials/rgraphics/rgraphics_files/figure-html/ggbio_align-1.png" width="672" /></p>
<h4 id="plotting-genomic-ranges">Plotting genomic ranges</h4>
<p><code>GRanges</code> objects are essential for storing alignment or annotation ranges in R/Bioconductor. The following creates a sample <code>GRanges</code> object and plots its content.</p>
<pre><code class="language-r">library(GenomicRanges)
set.seed(1); N &lt;- 100; gr &lt;- GRanges(seqnames = sample(c(&quot;chr1&quot;, &quot;chr2&quot;, &quot;chr3&quot;), size = N, replace = TRUE), IRanges(start = sample(1:300, size = N, replace = TRUE), width = sample(70:75, size = N,replace = TRUE)), strand = sample(c(&quot;+&quot;, &quot;-&quot;), size = N, replace = TRUE), value = rnorm(N, 10, 3), score = rnorm(N, 100, 30), sample = sample(c(&quot;Normal&quot;, &quot;Tumor&quot;), size = N, replace = TRUE), pair = sample(letters, size = N, replace = TRUE))
autoplot(gr, aes(color = strand, fill = strand), facets = strand ~ seqnames)
</code></pre>
<p><img src="../../../en/tutorials/rgraphics/rgraphics_files/figure-html/ggbio_granges-1.png" width="672" /></p>
<h4 id="plotting-coverage">Plotting coverage</h4>
<pre><code class="language-r">autoplot(gr, aes(color = strand, fill = strand), facets = strand ~ seqnames, stat = &quot;coverage&quot;)
</code></pre>
<p><img src="../../../en/tutorials/rgraphics/rgraphics_files/figure-html/ggbio_coverage-1.png" width="672" /></p>
<h4 id="mirrored-coverage">Mirrored coverage</h4>
<pre><code class="language-r">pos &lt;- sapply(coverage(gr[strand(gr)==&quot;+&quot;]), as.numeric)
pos &lt;- data.frame(Chr=rep(names(pos), sapply(pos, length)), Strand=rep(&quot;+&quot;, length(unlist(pos))), Position=unlist(sapply(pos, function(x) 1:length(x))), Coverage=as.numeric(unlist(pos)))
neg &lt;- sapply(coverage(gr[strand(gr)==&quot;-&quot;]), as.numeric)
neg &lt;- data.frame(Chr=rep(names(neg), sapply(neg, length)), Strand=rep(&quot;-&quot;, length(unlist(neg))), Position=unlist(sapply(neg, function(x) 1:length(x))), Coverage=-as.numeric(unlist(neg)))
covdf &lt;- rbind(pos, neg)
p &lt;- ggplot(covdf, aes(Position, Coverage, fill=Strand)) + 
        geom_bar(stat=&quot;identity&quot;, position=&quot;identity&quot;) + facet_wrap(~Chr)
p
</code></pre>
<p><img src="../../../en/tutorials/rgraphics/rgraphics_files/figure-html/ggbio_mirrored_coverage-1.png" width="672" /></p>
<h3 id="circular-genome-plots">Circular genome plots</h3>
<pre><code class="language-r">ggplot(gr) + layout_circle(aes(fill = seqnames), geom = &quot;rect&quot;)
</code></pre>
<p><img src="../../../en/tutorials/rgraphics/rgraphics_files/figure-html/ggbio_circular1-1.png" width="672" /></p>
<p>More complex circular example</p>
<pre><code class="language-r">seqlengths(gr) &lt;- c(400, 500, 700)
values(gr)$to.gr &lt;- gr[sample(1:length(gr), size = length(gr))]
idx &lt;- sample(1:length(gr), size = 50)
gr &lt;- gr[idx]
ggplot() + layout_circle(gr, geom = &quot;ideo&quot;, fill = &quot;gray70&quot;, radius = 7, trackWidth = 3) +
  layout_circle(gr, geom = &quot;bar&quot;, radius = 10, trackWidth = 4,
                aes(fill = score, y = score)) +
  layout_circle(gr, geom = &quot;point&quot;, color = &quot;red&quot;, radius = 14,
                trackWidth = 3, grid = TRUE, aes(y = score)) +
  layout_circle(gr, geom = &quot;link&quot;, linked.to = &quot;to.gr&quot;, radius = 6, trackWidth = 1)
</code></pre>
<center>
<img title="vim-r" src="../images/circularplot.png"/>
</center>
<h4 id="alignments-and-variants">Alignments and variants</h4>
<p>To make the following example work, please download and unpack this <a href="http://biocluster.ucr.edu/~tgirke/HTML_Presentations/Manuals/Workshop_Dec_12_16_2013/Rgraphics/data.zip">data archive</a> containing GFF, BAM and VCF sample files.</p>
<pre><code class="language-r">library(rtracklayer); library(GenomicFeatures); library(Rsamtools); library(GenomicAlignments); library(VariantAnnotation)
ga &lt;- readGAlignments(&quot;./data/SRR064167.fastq.bam&quot;, use.names=TRUE, param=ScanBamParam(which=GRanges(&quot;Chr5&quot;, IRanges(4000, 8000))))
p1 &lt;- autoplot(ga, geom = &quot;rect&quot;)
p2 &lt;- autoplot(ga, geom = &quot;line&quot;, stat = &quot;coverage&quot;)
vcf &lt;- readVcf(file=&quot;data/varianttools_gnsap.vcf&quot;, genome=&quot;ATH1&quot;)
p3 &lt;- autoplot(vcf[seqnames(vcf)==&quot;Chr5&quot;], type = &quot;fixed&quot;) + xlim(4000, 8000) + theme(legend.position = &quot;none&quot;, axis.text.y = element_blank(), axis.ticks.y=element_blank())
txdb &lt;- makeTxDbFromGFF(file=&quot;./data/TAIR10_GFF3_trunc.gff&quot;, format=&quot;gff3&quot;)
p4 &lt;- autoplot(txdb, which=GRanges(&quot;Chr5&quot;, IRanges(4000, 8000)), names.expr = &quot;gene_id&quot;)
tracks(Reads=p1, Coverage=p2, Variant=p3, Transcripts=p4, heights = c(0.3, 0.2, 0.1, 0.35)) + ylab(&quot;&quot;)
</code></pre>
<p><img src="../../../en/tutorials/rgraphics/rgraphics_files/figure-html/ggbio_align_variants-1.png" width="672" /></p>
<h3 id="additional-examples">Additional examples</h3>
<p>See <code>autoplot</code> demo <a href="http://www.tengfei.name/ggbio/docs/man/autoplot-method.html">here</a></p>
<h3 id="additional-genome-graphics">Additional genome graphics</h3>
<ul>
<li><a href="http://www.bioconductor.org/packages/devel/bioc/html/Gviz.html"><code>Gviz</code></a></li>
<li><a href="http://cran.us.r-project.org/web/packages/RCircos/index.html"><code>RCircos</code></a> (Zhang, Meltzer, and Davis 2013)</li>
<li><a href="http://bioconductor.org/packages/release/bioc/html/GenomeGraphs.html"><code>Genome Graphs</code></a></li>
<li><a href="http://genoplotr.r-forge.r-project.org/"><code>genoPlotR</code></a></li>
</ul>
<h3 id="genome-browser-igv">Genome Browser: IGV</h3>
<p>View genome data in IGV</p>
<ul>
<li>Download and open <a href="http://software.broadinstitute.org/software/igv/download">IGV</a></li>
<li>Select in menu in top left corner <em>A. thaliana</em> (TAIR10)</li>
<li>Upload the following indexed/sorted Bam files with <code>File -&gt; Load from URL...</code></li>
</ul>
<!-- -->
<pre><code>http://faculty.ucr.edu/~tgirke/HTML_Presentations/Manuals/Workshop_Dec_6_10_2012/Rrnaseq/results/SRR064154.fastq.bam
http://faculty.ucr.edu/~tgirke/HTML_Presentations/Manuals/Workshop_Dec_6_10_2012/Rrnaseq/results/SRR064155.fastq.bam
http://faculty.ucr.edu/~tgirke/HTML_Presentations/Manuals/Workshop_Dec_6_10_2012/Rrnaseq/results/SRR064166.fastq.bam
http://faculty.ucr.edu/~tgirke/HTML_Presentations/Manuals/Workshop_Dec_6_10_2012/Rrnaseq/results/SRR064167.fastq.bam
</code></pre>
<ul>
<li>To view area of interest, enter its coordinates <code>Chr1:49,457-51,457</code> in position menu on top.</li>
</ul>
<center>
<img title="vim-r" src="../images/igv_peak_3.png"/>
</center>
<h4 id="create-symbolic-links">Create symbolic links</h4>
<p>For viewing BAM files in IGV as part of <code>systemPipeR</code> workflows.</p>
<ul>
<li><code>systemPipeR</code>: utilities for building NGS analysis pipelines.</li>
</ul>
<pre><code class="language-r">library(&quot;systemPipeR&quot;)
symLink2bam(sysargs=args, htmldir=c(&quot;~/.html/&quot;, &quot;somedir/&quot;), 
            urlbase=&quot;http://myserver.edu/~username/&quot;,
            urlfile=&quot;IGVurl.txt&quot;)
</code></pre>
<h4 id="controlling-igv-from-r">Controlling IGV from R</h4>
<p>Open IGV before running the following routine. Alternatively, open IGV from within R with <code>startIGV(&quot;lm&quot;)</code> .
Note this may not work on all systems.</p>
<pre><code class="language-r">library(SRAdb)
myurls &lt;- readLines(&quot;http://biocluster.ucr.edu/~tgirke/Documents/R_BioCond/Samples/bam_urls.txt&quot;)
#startIGV(&quot;lm&quot;) # opens IGV
sock &lt;- IGVsocket()
session &lt;- IGVsession(files=myurls, 
                      sessionFile=&quot;session.xml&quot;, 
                      genome=&quot;A. thaliana (TAIR10)&quot;)
IGVload(sock, session)
IGVgoto(sock, 'Chr1:45296-47019')
</code></pre>
<h2 id="references">References</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Yin2012-jj" class="csl-entry">
<p>Yin, T, D Cook, and M Lawrence. 2012. “Ggbio: An R Package for Extending the Grammar of Graphics for Genomic Data.” <em>Genome Biol.</em> 13 (8). <a href="https://doi.org/10.1186/gb-2012-13-8-r77">https://doi.org/10.1186/gb-2012-13-8-r77</a>.</p>
</div>
<div id="ref-Zhang2013-zn" class="csl-entry">
<p>Zhang, H, P Meltzer, and S Davis. 2013. “RCircos: An R Package for Circos 2d Track Plots.” <em>BMC Bioinformatics</em> 14: 244–44. <a href="https://doi.org/10.1186/1471-2105-14-244">https://doi.org/10.1186/1471-2105-14-244</a>.</p>
</div>
</div>

	
	
	<div class="text-muted mt-5 pt-3 border-top">Last modified 2021-05-16: <a  href="https://github.com/tgirke/GEN242//commit/770014307cf73ff2266721f016bca5bfa31f990e">some edits (770014307)</a>
</div>
</div>


              </main>
          


        </div>
      </div>
      
<footer class="bg-dark py-5 row d-print-none">
  <div class="container-fluid mx-sm-5">
    <div class="row">
      <div class="col-6 col-sm-4 text-xs-center order-sm-2">
        
      </div>
      <div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
        
      </div>
      <div class="col-12 col-sm-4 text-center py-2 order-sm-2">
        <small class="text-white">&copy; 2021 The GEN242 Instructors All Rights Reserved</small>
        <small class="ml-1"><a href="https://www.ucr.edu/privacy.html" target="_blank">Privacy Policy</a></small>
	
      </div>
    </div>
  </div>
</footer>


    </div>
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>


<script>
  (function() {
    var i, text, code, codes = document.getElementsByTagName('code');
    for (i = 0; i < codes.length;) {
      code = codes[i];
      if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
        text = code.textContent;
        if (/^\$[^$]/.test(text) && /[^$]\$$/.test(text)) {
          text = text.replace(/^\$/, '\\(').replace(/\$$/, '\\)');
          code.textContent = text;
        }
        if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
            /^\$(.|\s)+\$$/.test(text) ||
            /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
          code.outerHTML = code.innerHTML;  
          continue;
        }
      }
      i++;
    }
  })();
</script>

<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true,
        processEnvironments: true
    },
    // Center justify equations in code and markdown cells. Elsewhere
    // we use CSS to left justify single line equations in code cells.
    displayAlign: 'center',
    "HTML-CSS": {
        styles: {'.MathJax_Display': {"margin": 0}},
        linebreaks: { automatic: true }
    }
});
</script>













<script src="../../../js/main.min.f820bfc507c3ebefe17f8881ec4ee10013f3b89ad9555a50acf9bb1771e6823f.js" integrity="sha256-&#43;CC/xQfD6&#43;/hf4iB7E7hABPzuJrZVVpQrPm7F3Hmgj8=" crossorigin="anonymous"></script>



<script src='../../../js/prism.js'></script>



  </body>
</html>
